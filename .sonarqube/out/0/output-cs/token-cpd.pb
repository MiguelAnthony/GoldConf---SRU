‚/
HC:\Users\Edwin\Documents\GOLDCONF\GoldConf\Controllers\AuthController.cs
	namespace 	
GoldConf
 
. 
Controllers 
{ 
public 

class 
AuthController 
:  !

Controller" ,
{ 
private 
readonly 
IAuthRepository (
context) 0
;0 1
private 
readonly 
IClaimService &
claim' ,
;, -
public 
AuthController 
( 
IAuthRepository -
context. 5
,5 6
IClaimService7 D
claimE J
)J K
{ 	
this 
. 
context 
= 
context "
;" #
this 
. 
claim 
= 
claim 
; 
} 	
[ 	
HttpGet	 
] 
public 
IActionResult 
Login "
(" #
)# $
{ 	
return 
View 
( 
$str 
)  
;  !
} 	
[ 	
HttpPost	 
] 
public   
IActionResult   
Login   "
(  " #
string  # )
username  * 2
,  2 3
string  4 :
password  ; C
)  C D
{!! 	
var"" 
user"" 
="" 
context"" 
."" 

GetUsuario"" )
("") *
username""* 2
,""2 3
password""3 ;
)""; <
;""< =
if$$ 
($$ 
user$$ 
!=$$ 
null$$ 
)$$ 
{%% 
var&& 
claims&& 
=&& 
new&&  
List&&! %
<&&% &
Claim&&& +
>&&+ ,
{&&- .
new'' 
Claim'' 
('' 

ClaimTypes'' (
.''( )
Name'') -
,''- .
username''/ 7
)''7 8
}(( 
;(( 
var** 
claimsIdentity** "
=**# $
new**% (
ClaimsIdentity**) 7
(**7 8
claims**8 >
,**> ?
$str**@ G
)**G H
;**H I
var++ 
claimsPrincipal++ #
=++$ %
new++& )
ClaimsPrincipal++* 9
(++9 :
claimsIdentity++: H
)++H I
;++I J
claim-- 
.-- 
SetHttpContext-- $
(--$ %
HttpContext--% 0
)--0 1
;--1 2
claim.. 
... 
Login.. 
(.. 
claimsPrincipal.. +
)..+ ,
;.., -
return00 
RedirectToAction00 '
(00' (
$str00( /
,00/ 0
$str001 7
)007 8
;008 9
}11 

ModelState33 
.33 
AddModelError33 $
(33$ %
$str33% ,
,33, -
$str33. Q
)33Q R
;33R S
return44 
View44 
(44 
$str44 
)44  
;44  !
}55 	
[66 	
HttpGet66	 
]66 
public77 
IActionResult77 
Logout77 #
(77# $
)77$ %
{88 	
claim99 
.99 
SetHttpContext99  
(99  !
HttpContext99! ,
)99, -
;99- .
claim:: 
.:: 
Logout:: 
(:: 
):: 
;:: 
return;; 
RedirectToAction;; #
(;;# $
$str;;$ +
);;+ ,
;;;, -
}<< 	
[>> 	
HttpGet>>	 
]>> 
public?? 
ActionResult?? 
	Registrar?? %
(??% &
)??& '
{@@ 	
returnAA 
ViewAA 
(AA 
$strAA #
)AA# $
;AA$ %
}BB 	
[DD 	
HttpPostDD	 
]DD 
publicEE 
ActionResultEE 
	RegistrarEE %
(EE% &
UserEE& *
userEE+ /
,EE/ 0
stringEE1 7
passwordConfEE8 D
)EED E
{FF 	
varGG 
usuariosGG 
=GG 
contextGG "
.GG" #
GetUsuariosGG# .
(GG. /
)GG/ 0
;GG0 1
foreachHH 
(HH 
varHH 
itemHH 
inHH  
usuariosHH! )
)HH) *
{II 
ifJJ 
(JJ 
itemJJ 
.JJ 
EmailJJ 
==JJ !
userJJ" &
.JJ& '
EmailJJ' ,
)JJ, -

ModelStateKK 
.KK 
AddModelErrorKK ,
(KK, -
$strKK- 4
,KK4 5
$strKK6 L
)KKL M
;KKM N
ifLL 
(LL 
itemLL 
.LL 
UsernameLL !
==LL" $
userLL% )
.LL) *
UsernameLL* 2
)LL2 3

ModelStateMM 
.MM 
AddModelErrorMM ,
(MM, -
$strMM- 7
,MM7 8
$strMM9 Q
)MMQ R
;MMR S
}NN 
ifPP 
(PP 
userPP 
.PP 
PasswordPP 
!=PP  
passwordConfPP! -
)PP- .

ModelStateQQ 
.QQ 
AddModelErrorQQ (
(QQ( )
$strQQ) 7
,QQ7 8
$strQQ9 W
)QQW X
;QQX Y
ifSS 
(SS 

ModelStateSS 
.SS 
IsValidSS "
)SS" #
{TT 
contextUU 
.UU 
SaveUsuarioUU #
(UU# $
userUU$ (
)UU( )
;UU) *
returnVV 
RedirectToActionVV '
(VV' (
$strVV( /
)VV/ 0
;VV0 1
}WW 
returnXX 
ViewXX 
(XX 
$strXX #
,XX# $
userXX% )
)XX) *
;XX* +
}YY 	
}ZZ 
}[[ ° 
OC:\Users\Edwin\Documents\GOLDCONF\GoldConf\Controllers\ConferenciaController.cs
	namespace 	
GoldConf
 
. 
Controllers 
{ 
[ 
	Authorize 
] 
public 

class !
ConferenciaController &
:' (

Controller) 3
{ 
private 
readonly "
IConferenciaRepository /
context0 7
;7 8
private 
readonly 
IClaimService &
claim' ,
;, -
public !
ConferenciaController $
($ %"
IConferenciaRepository% ;
ctx< ?
,? @
IClaimServiceA N
claimO T
)T U
{ 	
this 
. 
context 
= 
ctx 
; 
this 
. 
claim 
= 
claim 
; 
} 	
[ 	
HttpGet	 
] 
public 
ActionResult 
Conferencias (
(( )
string) /
search0 6
)6 7
{ 	
claim 
. 
SetHttpContext  
(  !
HttpContext! ,
), -
;- .
var 
ponentes 
= 
context "
." #
GetPonentes# .
(. /
)/ 0
;0 1
var   
conferencias   
=   
context   &
.  & '
GetConferencias  ' 6
(  6 7
)  7 8
;  8 9
ViewBag!! 
.!! 
Cuenta!! 
=!! 
context!! $
.!!$ %

GetCuentas!!% /
(!!/ 0
)!!0 1
."" 
Where"" 
("" 
o"" 
=>"" 
o"" 
."" 
UserId"" $
==""% '
claim""( -
.""- .
GetLoggedUser"". ;
(""; <
)""< =
.""= >
Id""> @
)""@ A
.## 
ToList## 
(## 
)## 
;## 
if&& 
(&& 
claim&& 
.&& 
GetLoggedUser&& #
(&&# $
)&&$ %
.&&% &
Username&&& .
!=&&/ 1
$str&&2 <
)&&< =
{'' 
ViewBag(( 
.(( 
Usuario(( 
=((  !
$str((" ,
;((, -
conferencias)) 
=)) 
context)) &
.))& ' 
GetConferenciasOrder))' ;
()); <
)))< =
;))= >
ViewBag** 
.** 
Compra** 
=**  
context**! (
.**( )

GetCompras**) 3
(**3 4
)**4 5
.**5 6
Where++ 
(++ 
o++ 
=>++ 
o++  
.++  !
IdUser++! '
==++( *
claim+++ 0
.++0 1
GetLoggedUser++1 >
(++> ?
)++? @
.++@ A
Id++A C
)++C D
.++D E
ToList,, 
(,, 
),, 
;,, 
}-- 
else.. 
{// 
conferencias00 
=00 
context00 &
.00& '"
GetConferenciasOrderUC00' =
(00= >
)00> ?
;00? @
ViewBag11 
.11 
Compra11 
=11  
context11! (
.11( )

GetCompras11) 3
(113 4
)114 5
;115 6
}22 
ViewBag44 
.44 
Buscar44 
=44 
search44 #
;44# $
ViewBag66 
.66 
IdUser66 
=66 
claim66 "
.66" #
GetLoggedUser66# 0
(660 1
)661 2
.662 3
Id663 5
;665 6
if88 
(88 
!88 
string88 
.88 
IsNullOrEmpty88 %
(88% &
search88& ,
)88, -
)88- .
{99 
conferencias:: 
=:: 
conferencias:: +
.::+ ,
Where::, 1
(::1 2
s::2 3
=>::4 6
s::7 8
.::8 9
Ponentes::9 A
.::A B
NomApe::B H
.::H I
Contains::I Q
(::Q R
search::R X
)::X Y
||::Z \
s::] ^
.::^ _

TituloConf::_ i
.::i j
Contains::j r
(::r s
search::s y
)::y z
)::z {
.::{ |
ToList	::| Ç
(
::Ç É
)
::É Ñ
;
::Ñ Ö
return;; 
View;; 
(;; 
$str;; *
,;;* +
conferencias;;, 8
);;8 9
;;;9 :
}<< 
return>> 
View>> 
(>> 
$str>> &
,>>& '
conferencias>>( 4
)>>4 5
;>>5 6
}?? 	
publicAA 
ActionResultAA 
DetalleAA #
(AA# $
intAA$ '
idConferenciaAA( 5
)AA5 6
{BB 	
claimCC 
.CC 
SetHttpContextCC  
(CC  !
HttpContextCC! ,
)CC, -
;CC- .
ifDD 
(DD 
claimDD 
.DD 
GetLoggedUserDD #
(DD# $
)DD$ %
.DD% &
UsernameDD& .
!=DD/ 1
$strDD2 <
)DD< =
ViewBagEE 
.EE 
UsuarioEE 
=EE  !
$strEE" ,
;EE, -
varGG 
compraGG 
=GG 
contextGG  
.GG  !

GetComprasGG! +
(GG+ ,
)GG, -
.GG- .
WhereGG. 3
(GG3 4
oGG4 5
=>GG6 8
oGG9 :
.GG: ;
IdConferenciaGG; H
==GGI K
idConferenciaGGL Y
)GGY Z
.GGZ [
ToListGG[ a
(GGa b
)GGb c
;GGc d
ViewBagHH 
.HH 
CompraHH 
=HH 
compraHH #
.HH# $
CountHH$ )
(HH) *
)HH* +
;HH+ ,
ViewBagJJ 
.JJ 
PonentesJJ 
=JJ 
contextJJ &
.JJ& '
GetPonentesJJ' 2
(JJ2 3
)JJ3 4
;JJ4 5
varLL 
conferenciasLL 
=LL 
contextLL &
.LL& '"
GetConferenciasOrderUCLL' =
(LL= >
)LL> ?
.MM 
WhereMM 
(MM 
oMM 
=>MM 
oMM 
.MM 
IdMM  
==MM! #
idConferenciaMM$ 1
)MM1 2
.NN 
FirstOrDefaultNN 
(NN  
)NN  !
;NN! "
ViewBagPP 
.PP 
IdUserPP 
=PP 
claimPP "
.PP" #
GetLoggedUserPP# 0
(PP0 1
)PP1 2
.PP2 3
IdPP3 5
;PP5 6
returnRR 
ViewRR 
(RR 
$strRR !
,RR! "
conferenciasRR# /
)RR/ 0
;RR0 1
}SS 	
[UU 	
HttpGetUU	 
]UU 
publicVV 
ActionResultVV 
CreateVV "
(VV" #
)VV# $
{WW 	
claimXX 
.XX 
SetHttpContextXX  
(XX  !
HttpContextXX! ,
)XX, -
;XX- .
ifYY 
(YY 
claimYY 
.YY 
GetLoggedUserYY #
(YY# $
)YY$ %
.YY% &
UsernameYY& .
!=YY/ 1
$strYY2 <
)YY< =
{ZZ 
var[[ 
conferencias[[  
=[[! "
context[[# *
.[[* +"
GetConferenciasOrderUC[[+ A
([[A B
)[[B C
;[[C D
return\\ 
RedirectToAction\\ '
(\\' (
$str\\( 6
,\\6 7
conferencias\\8 D
)\\D E
;\\E F
}]] 
else^^ 
{__ 
ViewBag`` 
.`` 
Ponentes``  
=``! "
context``# *
.``* +
GetPonentes``+ 6
(``6 7
)``7 8
;``8 9
returnaa 
Viewaa 
(aa 
$straa $
,aa$ %
newaa& )
Conferenciaaa* 5
(aa5 6
)aa6 7
)aa7 8
;aa8 9
}bb 
}cc 	
[dd 	
HttpPostdd	 
]dd 
publicee 
ActionResultee 
Createee "
(ee" #
Conferenciaee# .
conferenciaee/ :
,ee: ;
	IFormFileee< E
imageeeF K
)eeK L
{ff 	
claimgg 
.gg 
SetHttpContextgg  
(gg  !
HttpContextgg! ,
)gg, -
;gg- .
ifhh 
(hh 
claimhh 
.hh 
GetLoggedUserhh #
(hh# $
)hh$ %
.hh% &
Usernamehh& .
!=hh/ 1
$strhh2 <
)hh< =
{ii 
varjj 
conferenciasjj  
=jj! "
contextjj# *
.jj* +"
GetConferenciasOrderUCjj+ A
(jjA B
)jjB C
;jjC D
returnkk 
RedirectToActionkk '
(kk' (
$strkk( 6
,kk6 7
conferenciaskk8 D
)kkD E
;kkE F
}ll 
elsemm 
{nn 
ifoo 
(oo 
conferenciaoo 
==oo  "
nulloo# '
)oo' (

ModelStatepp 
.pp 
AddModelErrorpp ,
(pp, -
$strpp- :
,pp: ;
$strpp< Y
)ppY Z
;ppZ [
ifqq 
(qq 

ModelStateqq 
.qq 
IsValidqq &
)qq& '
{rr 
contextss 
.ss 
NewConferenciass *
(ss* +
conferenciass+ 6
,ss6 7
imagess8 =
)ss= >
;ss> ?
returntt 
RedirectToActiontt +
(tt+ ,
$strtt, :
)tt: ;
;tt; <
}uu 
elsevv 
{ww 
ViewBagxx 
.xx 
Ponentesxx $
=xx% &
contextxx' .
.xx. /
GetPonentesxx/ :
(xx: ;
)xx; <
;xx< =
returnyy 
Viewyy 
(yy  
$stryy  (
,yy( )
conferenciayy* 5
)yy5 6
;yy6 7
}zz 
}{{ 
}|| 	
[~~ 	
HttpGet~~	 
]~~ 
public 
ActionResult 
Edit  
(  !
int! $
id% '
)' (
{
ÄÄ 	
claim
ÅÅ 
.
ÅÅ 
SetHttpContext
ÅÅ  
(
ÅÅ  !
HttpContext
ÅÅ! ,
)
ÅÅ, -
;
ÅÅ- .
if
ÇÇ 
(
ÇÇ 
claim
ÇÇ 
.
ÇÇ 
GetLoggedUser
ÇÇ #
(
ÇÇ# $
)
ÇÇ$ %
.
ÇÇ% &
Username
ÇÇ& .
!=
ÇÇ/ 1
$str
ÇÇ2 <
)
ÇÇ< =
{
ÉÉ 
var
ÑÑ 
conferencias
ÑÑ  
=
ÑÑ! "
context
ÑÑ# *
.
ÑÑ* +$
GetConferenciasOrderUC
ÑÑ+ A
(
ÑÑA B
)
ÑÑB C
.
ÖÖ 
Where
ÖÖ 
(
ÖÖ 
o
ÖÖ 
=>
ÖÖ 
o
ÖÖ  !
.
ÖÖ! "
Id
ÖÖ" $
==
ÖÖ% '
id
ÖÖ( *
)
ÖÖ* +
.
ÜÜ 
FirstOrDefault
ÜÜ #
(
ÜÜ# $
)
ÜÜ$ %
;
ÜÜ% &
return
áá 
RedirectToAction
áá '
(
áá' (
$str
áá( 6
,
áá6 7
conferencias
áá8 D
)
ááD E
;
ááE F
}
àà 
else
ââ 
{
ää 
ViewBag
ãã 
.
ãã 
Ponentes
ãã  
=
ãã! "
context
ãã# *
.
ãã* +
GetPonentes
ãã+ 6
(
ãã6 7
)
ãã7 8
;
ãã8 9
var
åå 
account
åå 
=
åå 
context
åå %
.
åå% &
GetConferencias
åå& 5
(
åå5 6
)
åå6 7
.
åå7 8
Where
åå8 =
(
åå= >
o
åå> ?
=>
åå@ B
o
ååC D
.
ååD E
Id
ååE G
==
ååH J
id
ååK M
)
ååM N
.
ååN O
FirstOrDefault
ååO ]
(
åå] ^
)
åå^ _
;
åå_ `
return
çç 
View
çç 
(
çç 
$str
çç "
,
çç" #
account
çç$ +
)
çç+ ,
;
çç, -
}
éé 
}
èè 	
[
êê 	
HttpPost
êê	 
]
êê 
public
ëë 
ActionResult
ëë 
Edit
ëë  
(
ëë  !
Conferencia
ëë! ,
conferencia
ëë- 8
,
ëë8 9
	IFormFile
ëë: C
image
ëëD I
)
ëëI J
{
íí 	
claim
ìì 
.
ìì 
SetHttpContext
ìì  
(
ìì  !
HttpContext
ìì! ,
)
ìì, -
;
ìì- .
if
îî 
(
îî 
conferencia
îî 
==
îî 
null
îî #
)
îî# $

ModelState
ïï 
.
ïï 
AddModelError
ïï (
(
ïï( )
$str
ïï) 6
,
ïï6 7
$str
ïï8 U
)
ïïU V
;
ïïV W
if
ññ 
(
ññ 

ModelState
ññ 
.
ññ 
IsValid
ññ "
)
ññ" #
{
óó 
context
òò 
.
òò 
EditConferencia
òò '
(
òò' (
conferencia
òò( 3
,
òò3 4
image
òò4 9
)
òò9 :
;
òò: ;
return
ôô 
RedirectToAction
ôô '
(
ôô' (
$str
ôô( 6
)
ôô6 7
;
ôô7 8
}
öö 
else
õõ 
{
úú 
ViewBag
ùù 
.
ùù 
Ponentes
ùù  
=
ùù! "
context
ùù# *
.
ùù* +
GetPonentes
ùù+ 6
(
ùù6 7
)
ùù7 8
;
ùù8 9
return
ûû 
View
ûû 
(
ûû 
$str
ûû "
,
ûû" #
conferencia
ûû$ /
)
ûû/ 0
;
ûû0 1
}
üü 
}
†† 	
[
¢¢ 	
HttpGet
¢¢	 
]
¢¢ 
public
££ 
ActionResult
££ 
Comprar
££ #
(
££# $
Comprar
££$ +
comprar
££, 3
,
££3 4
int
££5 8
idF
££9 <
,
££< =
string
££> D
titulo
££E K
,
££K L
decimal
££M T
monto
££U Z
)
££Z [
{
§§ 	
claim
•• 
.
•• 
SetHttpContext
••  
(
••  !
HttpContext
••! ,
)
••, -
;
••- .
var
¶¶ 
cuenta
¶¶ 
=
¶¶ 
context
¶¶  
.
¶¶  !

GetCuentas
¶¶! +
(
¶¶+ ,
)
¶¶, -
.
¶¶- .
Where
ßß 
(
ßß 
o
ßß 
=>
ßß 
o
ßß 
.
ßß 
UserId
ßß #
==
ßß$ &
claim
ßß' ,
.
ßß, -
GetLoggedUser
ßß- :
(
ßß: ;
)
ßß; <
.
ßß< =
Id
ßß= ?
)
ßß? @
.
ßß@ A
ToList
®® 
(
®® 
)
®® 
;
®® 
if
©© 
(
©© 
cuenta
©© 
.
©© 
Count
©© 
(
©© 
)
©© 
>
©©  
$num
©©! "
)
©©" #
{
™™ 
var
´´ 
compra
´´ 
=
´´ 
context
´´ $
.
´´$ %

GetCompras
´´% /
(
´´/ 0
)
´´0 1
;
´´1 2
foreach
≠≠ 
(
≠≠ 
var
≠≠ 
item
≠≠ !
in
≠≠" $
compra
≠≠% +
)
≠≠+ ,
{
ÆÆ 
if
ØØ 
(
ØØ 
item
ØØ 
.
ØØ 
IdUser
ØØ #
==
ØØ$ &
claim
ØØ' ,
.
ØØ, -
GetLoggedUser
ØØ- :
(
ØØ: ;
)
ØØ; <
.
ØØ< =
Id
ØØ= ?
&&
ØØ@ B
item
ØØC G
.
ØØG H
IdConferencia
ØØH U
==
ØØV X
idF
ØØY \
)
ØØ\ ]
{
∞∞ 
TempData
±±  
[
±±  !
$str
±±! )
]
±±) *
=
±±+ ,
$str
±±- S
;
±±S T

ModelState
≤≤ "
.
≤≤" #
AddModelError
≤≤# 0
(
≤≤0 1
$str
≤≤1 8
,
≤≤8 9
$str
≤≤: S
)
≤≤S T
;
≤≤T U
}
≥≥ 
}
¥¥ 
if
µµ 
(
µµ 

ModelState
µµ 
.
µµ 
IsValid
µµ &
)
µµ& '
{
∂∂ 
foreach
∑∑ 
(
∑∑ 
var
∑∑  
item
∑∑! %
in
∑∑& (
cuenta
∑∑) /
)
∑∑/ 0
{
∏∏ 
int
ππ 
idCuenta
ππ $
=
ππ% &
item
ππ' +
.
ππ+ ,
Id
ππ, .
;
ππ. /
var
∫∫ 
transaccionCli
∫∫ *
=
∫∫+ ,
new
∫∫- 0
Transaccion
∫∫1 <
{
ªª 
CuentaId
ºº $
=
ºº% &
idCuenta
ºº' /
,
ºº/ 0
	FechaHora
ΩΩ %
=
ΩΩ& '
DateTime
ΩΩ( 0
.
ΩΩ0 1
Now
ΩΩ1 4
,
ΩΩ4 5
Tipo
ææ  
=
ææ! "
$str
ææ# +
,
ææ+ ,
Amount
øø "
=
øø# $
monto
øø% *
*
øø+ ,
-
øø- .
$num
øø. /
,
øø/ 0
Motivo
¿¿ "
=
¿¿# $
$str
¿¿% 3
+
¿¿4 5
titulo
¿¿6 <
+
¿¿= >
$str
¿¿? J
}
¡¡ 
;
¡¡ 
var
¬¬ 
transaccionAd
¬¬ )
=
¬¬* +
new
¬¬, /
Transaccion
¬¬0 ;
{
√√ 
CuentaId
ƒƒ $
=
ƒƒ% &
$num
ƒƒ' (
,
ƒƒ( )
	FechaHora
≈≈ %
=
≈≈& '
DateTime
≈≈( 0
.
≈≈0 1
Now
≈≈1 4
,
≈≈4 5
Tipo
∆∆  
=
∆∆! "
$str
∆∆# *
,
∆∆* +
Amount
«« "
=
««# $
monto
««% *
,
««* +
Motivo
»» "
=
»»# $
$str
»»% 3
+
»»4 5
titulo
»»6 <
+
»»= >
$str
»»? J
}
…… 
;
…… 
context
   
.
    
AddTransaccion
    .
(
  . /
transaccionCli
  / =
,
  = >
transaccionAd
  ? L
)
  L M
;
  M N
context
ÀÀ 
.
ÀÀ  !
ModificaMontoCuenta
ÀÀ  3
(
ÀÀ3 4
transaccionCli
ÀÀ4 B
.
ÀÀB C
CuentaId
ÀÀC K
)
ÀÀK L
;
ÀÀL M
context
ÃÃ 
.
ÃÃ  !
ModificaMontoCuenta
ÃÃ  3
(
ÃÃ3 4
transaccionAd
ÃÃ4 A
.
ÃÃA B
CuentaId
ÃÃB J
)
ÃÃJ K
;
ÃÃK L
}
ÕÕ 
context
ŒŒ 
.
ŒŒ 

AddCompras
ŒŒ &
(
ŒŒ& '
comprar
ŒŒ' .
,
ŒŒ. /
claim
ŒŒ0 5
.
ŒŒ5 6
GetLoggedUser
ŒŒ6 C
(
ŒŒC D
)
ŒŒD E
.
ŒŒE F
Id
ŒŒF H
,
ŒŒH I
idF
ŒŒJ M
)
ŒŒM N
;
ŒŒN O
return
–– 
RedirectToAction
–– +
(
––+ ,
$str
––, :
)
––: ;
;
––; <
}
—— 
}
““ 
return
”” 
RedirectToAction
”” #
(
””# $
$str
””$ 2
)
””2 3
;
””3 4
}
‘‘ 	
[
÷÷ 	
HttpGet
÷÷	 
]
÷÷ 
public
◊◊ 
ActionResult
◊◊ 
Pasadas
◊◊ #
(
◊◊# $
string
◊◊$ *
search
◊◊+ 1
)
◊◊1 2
{
ÿÿ 	
claim
ŸŸ 
.
ŸŸ 
SetHttpContext
ŸŸ  
(
ŸŸ  !
HttpContext
ŸŸ! ,
)
ŸŸ, -
;
ŸŸ- .
if
⁄⁄ 
(
⁄⁄ 
claim
⁄⁄ 
.
⁄⁄ 
GetLoggedUser
⁄⁄ #
(
⁄⁄# $
)
⁄⁄$ %
.
⁄⁄% &
Username
⁄⁄& .
!=
⁄⁄/ 1
$str
⁄⁄2 <
)
⁄⁄< =
ViewBag
€€ 
.
€€ 
Usuario
€€ 
=
€€  !
$str
€€" ,
;
€€, -
var
›› 
ponente
›› 
=
›› 
context
›› !
.
››! "
GetPonentes
››" -
(
››- .
)
››. /
;
››/ 0
var
ﬂﬂ 
conferencia
ﬂﬂ 
=
ﬂﬂ 
context
ﬂﬂ %
.
ﬂﬂ% &$
GetConferenciasOrderUC
ﬂﬂ& <
(
ﬂﬂ< =
)
ﬂﬂ= >
;
ﬂﬂ> ?
var
·· 
compra
·· 
=
·· 
context
··  
.
··  !#
GetComprasOrderPasado
··! 6
(
··6 7
claim
··7 <
.
··< =
GetLoggedUser
··= J
(
··J K
)
··K L
.
··L M
Id
··M O
)
··O P
;
··P Q
DateTime
„„ 
fecha
„„ 
=
„„ 
DateTime
„„ %
.
„„% &
Today
„„& +
;
„„+ ,
ViewBag
‰‰ 
.
‰‰ 
fecha
‰‰ 
=
‰‰ 
fecha
‰‰ !
;
‰‰! "
ViewBag
ÊÊ 
.
ÊÊ 
Buscar
ÊÊ 
=
ÊÊ 
search
ÊÊ #
;
ÊÊ# $
if
ËË 
(
ËË 
!
ËË 
string
ËË 
.
ËË 
IsNullOrEmpty
ËË %
(
ËË% &
search
ËË& ,
)
ËË, -
)
ËË- .
{
ÈÈ 
compra
ÍÍ 
=
ÍÍ 
compra
ÍÍ 
.
ÍÍ  
Where
ÍÍ  %
(
ÍÍ% &
s
ÍÍ& '
=>
ÍÍ( *
s
ÍÍ+ ,
.
ÍÍ, -
Conferencia
ÍÍ- 8
.
ÍÍ8 9
Ponentes
ÍÍ9 A
.
ÍÍA B
NomApe
ÍÍB H
.
ÍÍH I
Contains
ÍÍI Q
(
ÍÍQ R
search
ÍÍR X
)
ÍÍX Y
||
ÍÍZ \
s
ÍÍ] ^
.
ÍÍ^ _
Conferencia
ÍÍ_ j
.
ÍÍj k

TituloConf
ÍÍk u
.
ÍÍu v
Contains
ÍÍv ~
(
ÍÍ~ 
searchÍÍ Ö
)ÍÍÖ Ü
)ÍÍÜ á
.ÍÍá à
ToListÍÍà é
(ÍÍé è
)ÍÍè ê
;ÍÍê ë
return
ÎÎ 
View
ÎÎ 
(
ÎÎ 
$str
ÎÎ %
,
ÎÎ% &
compra
ÎÎ' -
)
ÎÎ- .
;
ÎÎ. /
;
ÎÎ0 1
}
ÏÏ 
return
ÌÌ 
View
ÌÌ 
(
ÌÌ 
$str
ÌÌ !
,
ÌÌ! "
compra
ÌÌ# )
)
ÌÌ) *
;
ÌÌ* +
;
ÌÌ, -
}
ÓÓ 	
[
ÔÔ 	
HttpGet
ÔÔ	 
]
ÔÔ 
public
 
ActionResult
 
Futuras
 #
(
# $
string
$ *
search
+ 1
)
1 2
{
ÒÒ 	
claim
ÚÚ 
.
ÚÚ 
SetHttpContext
ÚÚ  
(
ÚÚ  !
HttpContext
ÚÚ! ,
)
ÚÚ, -
;
ÚÚ- .
if
ÛÛ 
(
ÛÛ 
claim
ÛÛ 
.
ÛÛ 
GetLoggedUser
ÛÛ #
(
ÛÛ# $
)
ÛÛ$ %
.
ÛÛ% &
Username
ÛÛ& .
!=
ÛÛ/ 1
$str
ÛÛ2 <
)
ÛÛ< =
ViewBag
ÙÙ 
.
ÙÙ 
Usuario
ÙÙ 
=
ÙÙ  !
$str
ÙÙ" ,
;
ÙÙ, -
var
ˆˆ 
ponente
ˆˆ 
=
ˆˆ 
context
ˆˆ !
.
ˆˆ! "
GetPonentes
ˆˆ" -
(
ˆˆ- .
)
ˆˆ. /
;
ˆˆ/ 0
var
¯¯ 
conferencia
¯¯ 
=
¯¯ 
context
¯¯ %
.
¯¯% &$
GetConferenciasOrderUC
¯¯& <
(
¯¯< =
)
¯¯= >
;
¯¯> ?
var
˙˙ 
compra
˙˙ 
=
˙˙ 
context
˙˙  
.
˙˙  !$
GetComprasOrderFuturas
˙˙! 7
(
˙˙7 8
claim
˙˙8 =
.
˙˙= >
GetLoggedUser
˙˙> K
(
˙˙K L
)
˙˙L M
.
˙˙M N
Id
˙˙N P
)
˙˙P Q
;
˙˙Q R
DateTime
¸¸ 
fecha
¸¸ 
=
¸¸ 
DateTime
¸¸ %
.
¸¸% &
Today
¸¸& +
;
¸¸+ ,
ViewBag
˝˝ 
.
˝˝ 
fecha
˝˝ 
=
˝˝ 
fecha
˝˝ !
;
˝˝! "
ViewBag
ˇˇ 
.
ˇˇ 
Buscar
ˇˇ 
=
ˇˇ 
search
ˇˇ #
;
ˇˇ# $
if
ÅÅ 
(
ÅÅ 
!
ÅÅ 
string
ÅÅ 
.
ÅÅ 
IsNullOrEmpty
ÅÅ %
(
ÅÅ% &
search
ÅÅ& ,
)
ÅÅ, -
)
ÅÅ- .
{
ÇÇ 
compra
ÉÉ 
=
ÉÉ 
compra
ÉÉ 
.
ÉÉ  
Where
ÉÉ  %
(
ÉÉ% &
s
ÉÉ& '
=>
ÉÉ( *
s
ÉÉ+ ,
.
ÉÉ, -
Conferencia
ÉÉ- 8
.
ÉÉ8 9
Ponentes
ÉÉ9 A
.
ÉÉA B
NomApe
ÉÉB H
.
ÉÉH I
Contains
ÉÉI Q
(
ÉÉQ R
search
ÉÉR X
)
ÉÉX Y
||
ÉÉZ \
s
ÉÉ] ^
.
ÉÉ^ _
Conferencia
ÉÉ_ j
.
ÉÉj k

TituloConf
ÉÉk u
.
ÉÉu v
Contains
ÉÉv ~
(
ÉÉ~ 
searchÉÉ Ö
)ÉÉÖ Ü
)ÉÉÜ á
.ÉÉá à
ToListÉÉà é
(ÉÉé è
)ÉÉè ê
;ÉÉê ë
return
ÑÑ 
View
ÑÑ 
(
ÑÑ 
$str
ÑÑ %
,
ÑÑ% &
compra
ÑÑ' -
)
ÑÑ- .
;
ÑÑ. /
}
ÖÖ 
return
ÜÜ 
View
ÜÜ 
(
ÜÜ 
$str
ÜÜ !
,
ÜÜ! "
compra
ÜÜ# )
)
ÜÜ) *
;
ÜÜ* +
}
áá 	
}
ââ 
}ää ‡J
JC:\Users\Edwin\Documents\GOLDCONF\GoldConf\Controllers\CuentaController.cs
	namespace

 	
GoldConf


 
.

 
Controllers

 
{ 
[ 
	Authorize 
] 
public 

class 
CuentaController !
:" #

Controller$ .
{ 
private 
readonly 
ICuentaRepository *
context+ 2
;2 3
private 
readonly 
IClaimService &
claim' ,
;, -
public 
CuentaController 
(  
ICuentaRepository  1
context2 9
,9 :
IClaimService; H
claimI N
)N O
{ 	
this 
. 
context 
= 
context "
;" #
this 
. 
claim 
= 
claim 
; 
} 	
[ 	
HttpGet	 
] 
public 
IActionResult 
Index "
(" #
)# $
{ 	
claim 
. 
SetHttpContext  
(  !
HttpContext! ,
), -
;- .
if 
( 
claim 
. 
GetLoggedUser #
(# $
)$ %
.% &
Username& .
!=/ 1
$str2 <
)< =
ViewBag 
. 
Usuario 
=  !
$str" ,
;, -
var 
cuentas 
= 
context !
.! "

GetCuentas" ,
(, -
)- .
. 
Where 
( 
o 
=> 
o 
. 
UserId $
==% '
claim( -
.- .
GetLoggedUser. ;
(; <
)< =
.= >
Id> @
)@ A
.   
ToList   
(   
)   
;   
ViewBag"" 
."" 
Types"" 
="" 
new"" 
List""  $
<""$ %
string""% +
>""+ ,
{""- .
$str""/ 9
,""9 :
$str""; C
}""D E
;""E F
ViewBag## 
.## 
Currency## 
=## 
new## "
List### '
<##' (
string##( .
>##. /
{##0 1
$str##2 9
}##: ;
;##; <
ViewBag%% 
.%% 
Total%% 
=%% 
cuentas%% #
.%%# $
Sum%%$ '
(%%' (
o%%( )
=>%%* ,
o%%- .
.%%. /
Amount%%/ 5
)%%5 6
;%%6 7
return&& 
View&& 
(&& 
$str&& 
,&&  
cuentas&&! (
)&&( )
;&&) *
}'' 	
[)) 	
HttpGet))	 
])) 
public** 
ActionResult** 
Crear** !
(**! "
)**" #
{++ 	
claim,, 
.,, 
SetHttpContext,,  
(,,  !
HttpContext,,! ,
),,, -
;,,- .
var-- 
cuentas-- 
=-- 
context-- !
.--! "

GetCuentas--" ,
(--, -
)--- .
... 
Where.. 
(.. 
o.. 
=>.. 
o.. 
... 
UserId.. $
==..% '
claim..( -
...- .
GetLoggedUser... ;
(..; <
)..< =
...= >
Id..> @
)..@ A
.// 
ToList// 
(// 
)// 
;// 
if00 
(00 
cuentas00 
.00 
Count00 
(00 
)00 
==00  "
$num00# $
)00$ %
{11 
ViewBag22 
.22 
Types22 
=22 
new22  #
List22$ (
<22( )
string22) /
>22/ 0
{221 2
$str223 =
,22= >
$str22? G
}22H I
;22I J
ViewBag33 
.33 
Currency33  
=33! "
new33# &
List33' +
<33+ ,
string33, 2
>332 3
{334 5
$str336 =
}33> ?
;33? @
return44 
View44 
(44 
$str44 #
,44# $
new44% (
Cuenta44) /
(44/ 0
)440 1
)441 2
;442 3
}55 
else66 
{77 
return88 
RedirectToAction88 '
(88' (
$str88( /
)88/ 0
;880 1
}99 
}:: 	
[== 	
HttpPost==	 
]== 
public>> 
IActionResult>> 
Crear>> "
(>>" #
Cuenta>># )
cuenta>>* 0
)>>0 1
{?? 	
claim@@ 
.@@ 
SetHttpContext@@  
(@@  !
HttpContext@@! ,
)@@, -
;@@- .
varAA 
cuentasAA 
=AA 
contextAA !
.AA! "

GetCuentasAA" ,
(AA, -
)AA- .
.BB 
WhereBB 
(BB 
oBB 
=>BB 
oBB 
.BB 
UserIdBB $
==BB% '
claimBB( -
.BB- .
GetLoggedUserBB. ;
(BB; <
)BB< =
.BB= >
IdBB> @
)BB@ A
.CC 
ToListCC 
(CC 
)CC 
;CC 
ifDD 
(DD 
cuentasDD 
.DD 
CountDD 
(DD 
)DD 
==DD  "
$numDD# $
)DD$ %
{EE 
ifFF 
(FF 
cuentaFF 
.FF 
AmountFF !
<FF" #
$numFF$ %
)FF% &
{GG 

ModelStateHH 
.HH 
AddModelErrorHH ,
(HH, -
$strHH- 5
,HH5 6
$strHH7 G
)HHG H
;HHH I
}II 
cuentaJJ 
.JJ 
UserIdJJ 
=JJ 
claimJJ  %
.JJ% &
GetLoggedUserJJ& 3
(JJ3 4
)JJ4 5
.JJ5 6
IdJJ6 8
;JJ8 9
ifKK 
(KK 

ModelStateKK 
.KK 
IsValidKK &
)KK& '
{LL 
ifMM 
(MM 
cuentaMM 
.MM 
AmountMM %
!=MM& (
$numMM) *
)MM* +
{NN 
cuentaOO 
.OO 
TransaccionsOO +
=OO, -
newOO. 1
ListOO2 6
<OO6 7
TransaccionOO7 B
>OOB C
{PP 
newQQ 
TransaccionQQ  +
{RR 
	FechaHoraSS  )
=SS* +
DateTimeSS, 4
.SS4 5
NowSS5 8
,SS8 9
TipoTT  $
=TT% &
$strTT' 0
,TT0 1
AmountUU  &
=UU' (
cuentaUU) /
.UU/ 0
AmountUU0 6
,UU6 7
MotivoVV  &
=VV' (
$strVV) 8
}WW 
}XX 
;XX 
}YY 
contextZZ 
.ZZ 
NewTransaccionZZ *
(ZZ* +
cuentaZZ+ 1
)ZZ1 2
;ZZ2 3
return[[ 
RedirectToAction[[ +
([[+ ,
$str[[, 3
)[[3 4
;[[4 5
}\\ 
else]] 
{^^ 
ViewBag__ 
.__ 
Types__ !
=__" #
new__$ '
List__( ,
<__, -
string__- 3
>__3 4
{__5 6
$str__7 A
,__A B
$str__C K
}__L M
;__M N
ViewBag`` 
.`` 
Currency`` $
=``% &
new``' *
List``+ /
<``/ 0
string``0 6
>``6 7
{``8 9
$str``: A
}``B C
;``C D
returnaa 
Viewaa 
(aa  
$straa  '
,aa' (
cuentaaa) /
)aa/ 0
;aa0 1
}bb 
}cc 
elsedd 
{ee 
returnff 
RedirectToActionff '
(ff' (
$strff( /
)ff/ 0
;ff0 1
}gg 
}ii 	
[kk 	
HttpGetkk	 
]kk 
publicll 
ActionResultll 
Transaccionll '
(ll' (
intll( +
idll, .
)ll. /
{mm 	
claimnn 
.nn 
SetHttpContextnn  
(nn  !
HttpContextnn! ,
)nn, -
;nn- .
ifoo 
(oo 
claimoo 
.oo 
GetLoggedUseroo #
(oo# $
)oo$ %
.oo% &
Usernameoo& .
!=oo/ 1
$stroo2 <
)oo< =
ViewBagpp 
.pp 
Usuariopp 
=pp  !
$strpp" ,
;pp, -
varrr 
transaccionesrr 
=rr 
contextrr  '
.rr' (
GetTransaccionsrr( 7
(rr7 8
idrr8 :
)rr: ;
;rr; <
ViewBagss 
.ss 
Cuentass 
=ss 
contextss $
.ss$ %

GetCuentasss% /
(ss/ 0
idss0 2
)ss2 3
;ss3 4
returntt 
Viewtt 
(tt 
$strtt %
,tt% &
transaccionestt' 4
)tt4 5
;tt5 6
}uu 	
}vv 
}ww ù
HC:\Users\Edwin\Documents\GOLDCONF\GoldConf\Controllers\HomeController.cs
	namespace 	
GoldConf
 
. 
Controllers 
{ 
public 

class 
HomeController 
:  !

Controller" ,
{ 
private 
readonly 
IHomeRepository (
context) 0
;0 1
public 
HomeController 
( 
IHomeRepository -
context. 5
)5 6
{ 	
this 
. 
context 
= 
context "
;" #
} 	
public 
IActionResult 
Index "
(" #
)# $
{ 	
try 
{ 
var 
ponente 
= 
context %
.% &
GetPonentes& 1
(1 2
)2 3
;3 4
ViewBag 
. 
Conferencia #
=$ %
context& -
.- .
GetConferencias. =
(= >
)> ?
;? @
return 
View 
( 
$str #
,# $
ponente% ,
), -
;- .
} 
catch   
(   
	Exception   
ex   
)    
{!! 
throw"" 
new"" 
	Exception"" #
(""# $
ex""$ &
.""& '
Message""' .
)"". /
;""/ 0
}## 
}$$ 	
[&& 	
ResponseCache&&	 
(&& 
Duration&& 
=&&  !
$num&&" #
,&&# $
Location&&% -
=&&. /!
ResponseCacheLocation&&0 E
.&&E F
None&&F J
,&&J K
NoStore&&L S
=&&T U
true&&V Z
)&&Z [
]&&[ \
public'' 
IActionResult'' 
Error'' "
(''" #
)''# $
{(( 	
return)) 
View)) 
()) 
new)) 
ErrorViewModel)) *
{))+ ,
	RequestId))- 6
=))7 8
Activity))9 A
.))A B
Current))B I
?))I J
.))J K
Id))K M
??))N P
HttpContext))Q \
.))\ ]
TraceIdentifier))] l
}))m n
)))n o
;))o p
}** 	
}++ 
},, „Z
KC:\Users\Edwin\Documents\GOLDCONF\GoldConf\Controllers\PonenteController.cs
	namespace

 	
GoldConf


 
.

 
Controllers

 
{ 
[ 
	Authorize 
] 
public 

class 
PonenteController "
:# $

Controller% /
{ 
private 
readonly 
IPonenteRepository +
context, 3
;3 4
private 
readonly 
IClaimService &
claim' ,
;, -
public 
readonly 
IHostEnvironment (
hostEnv) 0
;0 1
public 
PonenteController  
(  !
IPonenteRepository! 3
context4 ;
,; <
IHostEnvironment= M
hostEnvN U
,U V
IClaimServiceW d
claime j
)j k
{ 	
this 
. 
context 
= 
context "
;" #
this 
. 
hostEnv 
= 
hostEnv "
;" #
this 
. 
claim 
= 
claim 
; 
} 	
[ 	
HttpGet	 
] 
public 
ActionResult 
Ponente #
(# $
string$ *
search+ 1
)1 2
{ 	
claim 
. 
SetHttpContext  
(  !
HttpContext! ,
), -
;- .
if 
( 
claim 
. 
GetLoggedUser #
(# $
)$ %
.% &
Username& .
!=/ 1
$str2 <
)< =
ViewBag 
. 
Usuario 
=  !
$str" ,
;, -
ViewBag!! 
.!! 
Buscar!! 
=!! 
search!! #
;!!# $
var## 
ponente## 
=## 
context## !
.##! "
GetPonentes##" -
(##- .
)##. /
;##/ 0
if%% 
(%% 
!%% 
string%% 
.%% 
IsNullOrEmpty%% %
(%%% &
search%%& ,
)%%, -
)%%- .
{&& 
ponente'' 
='' 
context'' !
.''! "
GetPonentesSearch''" 3
(''3 4
search''4 :
)'': ;
;''; <
return(( 
View(( 
((( 
$str(( %
,((% &
ponente((' .
)((. /
;((/ 0
})) 
return++ 
View++ 
(++ 
$str++ !
,++! "
ponente++# *
)++* +
;+++ ,
},, 	
[-- 	
HttpGet--	 
]-- 
public.. 
ActionResult.. 
Detalle.. #
(..# $
int..$ '
	idPonente..( 1
)..1 2
{// 	
claim00 
.00 
SetHttpContext00  
(00  !
HttpContext00! ,
)00, -
;00- .
ViewBag11 
.11 
Cuenta11 
=11 
context11 $
.11$ %
GetCuentaUser11% 2
(112 3
)113 4
.22 
Where22 
(22 
o22 
=>22 
o22  
.22  !
UserId22! '
==22( *
claim22+ 0
.220 1
GetLoggedUser221 >
(22> ?
)22? @
.22@ A
Id22A C
)22C D
.22D E
ToList22E K
(22K L
)22L M
;22M N
if33 
(33 
claim33 
.33 
GetLoggedUser33 #
(33# $
)33$ %
.33% &
Username33& .
!=33/ 1
$str332 <
)33< =
{44 
ViewBag55 
.55 
Usuario55 
=55  !
$str55" ,
;55, -
ViewBag66 
.66 
Compra66 
=66  
context66! (
.66( )

GetCompras66) 3
(663 4
)664 5
.77 
Where77 
(77 
o77 
=>77 
o77  !
.77! "
IdUser77" (
==77) +
claim77, 1
.771 2
GetLoggedUser772 ?
(77? @
)77@ A
.77A B
Id77B D
)77D E
.77E F
ToList77F L
(77L M
)77M N
;77N O
}88 
else99 
{:: 
ViewBag;; 
.;; 
Compra;; 
=;;  
context;;! (
.;;( )

GetCompras;;) 3
(;;3 4
);;4 5
;;;5 6
}<< 
var>> 
Ponente>> 
=>> 
context>> !
.>>! "

GetPonente>>" ,
(>>, -
	idPonente>>- 6
)>>6 7
;>>7 8
ViewBag@@ 
.@@ 
Conferencias@@  
=@@! "
context@@# *
.@@* +"
GetConferenciasPonente@@+ A
(@@A B
	idPonente@@B K
)@@K L
;@@L M
ViewBagBB 
.BB 
CursosBB 
=BB 
contextBB $
.BB$ %"
GetConferenciasPonenteBB% ;
(BB; <
	idPonenteBB< E
)BBE F
.BBF G
CountBBG L
(BBL M
)BBM N
;BBN O
returnDD 
ViewDD 
(DD 
$strDD !
,DD! "
PonenteDD# *
)DD* +
;DD+ ,
}EE 	
[GG 	
HttpGetGG	 
]GG 
publicHH 
IActionResultHH 
	RegistrarHH &
(HH& '
)HH' (
{II 	
claimJJ 
.JJ 
SetHttpContextJJ  
(JJ  !
HttpContextJJ! ,
)JJ, -
;JJ- .
ifKK 
(KK 
claimKK 
.KK 
GetLoggedUserKK #
(KK# $
)KK$ %
.KK% &
UsernameKK& .
!=KK/ 1
$strKK2 <
)KK< =
{LL 
varMM 
ponentesMM 
=MM 
contextMM &
.MM& '
GetPonentesMM' 2
(MM2 3
)MM3 4
;MM4 5
returnNN 
RedirectToActionNN '
(NN' (
$strNN( 1
,NN1 2
ponentesNN3 ;
)NN; <
;NN< =
}OO 
elsePP 
{QQ 
returnRR 
ViewRR 
(RR 
$strRR '
,RR' (
newRR) ,
PonenteRR- 4
(RR4 5
)RR5 6
)RR6 7
;RR7 8
}SS 
}TT 	
[UU 	
HttpPostUU	 
]UU 
publicVV 
ActionResultVV 
	RegistrarVV %
(VV% &
PonenteVV& -
ponenteVV. 5
,VV5 6
	IFormFileVV7 @
imageVVA F
,VVF G
stringVVH N
emailVVO T
,VVT U
stringVVV \
telefonoVV] e
)VVe f
{WW 	
claimXX 
.XX 
SetHttpContextXX  
(XX  !
HttpContextXX! ,
)XX, -
;XX- .
ifYY 
(YY 
claimYY 
.YY 
GetLoggedUserYY #
(YY# $
)YY$ %
.YY% &
UsernameYY& .
!=YY/ 1
$strYY2 <
)YY< =
{ZZ 
var[[ 
ponentes[[ 
=[[ 
context[[ &
.[[& '
GetPonentes[[' 2
([[2 3
)[[3 4
;[[4 5
return\\ 
RedirectToAction\\ '
(\\' (
$str\\( 1
,\\1 2
ponentes\\3 ;
)\\; <
;\\< =
}]] 
else^^ 
{__ 
var`` 
ponentes`` 
=`` 
context`` &
.``& '
GetPonentes``' 2
(``2 3
)``3 4
;``4 5
foreachaa 
(aa 
varaa 
itemaa !
inaa" $
ponentesaa% -
)aa- .
{bb 
ifcc 
(cc 
itemcc 
.cc 
Emailcc "
==cc# %
emailcc& +
)cc+ ,

ModelStatedd "
.dd" #
AddModelErrordd# 0
(dd0 1
$strdd1 8
,dd8 9
$strdd: P
)ddP Q
;ddQ R
ifee 
(ee 
itemee 
.ee 
Telefonoee %
==ee& (
telefonoee) 1
)ee1 2

ModelStateff "
.ff" #
AddModelErrorff# 0
(ff0 1
$strff1 ;
,ff; <
$strff= T
)ffT U
;ffU V
}gg 
ifhh 
(hh 

ModelStatehh 
.hh 
IsValidhh &
)hh& '
{ii 
contextjj 
.jj 

NewPonentejj &
(jj& '
ponentejj' .
,jj. /
imagejj0 5
)jj5 6
;jj6 7
returnkk 
RedirectToActionkk +
(kk+ ,
$strkk, 5
)kk5 6
;kk6 7
}ll 
elsemm 
{nn 
returnoo 
RedirectToActionoo +
(oo+ ,
$stroo, 7
,oo7 8
ponenteoo9 @
)oo@ A
;ooA B
}pp 
}qq 
}rr 	
[tt 	
HttpGettt	 
]tt 
publicuu 
ActionResultuu 
Edituu  
(uu  !
intuu! $
iduu% '
)uu' (
{vv 	
claimww 
.ww 
SetHttpContextww  
(ww  !
HttpContextww! ,
)ww, -
;ww- .
ifxx 
(xx 
claimxx 
.xx 
GetLoggedUserxx #
(xx# $
)xx$ %
.xx% &
Usernamexx& .
!=xx/ 1
$strxx2 <
)xx< =
{yy 
varzz 
ponentezz 
=zz 
contextzz %
.zz% &
GetPonenteszz& 1
(zz1 2
)zz2 3
;zz3 4
return{{ 
RedirectToAction{{ '
({{' (
$str{{( 1
,{{1 2
ponente{{3 :
){{: ;
;{{; <
}|| 
else}} 
{~~ 
var 
ponente 
= 
context %
.% &

GetPonente& 0
(0 1
id1 3
)3 4
;4 5
return
ÄÄ 
View
ÄÄ 
(
ÄÄ 
$str
ÄÄ "
,
ÄÄ" #
ponente
ÄÄ$ +
)
ÄÄ+ ,
;
ÄÄ, -
}
ÅÅ 
}
ÇÇ 	
[
ÑÑ 	
HttpPost
ÑÑ	 
]
ÑÑ 
public
ÖÖ 
ActionResult
ÖÖ 
Edit
ÖÖ  
(
ÖÖ  !
Ponente
ÖÖ! (
ponente
ÖÖ) 0
,
ÖÖ0 1
	IFormFile
ÖÖ2 ;
image
ÖÖ< A
)
ÖÖA B
{
ÜÜ 	
if
áá 
(
áá 

ModelState
áá 
.
áá 
IsValid
áá "
)
áá" #
{
àà 
context
ââ 
.
ââ 
EditPonente
ââ #
(
ââ# $
ponente
ââ$ +
,
ââ+ ,
image
ââ, 1
)
ââ1 2
;
ââ2 3
return
ää 
RedirectToAction
ää '
(
ää' (
$str
ää( 1
)
ää1 2
;
ää2 3
}
ãã 
else
åå 
{
çç 
return
éé 
View
éé 
(
éé 
$str
éé "
,
éé" #
ponente
éé# *
)
éé* +
;
éé+ ,
}
èè 
}
êê 	
}
ëë 
}íí Ç
<C:\Users\Edwin\Documents\GOLDCONF\GoldConf\Models\Comprar.cs
	namespace 	
GoldConf
 
. 
Models 
{ 
public 

class 
Comprar 
{		 
public

 
int

 
Id

 
{

 
get

 
;

 
set

  
;

  !
}

" #
public 
int 
IdConferencia  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
int 
IdUser 
{ 
get 
;  
set! $
;$ %
}& '
public 
Conferencia 
Conferencia &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
User 
User 
{ 
get 
; 
set  #
;# $
}% &
} 
} é
@C:\Users\Edwin\Documents\GOLDCONF\GoldConf\Models\Conferencia.cs
	namespace 	
GoldConf
 
. 
Models 
{ 
public		 

class		 
Conferencia		 
{

 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
string 
	ImagePath 
{  !
get" %
;% &
set' *
;* +
}, -
[ 	
Required	 
] 
public 
int 
	PonenteId 
{ 
get "
;" #
set$ '
;' (
}) *
[ 	
Required	 
] 
public 
DateTime 
	FechaConf !
{" #
get$ '
;' (
set) ,
;, -
}. /
[ 	
Required	 
] 
public 
string 

TituloConf  
{! "
get# &
;& '
set( +
;+ ,
}- .
[ 	
Required	 
] 
public 
decimal 

PrecioConf !
{" #
get$ '
;' (
set) ,
;, -
}. /
[ 	
Required	 
] 
public 
string 
DetalleConf !
{" #
get$ '
;' (
set) ,
;, -
}. /
[ 	
Required	 
] 
public 
string 
Ap1 
{ 
get 
;  
set! $
;$ %
}& '
[ 	
Required	 
] 
public 
string 
Ap2 
{ 
get 
;  
set! $
;$ %
}& '
[ 	
Required	 
] 
public 
string 
Ap3 
{ 
get 
;  
set! $
;$ %
}& '
[ 	
Required	 
] 
public 
string 

Definicion  
{! "
get# &
;& '
set( +
;+ ,
}- .
[ 	
Required	 
] 
public   
string   
Objetivo   
{    
get  ! $
;  $ %
set  & )
;  ) *
}  + ,
[!! 	
Required!!	 
]!! 
public"" 
string"" 
	MetaFinal"" 
{""  !
get""" %
;""% &
set""' *
;""* +
}"", -
public## 
Ponente## 
Ponentes## 
{##  !
get##" %
;##% &
set##' *
;##* +
}##, -
public$$ 
List$$ 
<$$ 
Comprar$$ 
>$$ 
Compras$$ $
{$$% &
get$$' *
;$$* +
set$$, /
;$$/ 0
}$$1 2
}%% 
}&& ò
;C:\Users\Edwin\Documents\GOLDCONF\GoldConf\Models\Cuenta.cs
	namespace 	
GoldConf
 
. 
Models 
{ 
public		 

class		 
Cuenta		 
{

 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
[ 	
Required	 
( 
ErrorMessage 
=  
$str! <
)< =
]= >
public 
string 
Type 
{ 
get  
;  !
set" %
;% &
}' (
[ 	
Required	 
( 
ErrorMessage 
=  
$str! <
)< =
]= >
public 
string 
Name 
{ 
get  
;  !
set" %
;% &
}' (
[ 	
Required	 
( 
ErrorMessage 
=  
$str! <
)< =
]= >
public 
string 
Currency 
{  
get! $
;$ %
set& )
;) *
}+ ,
[ 	
Required	 
( 
ErrorMessage 
=  
$str! <
)< =
]= >
public 
decimal 
Amount 
{ 
get  #
;# $
set% (
;( )
}* +
public 
int 
UserId 
{ 
get 
;  
set! $
;$ %
}& '
public 
List 
< 
Transaccion 
>  
Transaccions! -
{. /
get0 3
;3 4
set5 8
;8 9
}: ;
} 
} à
@C:\Users\Edwin\Documents\GOLDCONF\GoldConf\Models\Descripcion.cs
	namespace 	
GoldConf
 
. 
Models 
{ 
public 

class 
Descripcion 
{		 
}

 
} ç
CC:\Users\Edwin\Documents\GOLDCONF\GoldConf\Models\ErrorViewModel.cs
	namespace 	
GoldConf
 
. 
Models 
{ 
public 

class 
ErrorViewModel 
{ 
public 
string 
	RequestId 
{  !
get" %
;% &
set' *
;* +
}, -
public		 
bool		 
ShowRequestId		 !
=>		" $
!		% &
string		& ,
.		, -
IsNullOrEmpty		- :
(		: ;
	RequestId		; D
)		D E
;		E F
}

 
} ”$
DC:\Users\Edwin\Documents\GOLDCONF\GoldConf\Models\GoldConfContext.cs
	namespace 	
GoldConf
 
. 
Models 
{		 
public

 

	interface

 
IGoldConfContext

 %
{ 
DbSet 
< 
User 
> 
Users 
{ 
get 
;  
set! $
;$ %
}& '
DbSet 
< 
Conferencia 
> 
Conferencias '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
DbSet 
< 
Ponente 
> 
Ponentes 
{  !
get" %
;% &
set' *
;* +
}, -
DbSet 
< 
Comprar 
> 
Compras 
{  
get! $
;$ %
set& )
;) *
}+ ,
DbSet 
< 
Cuenta 
> 
Cuentas 
{ 
get  #
;# $
set% (
;( )
}* +
DbSet 
< 
Transaccion 
> 
Transacciones (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
int 
SaveChanges 
( 
) 
; 
} 
public 

class 
GoldConfContext  
:! "
	DbContext# ,
,, -
IGoldConfContext. >
{ 
public 
DbSet 
< 
User 
> 
Users  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
DbSet 
< 
Conferencia  
>  !
Conferencias" .
{/ 0
get1 4
;4 5
set6 9
;9 :
}; <
public 
DbSet 
< 
Ponente 
> 
Ponentes &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
DbSet 
< 
Comprar 
> 
Compras %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 
DbSet 
< 
Cuenta 
> 
Cuentas $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
DbSet 
< 
Transaccion  
>  !
Transacciones" /
{0 1
get2 5
;5 6
set7 :
;: ;
}< =
public 
GoldConfContext 
( 
DbContextOptions /
</ 0
GoldConfContext0 ?
>? @
optionsA H
)H I
: 
base 
( 
options 
) 
{ 
} 
	protected   
override   
void   
OnModelCreating    /
(  / 0
ModelBuilder  0 <
modelBuilder  = I
)  I J
{!! 	
base"" 
."" 
OnModelCreating""  
(""  !
modelBuilder""! -
)""- .
;"". /
modelBuilder%% 
.%% 
ApplyConfiguration%% +
(%%+ ,
new%%, /
UserMap%%0 7
(%%7 8
)%%8 9
)%%9 :
;%%: ;
modelBuilder&& 
.&& 
ApplyConfiguration&& +
(&&+ ,
new&&, /
ConferenciaMap&&0 >
(&&> ?
)&&? @
)&&@ A
;&&A B
modelBuilder'' 
.'' 
ApplyConfiguration'' +
(''+ ,
new'', /

PonenteMap''0 :
('': ;
)''; <
)''< =
;''= >
modelBuilder(( 
.(( 
ApplyConfiguration(( +
(((+ ,
new((, /

ComprarMap((0 :
(((: ;
)((; <
)((< =
;((= >
modelBuilder)) 
.)) 
ApplyConfiguration)) +
())+ ,
new)), /
	CuentaMap))0 9
())9 :
))): ;
))); <
;))< =
modelBuilder** 
.** 
ApplyConfiguration** +
(**+ ,
new**, /
TransaccionMap**0 >
(**> ?
)**? @
)**@ A
;**A B
},, 	
}-- 
}.. ê
DC:\Users\Edwin\Documents\GOLDCONF\GoldConf\Models\Maps\ComprarMap.cs
	namespace 	
GoldConf
 
. 
Models 
. 
Maps 
{ 
public		 

class		 

ComprarMap		 
:		 $
IEntityTypeConfiguration		 6
<		6 7
Comprar		7 >
>		> ?
{

 
public 
void 
	Configure 
( 
	Microsoft '
.' (
EntityFrameworkCore( ;
.; <
Metadata< D
.D E
BuildersE M
.M N
EntityTypeBuilderN _
<_ `
Comprar` g
>g h
builderi p
)p q
{ 	
builder 
. 
ToTable 
( 
$str +
)+ ,
;, -
builder 
. 
HasKey 
( 
o 
=> 
o  !
.! "
Id" $
)$ %
;% &
builder 
. 
HasOne 
( 
y 
=> 
y  !
.! "
User" &
)& '
. 
WithMany 
( 
y 
=> 
y  
.  !
Compras! (
)( )
. 
HasForeignKey 
( 
y  
=>! #
y$ %
.% &
IdUser& ,
), -
;- .
builder 
. 
HasOne 
( 
x 
=> 
x  !
.! "
Conferencia" -
)- .
. 
WithMany 
( 
x 
=> 
x  
.  !
Compras! (
)( )
. 
HasForeignKey 
( 
x  
=>! #
x$ %
.% &
IdConferencia& 3
)3 4
;4 5
} 	
} 
} ≈

HC:\Users\Edwin\Documents\GOLDCONF\GoldConf\Models\Maps\ConferenciaMap.cs
	namespace 	
GoldConf
 
. 
Models 
. 
Maps 
{		 
public

 

class

 
ConferenciaMap

 
:

  !$
IEntityTypeConfiguration

" :
<

: ;
Conferencia

; F
>

F G
{ 
public 
void 
	Configure 
( 
EntityTypeBuilder /
</ 0
Conferencia0 ;
>; <
builder= D
)D E
{ 	
builder 
. 
ToTable 
( 
$str )
)) *
;* +
builder 
. 
HasKey 
( 
o 
=> 
o  !
.! "
Id" $
)$ %
;% &
builder 
. 
HasOne 
( 
o 
=> 
o  !
.! "
Ponentes" *
)* +
.+ ,
WithMany 
( 
) 
. 
HasForeignKey 
( 
o 
=>  "
o# $
.$ %
	PonenteId% .
). /
;/ 0
} 	
} 
} ¥

CC:\Users\Edwin\Documents\GOLDCONF\GoldConf\Models\Maps\CuentaMap.cs
	namespace 	
GoldConf
 
. 
Models 
. 
Maps 
{		 
public

 

class

 
	CuentaMap

 
:

 $
IEntityTypeConfiguration

 5
<

5 6
Cuenta

6 <
>

< =
{ 
public 
void 
	Configure 
( 
EntityTypeBuilder /
</ 0
Cuenta0 6
>6 7
builder8 ?
)? @
{ 	
builder 
. 
ToTable 
( 
$str $
)$ %
;% &
builder 
. 
HasKey 
( 
o 
=> 
o  !
.! "
Id" $
)$ %
;% &
builder 
. 
HasMany 
( 
o 
=>  
o! "
." #
Transaccions# /
)/ 0
.0 1
WithOne 
( 
) 
. 
HasForeignKey 
( 
o 
=>  "
o# $
.$ %
CuentaId% -
)- .
;. /
} 	
} 
} û
DC:\Users\Edwin\Documents\GOLDCONF\GoldConf\Models\Maps\PonenteMap.cs
	namespace 	
GoldConf
 
. 
Models 
. 
Maps 
{		 
public

 

class

 

PonenteMap

 
:

 $
IEntityTypeConfiguration

 6
<

6 7
Ponente

7 >
>

> ?
{ 
public 
void 
	Configure 
( 
EntityTypeBuilder /
</ 0
Ponente0 7
>7 8
builder9 @
)@ A
{ 	
builder 
. 
ToTable 
( 
$str %
)% &
;& '
builder 
. 
HasKey 
( 
o 
=> 
o  !
.! "
Id" $
)$ %
;% &
} 	
} 
} Æ
HC:\Users\Edwin\Documents\GOLDCONF\GoldConf\Models\Maps\TransaccionMap.cs
	namespace 	
GoldConf
 
. 
Models 
. 
Maps 
{		 
public

 

class

 
TransaccionMap

 
:

  !$
IEntityTypeConfiguration

" :
<

: ;
Transaccion

; F
>

F G
{ 
public 
void 
	Configure 
( 
EntityTypeBuilder /
</ 0
Transaccion0 ;
>; <
builder= D
)D E
{ 	
builder 
. 
ToTable 
( 
$str )
)) *
;* +
builder 
. 
HasKey 
( 
o 
=> 
o  !
.! "
Id" $
)$ %
;% &
} 	
} 
} í
AC:\Users\Edwin\Documents\GOLDCONF\GoldConf\Models\Maps\UserMap.cs
	namespace 	
GoldConf
 
. 
Models 
. 
Maps 
{		 
public

 

class

 
UserMap

 
:

 $
IEntityTypeConfiguration

 3
<

3 4
User

4 8
>

8 9
{ 
public 
void 
	Configure 
( 
EntityTypeBuilder /
</ 0
User0 4
>4 5
builder6 =
)= >
{ 	
builder 
. 
ToTable 
( 
$str "
)" #
;# $
builder 
. 
HasKey 
( 
o 
=> 
o  !
.! "
Id" $
)$ %
;% &
} 	
} 
} Ÿ

AC:\Users\Edwin\Documents\GOLDCONF\GoldConf\Models\PaypalLogger.cs
	namespace 	
GoldConf
 
. 
Models 
{		 
public

 

class

 
PaypalLogger

 
{ 
public 
static 
string 
LogDirectoryPath -
=. /
Environment0 ;
.; <
CurrentDirectory< L
;L M
public 
static 
void 
Log 
( 
String %
messages& .
). /
{ 	
try 
{ 
StreamWriter 
strw !
=" #
new$ '
StreamWriter( 4
(4 5
LogDirectoryPath5 E
+F G
$strH [
,[ \
true\ `
)` a
;a b
strw 
. 
	WriteLine 
( 
$str )
,) *
DateTime+ 3
.3 4
Now4 7
.7 8
ToString8 @
(@ A
$strA V
)V W
,W X
messagesY a
)a b
;b c
} 
catch 
( 
	Exception 
) 
{ 
throw 
; 
} 
} 	
} 
} ≠
<C:\Users\Edwin\Documents\GOLDCONF\GoldConf\Models\Ponente.cs
	namespace 	
GoldConf
 
. 
Models 
{ 
public		 

class		 
Ponente		 
{

 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
string 
Imagen 
{ 
get "
;" #
set$ '
;' (
}) *
[ 	
Required	 
( 
ErrorMessage 
=  
$str! <
)< =
]= >
public 
string 
NomApe 
{ 
get "
;" #
set$ '
;' (
}) *
[ 	
Required	 
( 
ErrorMessage 
=  
$str! <
)< =
]= >
public 
string 
Especialidad "
{# $
get% (
;( )
set* -
;- .
}/ 0
[ 	
Required	 
( 
ErrorMessage 
=  
$str! <
)< =
]= >
[ 	
EmailAddress	 
] 
public 
string 
Email 
{ 
get !
;! "
set# &
;& '
}( )
[ 	
Required	 
( 
ErrorMessage 
=  
$str! <
)< =
]= >
[ 	
RegularExpression	 
( 
$str $
)$ %
]% &
[ 	
	MinLength	 
( 
$num 
) 
] 
public 
string 
Telefono 
{  
get! $
;$ %
set& )
;) *
}+ ,
[ 	
Required	 
( 
ErrorMessage 
=  
$str! <
)< =
]= >
public 
string 
Logros 
{ 
get "
;" #
set$ '
;' (
}) *
[ 	
Required	 
( 
ErrorMessage 
=  
$str! <
)< =
]= >
public 
string 
Experiencia !
{" #
get$ '
;' (
set) ,
;, -
}. /
} 
} ·
@C:\Users\Edwin\Documents\GOLDCONF\GoldConf\Models\Transaccion.cs
	namespace 	
GoldConf
 
. 
Models 
{ 
public		 

class		 
Transaccion		 
{

 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
[ 	
Required	 
( 
ErrorMessage 
=  
$str! <
)< =
]= >
public 
int 
CuentaId 
{ 
get !
;! "
set# &
;& '
}( )
[ 	
Required	 
( 
ErrorMessage 
=  
$str! <
)< =
]= >
public 
string 
Tipo 
{ 
get  
;  !
set" %
;% &
}' (
[ 	
Required	 
( 
ErrorMessage 
=  
$str! <
)< =
]= >
public 
DateTime 
	FechaHora !
{" #
get$ '
;' (
set) ,
;, -
}. /
[ 	
Required	 
( 
ErrorMessage 
=  
$str! <
)< =
]= >
public 
string 
Motivo 
{ 
get "
;" #
set$ '
;' (
}) *
[ 	
Required	 
( 
ErrorMessage 
=  
$str! <
)< =
]= >
public 
decimal 
Amount 
{ 
get  #
;# $
set% (
;( )
}* +
} 
} è
9C:\Users\Edwin\Documents\GOLDCONF\GoldConf\Models\User.cs
	namespace 	
GoldConf
 
. 
Models 
{ 
public		 

class		 
User		 
{

 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
[ 	
Required	 
( 
ErrorMessage 
=  
$str! <
)< =
]= >
public 
string 
NomApe 
{ 
get "
;" #
set$ '
;' (
}) *
[ 	
Required	 
( 
ErrorMessage 
=  
$str! <
)< =
]= >
[ 	
EmailAddress	 
] 
public 
string 
Email 
{ 
get !
;! "
set# &
;& '
}( )
[ 	
Required	 
( 
ErrorMessage 
=  
$str! <
)< =
]= >
[ 	
RegularExpression	 
( 
$str *
)* +
]+ ,
public 
string 
Username 
{  
get! $
;$ %
set& )
;) *
}+ ,
[ 	
Required	 
( 
ErrorMessage 
=  
$str! <
)< =
]= >
[ 	
DataType	 
( 
DataType 
. 
Password #
)# $
]$ %
[ 	
	MinLength	 
( 
$num 
) 
] 
public 
string 
Password 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
List 
< 
Comprar 
> 
Compras $
{% &
get' *
;* +
set, /
;/ 0
}1 2
} 
} ã

5C:\Users\Edwin\Documents\GOLDCONF\GoldConf\Program.cs
	namespace

 	
GoldConf


 
{ 
public 

class 
Program 
{ 
public 
static 
void 
Main 
(  
string  &
[& '
]' (
args) -
)- .
{ 	
CreateHostBuilder 
( 
args "
)" #
.# $
Build$ )
() *
)* +
.+ ,
Run, /
(/ 0
)0 1
;1 2
} 	
public 
static 
IHostBuilder "
CreateHostBuilder# 4
(4 5
string5 ;
[; <
]< =
args> B
)B C
=>D F
Host 
.  
CreateDefaultBuilder %
(% &
args& *
)* +
. $
ConfigureWebHostDefaults )
() *

webBuilder* 4
=>5 7
{ 

webBuilder 
. 

UseStartup )
<) *
Startup* 1
>1 2
(2 3
)3 4
;4 5
} 
) 
; 
} 
} — 
GC:\Users\Edwin\Documents\GOLDCONF\GoldConf\Repository\AuthRepository.cs
	namespace 	
GoldConf
 
. 

Repository 
{ 
public 

	interface 
IAuthRepository $
{ 
User 

GetUsuario 
( 
string 
username '
,' (
string) /
password0 8
)8 9
;9 :
void 
SaveUsuario 
( 
User 
user "
)" #
;# $
List 
< 
User 
> 
GetUsuarios 
( 
)  
;  !
} 
public 

class 
AuthRepository 
:  
IAuthRepository! 0
{ 
private 
readonly 
IGoldConfContext )
context* 1
;1 2
private 
readonly 
IConfiguration '
configuration( 5
;5 6
public 
AuthRepository 
( 
IGoldConfContext .
context/ 6
,6 7
IConfiguration8 F
configurationG T
)T U
{ 	
this 
. 
context 
= 
context "
;" #
this 
. 
configuration 
=  
configuration! .
;. /
} 	
public 
User 

GetUsuario 
( 
string %
username& .
,. /
string0 6
password7 ?
)? @
{ 	
return   
context   
.   
Users    
.    !
Where  ! &
(  & '
o  ' (
=>  ) +
o  , -
.  - .
Username  . 6
==  7 9
username  : B
&&  C E
o  F G
.  G H
Password  H P
==  Q S

CreateHash  T ^
(  ^ _
password  _ g
)  g h
)  h i
.  i j
FirstOrDefault  j x
(  x y
)  y z
;  z {
}!! 	
public## 
List## 
<## 
User## 
>## 
GetUsuarios## %
(##% &
)##& '
{$$ 	
return%% 
context%% 
.%% 
Users%%  
.%%  !
ToList%%! '
(%%' (
)%%( )
;%%) *
}&& 	
public(( 
void(( 
SaveUsuario(( 
(((  
User((  $
user((% )
)(() *
{)) 	
user** 
.** 
Password** 
=** 

CreateHash** &
(**& '
user**' +
.**+ ,
Password**, 4
)**4 5
;**5 6
context++ 
.++ 
Users++ 
.++ 
Add++ 
(++ 
user++ "
)++" #
;++# $
context,, 
.,, 
SaveChanges,, 
(,,  
),,  !
;,,! "
}-- 	
	protected// 
string// 

CreateHash// #
(//# $
string//$ *
input//+ 0
)//0 1
{00 	
var11 
sha11 
=11 
SHA25611 
.11 
Create11 #
(11# $
)11$ %
;11% &
input22 
+=22 
configuration22 "
.22" #
GetValue22# +
<22+ ,
string22, 2
>222 3
(223 4
$str224 ;
)22; <
;22< =
var33 
hash33 
=33 
sha33 
.33 
ComputeHash33 &
(33& '
Encoding33' /
.33/ 0
Default330 7
.337 8
GetBytes338 @
(33@ A
input33A F
)33F G
)33G H
;33H I
return55 
Convert55 
.55 
ToBase64String55 )
(55) *
hash55* .
)55. /
;55/ 0
}66 	
}77 
}88 ß~
NC:\Users\Edwin\Documents\GOLDCONF\GoldConf\Repository\ConferenciaRepository.cs
	namespace 	
GoldConf
 
. 

Repository 
{ 
public 

	interface "
IConferenciaRepository +
{ 
List 
< 
Ponente 
> 
GetPonentes !
(! "
)" #
;# $
List 
< 
Conferencia 
> 
GetConferencias )
() *
)* +
;+ ,
List 
< 
Conferencia 
>  
GetConferenciasOrder .
(. /
)/ 0
;0 1
List 
< 
Comprar 
> !
GetComprasOrderPasado +
(+ ,
int, /
idUser0 6
)6 7
;7 8
List 
< 
Comprar 
> "
GetComprasOrderFuturas ,
(, -
int- 0
idUser1 7
)7 8
;8 9
List 
< 
Conferencia 
> "
GetConferenciasOrderUC 0
(0 1
)1 2
;2 3
List 
< 
Cuenta 
> 

GetCuentas 
(  
)  !
;! "
List 
< 
Comprar 
> 

GetCompras  
(  !
)! "
;" #
void 
NewConferencia 
( 
Conferencia '
conferencia( 3
,3 4
	IFormFile5 >
file? C
)C D
;D E
void 
EditConferencia 
( 
Conferencia (
conferencia) 4
,4 5
	IFormFile6 ?
file@ D
)D E
;E F
void 
AddTransaccion 
( 
Transaccion '
transaccionCli( 6
,6 7
Transaccion8 C
transaccionAdD Q
)Q R
;R S
void 
ModificaMontoCuenta  
(  !
int! $
cuentaId% -
)- .
;. /
void 

AddCompras 
( 
Comprar 
comprar  '
,' (
int) ,
userId- 3
,3 4
int5 8
conferenciaId9 F
)F G
;G H
} 
public 

class !
ConferenciaRepository &
:' ("
IConferenciaRepository) ?
{ 
private 
readonly 
IGoldConfContext )
context* 1
;1 2
public   
readonly   
IWebHostEnvironment   +
hosting  , 3
;  3 4
public"" !
ConferenciaRepository"" $
(""$ %
IGoldConfContext""% 5
context""6 =
,""= >
IWebHostEnvironment""? R
hosting""S Z
)""Z [
{## 	
this$$ 
.$$ 
context$$ 
=$$ 
context$$ "
;$$" #
this%% 
.%% 
hosting%% 
=%% 
hosting%% "
;%%" #
}&& 	
public(( 
List(( 
<(( 
Comprar(( 
>(( 

GetCompras(( '
(((' (
)((( )
{)) 	
var** 
conferencias** 
=** 
context** &
.**& '
Compras**' .
.**. /
ToList**/ 5
(**5 6
)**6 7
;**7 8
return++ 
conferencias++ 
;++  
},, 	
public.. 
List.. 
<.. 
Conferencia.. 
>..  
GetConferencias..! 0
(..0 1
)..1 2
{// 	
var00 
conferencias00 
=00 
context00 &
.00& '
Conferencias00' 3
.003 4
ToList004 :
(00: ;
)00; <
;00< =
return11 
conferencias11 
;11  
}22 	
public44 
List44 
<44 
Conferencia44 
>44   
GetConferenciasOrder44! 5
(445 6
)446 7
{55 	
var66 
conferencias66 
=66 
context66 &
.66& '
Conferencias66' 3
.77 
Include77 
(77 
o77 
=>77 !
o77" #
.77# $
Ponentes77$ ,
)77, -
.88 
OrderByDescending88 &
(88& '
o88' (
=>88) +
o88, -
.88- .
	FechaConf88. 7
)887 8
.99 
Where99 
(99 
o99 
=>99 
o99  !
.99! "
	FechaConf99" +
>=99, .
DateTime99/ 7
.997 8
Now998 ;
)99; <
.:: 
ToList:: 
(:: 
):: 
;:: 
return;; 
conferencias;; 
;;;  
}<< 	
public>> 
List>> 
<>> 
Comprar>> 
>>> !
GetComprasOrderPasado>> 2
(>>2 3
int>>3 6
idUser>>7 =
)>>= >
{?? 	
var@@ 
conferencias@@ 
=@@ 
context@@ &
.@@& '
Compras@@' .
.AA 
IncludeAA 
(AA 
oAA 
=>AA !
oAA" #
.AA# $
ConferenciaAA$ /
)AA/ 0
.BB 
WhereBB 
(BB 
oBB 
=>BB 
oBB  !
.BB! "
IdUserBB" (
==BB) +
idUserBB, 2
)BB2 3
.CC 
WhereCC 
(CC 
oCC 
=>CC 
oCC  !
.CC! "
ConferenciaCC" -
.CC- .
	FechaConfCC. 7
<CC8 9
DateTimeCC: B
.CCB C
NowCCC F
)CCF G
.DD 
OrderByDescendingDD &
(DD& '
oDD' (
=>DD) +
oDD, -
.DD- .
ConferenciaDD. 9
.DD9 :
	FechaConfDD: C
)DDC D
.EE 
ToListEE 
(EE 
)EE 
;EE 
returnFF 
conferenciasFF 
;FF  
}GG 	
publicII 
ListII 
<II 
ComprarII 
>II "
GetComprasOrderFuturasII 3
(II3 4
intII4 7
idUserII8 >
)II> ?
{JJ 	
varKK 
conferenciasKK 
=KK 
contextKK &
.KK& '
ComprasKK' .
.LL 
IncludeLL 
(LL 
oLL 
=>LL !
oLL" #
.LL# $
ConferenciaLL$ /
)LL/ 0
.MM 
WhereMM 
(MM 
oMM 
=>MM 
oMM  !
.MM! "
IdUserMM" (
==MM) +
idUserMM, 2
)MM2 3
.NN 
WhereNN 
(NN 
oNN 
=>NN 
oNN  !
.NN! "
ConferenciaNN" -
.NN- .
	FechaConfNN. 7
>NN8 9
DateTimeNN: B
.NNB C
NowNNC F
)NNF G
.OO 
OrderByDescendingOO &
(OO& '
oOO' (
=>OO) +
oOO, -
.OO- .
ConferenciaOO. 9
.OO9 :
	FechaConfOO: C
)OOC D
.PP 
ToListPP 
(PP 
)PP 
;PP 
returnQQ 
conferenciasQQ 
;QQ  
}RR 	
publicTT 
ListTT 
<TT 
ConferenciaTT 
>TT  "
GetConferenciasOrderUCTT! 7
(TT7 8
)TT8 9
{UU 	
varVV 
conferenciasVV 
=VV 
contextVV &
.VV& '
ConferenciasVV' 3
.WW 
IncludeWW 
(WW 
oWW 
=>WW !
oWW" #
.WW# $
PonentesWW$ ,
)WW, -
.XX 
OrderByDescendingXX &
(XX& '
oXX' (
=>XX) +
oXX, -
.XX- .
	FechaConfXX. 7
)XX7 8
.YY 
ToListYY 
(YY 
)YY 
;YY 
returnZZ 
conferenciasZZ 
;ZZ  
}[[ 	
public]] 
List]] 
<]] 
Cuenta]] 
>]] 

GetCuentas]] &
(]]& '
)]]' (
{^^ 	
var__ 
cuentas__ 
=__ 
context__ !
.__! "
Cuentas__" )
.__) *
ToList__* 0
(__0 1
)__1 2
;__2 3
return`` 
cuentas`` 
;`` 
}aa 	
publiccc 
Listcc 
<cc 
Ponentecc 
>cc 
GetPonentescc (
(cc( )
)cc) *
{dd 	
varee 
ponentesee 
=ee 
contextee "
.ee" #
Ponentesee# +
.ee+ ,
ToListee, 2
(ee2 3
)ee3 4
;ee4 5
returnff 
ponentesff 
;ff 
}gg 	
publicii 
voidii 
NewConferenciaii "
(ii" #
Conferenciaii# .
conferenciaii/ :
,ii: ;
	IFormFileii< E
fileiiF J
)iiJ K
{jj 	
ifkk 
(kk 
filekk 
!=kk 
nullkk 
)kk 
conferenciall 
.ll 
	ImagePathll %
=ll& '
SaveFilell( 0
(ll0 1
filell1 5
)ll5 6
;ll6 7
elsemm 
conferenciann 
.nn 
	ImagePathnn %
=nn& '
nullnn( ,
;nn, -
contextoo 
.oo 
Conferenciasoo  
.oo  !
Addoo! $
(oo$ %
conferenciaoo% 0
)oo0 1
;oo1 2
contextpp 
.pp 
SaveChangespp 
(pp  
)pp  !
;pp! "
}qq 	
publicss 
voidss 
EditConferenciass #
(ss# $
Conferenciass$ /
conferenciass0 ;
,ss; <
	IFormFiless= F
filessG K
)ssK L
{tt 	
ifuu 
(uu 
fileuu 
!=uu 
nulluu 
)uu 
conferenciavv 
.vv 
	ImagePathvv %
=vv& '
SaveFilevv( 0
(vv0 1
filevv1 5
)vv5 6
;vv6 7
elseww 
conferenciaxx 
.xx 
	ImagePathxx %
=xx& '
nullxx( ,
;xx, -
contextyy 
.yy 
Conferenciasyy  
.yy  !
Updateyy! '
(yy' (
conferenciayy( 3
)yy3 4
;yy4 5
contextzz 
.zz 
SaveChangeszz 
(zz  
)zz  !
;zz! "
}{{ 	
public}} 
void}} 
AddTransaccion}} "
(}}" #
Transaccion}}# .
transaccionCli}}/ =
,}}= >
Transaccion}}? J
transaccionAd}}K X
)}}X Y
{~~ 	
context 
. 
Transacciones !
.! "
Add" %
(% &
transaccionCli& 4
)4 5
;5 6
context
ÄÄ 
.
ÄÄ 
Transacciones
ÄÄ !
.
ÄÄ! "
Add
ÄÄ" %
(
ÄÄ% &
transaccionAd
ÄÄ& 3
)
ÄÄ3 4
;
ÄÄ4 5
}
ÅÅ 	
public
ÉÉ 
void
ÉÉ !
ModificaMontoCuenta
ÉÉ '
(
ÉÉ' (
int
ÉÉ( +
cuentaId
ÉÉ, 4
)
ÉÉ4 5
{
ÑÑ 	
var
ÖÖ 
transaccions
ÖÖ 
=
ÖÖ 
context
ÖÖ &
.
ÖÖ& '
Transacciones
ÖÖ' 4
.
ÖÖ4 5
ToList
ÖÖ5 ;
(
ÖÖ; <
)
ÖÖ< =
;
ÖÖ= >
var
ÜÜ 
cuenta
ÜÜ 
=
ÜÜ 
context
ÜÜ  
.
ÜÜ  !
Cuentas
ÜÜ! (
.
áá 
Include
áá 
(
áá 
o
áá 
=>
áá 
o
áá 
.
áá  
Transaccions
áá  ,
)
áá, -
.
àà 
FirstOrDefault
àà 
(
àà  
o
àà  !
=>
àà" $
o
àà% &
.
àà& '
Id
àà' )
==
àà* ,
cuentaId
àà- 5
)
àà5 6
;
àà6 7
var
ää 
total
ää 
=
ää 
cuenta
ää 
.
ää 
Transaccions
ää +
.
ää+ ,
Sum
ää, /
(
ää/ 0
o
ää0 1
=>
ää2 4
o
ää5 6
.
ää6 7
Amount
ää7 =
)
ää= >
;
ää> ?
cuenta
ãã 
.
ãã 
Amount
ãã 
=
ãã 
total
ãã !
;
ãã! "
context
åå 
.
åå 
SaveChanges
åå 
(
åå  
)
åå  !
;
åå! "
}
çç 	
public
èè 
void
èè 

AddCompras
èè 
(
èè 
Comprar
èè &
comprar
èè' .
,
èè. /
int
èè0 3
userId
èè4 :
,
èè: ;
int
èè< ?
conferenciaId
èè@ M
)
èèM N
{
êê 	
comprar
ëë 
.
ëë 
IdUser
ëë 
=
ëë 
userId
ëë #
;
ëë# $
comprar
íí 
.
íí 
IdConferencia
íí !
=
íí" #
conferenciaId
íí$ 1
;
íí1 2
context
ìì 
.
ìì 
Compras
ìì 
.
ìì 
Add
ìì 
(
ìì  
comprar
ìì  '
)
ìì' (
;
ìì( )
context
îî 
.
îî 
SaveChanges
îî 
(
îî  
)
îî  !
;
îî! "
}
ïï 	
private
óó 
string
óó 
SaveFile
óó 
(
óó  
	IFormFile
óó  )
file
óó* .
)
óó. /
{
òò 	
string
ôô 
relativePath
ôô 
=
ôô  !
$str
ôô" $
;
ôô$ %
if
õõ 
(
õõ 
file
õõ 
.
õõ 
Length
õõ 
>
õõ 
$num
õõ 
&&
õõ  "
(
õõ# $
file
õõ$ (
.
õõ( )
ContentType
õõ) 4
==
õõ5 7
$str
õõ8 D
||
õõE G
file
õõH L
.
õõL M
ContentType
õõM X
==
õõY [
$str
õõ\ g
||
õõh j
file
õõk o
.
õõo p
ContentType
õõp {
==
õõ| ~
$strõõ ä
)õõä ã
)õõã å
{
úú 
relativePath
ùù 
=
ùù 
Path
ùù #
.
ùù# $
Combine
ùù$ +
(
ùù+ ,
$str
ùù, 3
,
ùù3 4
file
ùù5 9
.
ùù9 :
FileName
ùù: B
)
ùùB C
;
ùùC D
var
ûû 
filePath
ûû 
=
ûû 
Path
ûû #
.
ûû# $
Combine
ûû$ +
(
ûû+ ,
hosting
ûû, 3
.
ûû3 4
WebRootPath
ûû4 ?
,
ûû? @
relativePath
ûûA M
)
ûûM N
;
ûûN O
var
üü 
stream
üü 
=
üü 
new
üü  

FileStream
üü! +
(
üü+ ,
filePath
üü, 4
,
üü4 5
FileMode
üü6 >
.
üü> ?
Create
üü? E
)
üüE F
;
üüF G
file
†† 
.
†† 
CopyTo
†† 
(
†† 
stream
†† "
)
††" #
;
††# $
stream
°° 
.
°° 
Close
°° 
(
°° 
)
°° 
;
°° 
}
¢¢ 
return
§§ 
$str
§§ 
+
§§ 
relativePath
§§ %
.
§§% &
Replace
§§& -
(
§§- .
$char
§§. 2
,
§§2 3
$char
§§4 7
)
§§7 8
;
§§8 9
}
•• 	
}
¶¶ 
}ßß º
IC:\Users\Edwin\Documents\GOLDCONF\GoldConf\Repository\CuentaRepository.cs
	namespace 	
GoldConf
 
. 

Repository 
{		 
public

 

	interface

 
ICuentaRepository

 &
{ 
List 
< 
Cuenta 
> 

GetCuentas 
(  
)  !
;! "
void 
NewTransaccion 
( 
Cuenta "
cuenta# )
)) *
;* +
List 
< 
Transaccion 
> 
GetTransaccions )
() *
int* -
id. 0
)0 1
;1 2
Cuenta 

GetCuentas 
( 
int 
id  
)  !
;! "
} 
public 

class 
CuentaRepository !
:" #
ICuentaRepository$ 5
{ 
private 
readonly 
IGoldConfContext )
context* 1
;1 2
public 
CuentaRepository 
(  
IGoldConfContext  0
context1 8
)8 9
{ 	
this 
. 
context 
= 
context "
;" #
} 	
public 
List 
< 
Cuenta 
> 

GetCuentas &
(& '
)' (
{ 	
var 
cuentas 
= 
context !
.! "
Cuentas" )
.) *
ToList* 0
(0 1
)1 2
;2 3
return 
cuentas 
; 
} 	
public   
void   
NewTransaccion   "
(  " #
Cuenta  # )
cuenta  * 0
)  0 1
{!! 	
context"" 
."" 
Cuentas"" 
."" 
Add"" 
(""  
cuenta""  &
)""& '
;""' (
context## 
.## 
SaveChanges## 
(##  
)##  !
;##! "
}$$ 	
public&& 
List&& 
<&& 
Transaccion&& 
>&&  
GetTransaccions&&! 0
(&&0 1
int&&1 4
id&&5 7
)&&7 8
{'' 	
var(( 
transacciones(( 
=(( 
context((  '
.((' (
Transacciones((( 5
.((5 6
Where((6 ;
(((; <
o((< =
=>((> @
o((A B
.((B C
CuentaId((C K
==((L N
id((O Q
)((Q R
.((R S
ToList((S Y
(((Y Z
)((Z [
;(([ \
return)) 
transacciones))  
;))  !
}** 	
public,, 
Cuenta,, 

GetCuentas,,  
(,,  !
int,,! $
id,,% '
),,' (
{-- 	
var.. 
cuenta.. 
=.. 
context..  
...  !
Cuentas..! (
...( )
First..) .
(... /
o../ 0
=>..1 3
o..4 5
...5 6
Id..6 8
==..9 ;
id..< >
)..> ?
;..? @
return// 
cuenta// 
;// 
}00 	
}11 
}22 ä
GC:\Users\Edwin\Documents\GOLDCONF\GoldConf\Repository\HomeRepository.cs
	namespace 	
GoldConf
 
. 

Repository 
{		 
public

 

	interface

 
IHomeRepository

 $
{ 
List 
< 
Ponente 
> 
GetPonentes !
(! "
)" #
;# $
List 
< 
Conferencia 
> 
GetConferencias )
() *
)* +
;+ ,
} 
public 

class 
HomeRepository 
:  !
IHomeRepository" 1
{ 
private 
readonly 
IGoldConfContext )
context* 1
;1 2
public 
HomeRepository 
( 
IGoldConfContext .
context/ 6
)6 7
{ 	
this 
. 
context 
= 
context "
;" #
} 	
public 
List 
< 
Conferencia 
>  
GetConferencias! 0
(0 1
)1 2
{ 	
var 
conferencias 
= 
context &
.& '
Conferencias' 3
.3 4
Include 
( 
o 
=> 
o 
. 
Ponentes '
)' (
.( )
Where 
( 
o 
=> 
o 
. 
	FechaConf &
>=' )
DateTime* 2
.2 3
Now3 6
)6 7
.7 8
ToList 
( 
) 
; 
return 
conferencias 
;  
} 	
public!! 
List!! 
<!! 
Ponente!! 
>!! 
GetPonentes!! (
(!!( )
)!!) *
{"" 	
var## 
ponente## 
=## 
context## !
.##! "
Ponentes##" *
.##* +
ToList##+ 1
(##1 2
)##2 3
;##3 4
return$$ 
ponente$$ 
;$$ 
}%% 	
}&& 
}'' ¬I
JC:\Users\Edwin\Documents\GOLDCONF\GoldConf\Repository\PonenteRepository.cs
	namespace		 	
GoldConf		
 
.		 

Repository		 
{

 
public 

	interface 
IPonenteRepository '
{ 
List 
< 
Ponente 
> 
GetPonentes !
(! "
)" #
;# $
List 
< 
Ponente 
> 
GetPonentesSearch '
(' (
string( .
search/ 5
)5 6
;6 7
List 
< 
Cuenta 
> 
GetCuentaUser "
(" #
)# $
;$ %
List 
< 
Comprar 
> 

GetCompras  
(  !
)! "
;" #
Ponente 

GetPonente 
( 
int 
id !
)! "
;" #
List 
< 
Conferencia 
> "
GetConferenciasPonente 0
(0 1
int1 4
id5 7
)7 8
;8 9
void 

NewPonente 
( 
Ponente 
ponente  '
,' (
	IFormFile) 2
file3 7
)7 8
;8 9
void 
EditPonente 
( 
Ponente  
ponente! (
,( )
	IFormFile* 3
file4 8
)8 9
;9 :
} 
public 

class 
PonenteRepository "
:# $
IPonenteRepository% 7
{ 
private 
readonly 
IGoldConfContext )
context* 1
;1 2
public 
readonly 
IWebHostEnvironment +
hosting, 3
;3 4
public 
PonenteRepository  
(  !
IGoldConfContext! 1
context2 9
,9 :
IWebHostEnvironment; N
hostingO V
)V W
{ 	
this 
. 
context 
= 
context "
;" #
this 
. 
hosting 
= 
hosting "
;" #
} 	
public!! 
List!! 
<!! 
Ponente!! 
>!! 
GetPonentes!! (
(!!( )
)!!) *
{"" 	
var## 
ponentes## 
=## 
context## "
.##" #
Ponentes### +
.##+ ,
ToList##, 2
(##2 3
)##3 4
;##4 5
return$$ 
ponentes$$ 
;$$ 
}%% 	
public'' 
List'' 
<'' 
Ponente'' 
>'' 
GetPonentesSearch'' .
(''. /
string''/ 5
search''6 <
)''< =
{(( 	
var)) 
ponentes)) 
=)) 
context)) "
.))" #
Ponentes))# +
.))+ ,
Where)), 1
())1 2
s))2 3
=>))4 6
s))7 8
.))8 9
NomApe))9 ?
.))? @
Contains))@ H
())H I
search))I O
)))O P
)))P Q
.))Q R
ToList))R X
())X Y
)))Y Z
;))Z [
;))\ ]
return** 
ponentes** 
;** 
}++ 	
public-- 
List-- 
<-- 
Cuenta-- 
>-- 
GetCuentaUser-- )
(--) *
)--* +
{.. 	
var// 
cuenta// 
=// 
context//  
.//  !
Cuentas//! (
.00 
ToList00 
(00 
)00 
;00 
return11 
cuenta11 
;11 
}22 	
public44 
List44 
<44 
Comprar44 
>44 

GetCompras44 '
(44' (
)44( )
{55 	
var66 
compras66 
=66 
context66 !
.66! "
Compras66" )
.66) *
ToList66* 0
(660 1
)661 2
;662 3
return77 
compras77 
;77 
}88 	
public:: 
Ponente:: 

GetPonente:: !
(::! "
int::" %
id::& (
)::( )
{;; 	
var<< 
ponente<< 
=<< 
context<< !
.<<! "
Ponentes<<" *
.<<* +
Where== 
(== 
o== 
=>== 
o== 
.== 
Id== 
====  "
id==# %
)==% &
.==& '
FirstOrDefault>> 
(>> 
)>>  
;>>  !
return?? 
ponente?? 
;?? 
}@@ 	
publicBB 
ListBB 
<BB 
ConferenciaBB 
>BB  "
GetConferenciasPonenteBB! 7
(BB7 8
intBB8 ;
idBB< >
)BB> ?
{CC 	
varDD 
conferenciasDD 
=DD 
contextDD &
.DD& '
ConferenciasDD' 3
.EE 
WhereEE 
(EE 
oEE 
=>EE 
oEE 
.EE 
	PonenteIdEE '
==EE( *
idEE+ -
)EE- .
.FF 
OrderByDescendingFF "
(FF" #
oFF# $
=>FF% '
oFF( )
.FF) *
	FechaConfFF* 3
)FF3 4
.GG 
ToListGG 
(GG 
)GG 
;GG 
returnHH 
conferenciasHH 
;HH  
}II 	
publicKK 
voidKK 

NewPonenteKK 
(KK 
PonenteKK &
ponenteKK' .
,KK. /
	IFormFileKK0 9
fileKK: >
)KK> ?
{LL 	
ifMM 
(MM 
fileMM 
!=MM 
nullMM 
)MM 
ponenteNN 
.NN 
ImagenNN 
=NN  
SaveFileNN! )
(NN) *
fileNN* .
)NN. /
;NN/ 0
elseOO 
ponentePP 
.PP 
ImagenPP 
=PP  
nullPP! %
;PP% &
contextQQ 
.QQ 
PonentesQQ 
.QQ 
AddQQ  
(QQ  !
ponenteQQ! (
)QQ( )
;QQ) *
contextRR 
.RR 
SaveChangesRR 
(RR  
)RR  !
;RR! "
}SS 	
publicUU 
voidUU 
EditPonenteUU 
(UU  
PonenteUU  '
ponenteUU( /
,UU/ 0
	IFormFileUU1 :
fileUU; ?
)UU? @
{VV 	
ifWW 
(WW 
fileWW 
!=WW 
nullWW 
)WW 
ponenteXX 
.XX 
ImagenXX 
=XX  
SaveFileXX! )
(XX) *
fileXX* .
)XX. /
;XX/ 0
elseYY 
ponenteZZ 
.ZZ 
ImagenZZ 
=ZZ  
nullZZ! %
;ZZ% &
context[[ 
.[[ 
Ponentes[[ 
.[[ 
Update[[ #
([[# $
ponente[[$ +
)[[+ ,
;[[, -
context\\ 
.\\ 
SaveChanges\\ 
(\\  
)\\  !
;\\! "
}]] 	
private__ 
string__ 
SaveFile__ 
(__  
	IFormFile__  )
file__* .
)__. /
{`` 	
stringaa 
relativePathaa 
=aa  !
$straa" $
;aa$ %
ifcc 
(cc 
filecc 
.cc 
Lengthcc 
>cc 
$numcc 
&&cc  "
(cc# $
filecc$ (
.cc( )
ContentTypecc) 4
==cc5 7
$strcc8 D
||ccE G
fileccH L
.ccL M
ContentTypeccM X
==ccY [
$strcc\ g
||cch j
filecck o
.cco p
ContentTypeccp {
==cc| ~
$str	cc ä
)
ccä ã
)
ccã å
{dd 
relativePathee 
=ee 
Pathee #
.ee# $
Combineee$ +
(ee+ ,
$stree, 3
,ee3 4
fileee5 9
.ee9 :
FileNameee: B
)eeB C
;eeC D
varff 
filePathff 
=ff 
Pathff #
.ff# $
Combineff$ +
(ff+ ,
hostingff, 3
.ff3 4
WebRootPathff4 ?
,ff? @
relativePathffA M
)ffM N
;ffN O
vargg 
streamgg 
=gg 
newgg  

FileStreamgg! +
(gg+ ,
filePathgg, 4
,gg4 5
FileModegg6 >
.gg> ?
Creategg? E
)ggE F
;ggF G
filehh 
.hh 
CopyTohh 
(hh 
streamhh "
)hh" #
;hh# $
streamii 
.ii 
Closeii 
(ii 
)ii 
;ii 
}jj 
returnll 
$strll 
+ll 
relativePathll %
.ll% &
Replacell& -
(ll- .
$charll. 2
,ll2 3
$charll4 7
)ll7 8
;ll8 9
}mm 	
}nn 
}oo Ù
BC:\Users\Edwin\Documents\GOLDCONF\GoldConf\Service\ClaimService.cs
	namespace 	
GoldConf
 
. 
Service 
{ 
public		 

	interface		 
IClaimService		 "
{

 
User 
GetLoggedUser 
( 
) 
; 
void 
SetHttpContext 
( 
HttpContext '
httpContext( 3
)3 4
;4 5
void 
Logout 
( 
) 
; 
void 
Login 
( 
ClaimsPrincipal "
	principal# ,
), -
;- .
} 
public 

class 
ClaimService 
: 
IClaimService  -
{ 
private 
IGoldConfContext  
context! (
;( )
private 
HttpContext 
httpContext '
;' (
public 
ClaimService 
( 
IGoldConfContext ,
context- 4
)4 5
{ 	
this 
. 
context 
= 
context "
;" #
} 	
public 
void 
SetHttpContext "
(" #
HttpContext# .
httpContext/ :
): ;
{ 	
this 
. 
httpContext 
= 
httpContext *
;* +
} 	
public!! 
User!! 
GetLoggedUser!! !
(!!! "
)!!" #
{"" 	
var## 
claim## 
=## 
httpContext## #
.### $
User##$ (
.##( )
Claims##) /
.##/ 0
FirstOrDefault##0 >
(##> ?
)##? @
;##@ A
var$$ 
user$$ 
=$$ 
context$$ 
.$$ 
Users$$ $
.$$$ %
Where$$% *
($$* +
o$$+ ,
=>$$- /
o$$0 1
.$$1 2
Username$$2 :
==$$; =
claim$$> C
.$$C D
Value$$D I
)$$I J
.$$J K
FirstOrDefault$$K Y
($$Y Z
)$$Z [
;$$[ \
return%% 
user%% 
;%% 
}&& 	
public(( 
void(( 
Logout(( 
((( 
)(( 
{)) 	
httpContext** 
.** 
SignOutAsync** $
(**$ %
)**% &
;**& '
}++ 	
public-- 
void-- 
Login-- 
(-- 
ClaimsPrincipal-- )
	principal--* 3
)--3 4
{.. 	
httpContext// 
.// 
SignInAsync// #
(//# $
	principal//$ -
)//- .
;//. /
}00 	
}22 
}33 Û&
5C:\Users\Edwin\Documents\GOLDCONF\GoldConf\Startup.cs
	namespace 	
GoldConf
 
{ 
public 

class 
Startup 
{ 
public 
Startup 
( 
IConfiguration %
configuration& 3
)3 4
{ 	
Configuration 
= 
configuration )
;) *
} 	
public 
IConfiguration 
Configuration +
{, -
get. 1
;1 2
}3 4
public 
void 
ConfigureServices %
(% &
IServiceCollection& 8
services9 A
)A B
{ 	
services 
. #
AddControllersWithViews ,
(, -
)- .
;. /
services 
. 
AddDbContext !
<! "
GoldConfContext" 1
>1 2
(2 3
options 
=> 
options "
." #
UseSqlServer# /
(/ 0
Configuration0 =
.= >
GetConnectionString> Q
(Q R
$strR a
)a b
)b c
) 
; 
services   
.   
AddAuthentication   &
(  & '(
CookieAuthenticationDefaults  ' C
.  C D 
AuthenticationScheme  D X
)  X Y
.!! 
	AddCookie!! 
(!! 
options!! "
=>!!# %
{"" 
options$$ 
.$$ 
	LoginPath$$ %
=$$& '
$str$$( 5
;$$5 6
}%% 
)%% 
;%% 
services'' 
.'' 
AddTransient'' !
<''! "
IClaimService''" /
,''/ 0
ClaimService''1 =
>''= >
(''> ?
)''? @
;''@ A
services(( 
.(( 
AddTransient(( !
<((! "
IGoldConfContext((" 2
,((2 3
GoldConfContext((4 C
>((C D
(((D E
)((E F
;((F G
services)) 
.)) 
AddTransient)) !
<))! "
IHomeRepository))" 1
,))1 2
HomeRepository))3 A
>))A B
())B C
)))C D
;))D E
services** 
.** 
AddTransient** !
<**! "
IPonenteRepository**" 4
,**4 5
PonenteRepository**6 G
>**G H
(**H I
)**I J
;**J K
services++ 
.++ 
AddTransient++ !
<++! "
ICuentaRepository++" 3
,++3 4
CuentaRepository++5 E
>++E F
(++F G
)++G H
;++H I
services,, 
.,, 
AddTransient,, !
<,,! ""
IConferenciaRepository,," 8
,,,8 9!
ConferenciaRepository,,: O
>,,O P
(,,P Q
),,Q R
;,,R S
services-- 
.-- 
AddTransient-- !
<--! "
IAuthRepository--" 1
,--1 2
AuthRepository--3 A
>--A B
(--B C
)--C D
;--D E
}.. 	
public11 
void11 
	Configure11 
(11 
IApplicationBuilder11 1
app112 5
,115 6
IWebHostEnvironment117 J
env11K N
)11N O
{22 	
if33 
(33 
env33 
.33 
IsDevelopment33 !
(33! "
)33" #
)33# $
{44 
app55 
.55 %
UseDeveloperExceptionPage55 -
(55- .
)55. /
;55/ 0
}66 
else77 
{88 
app99 
.99 
UseExceptionHandler99 '
(99' (
$str99( 5
)995 6
;996 7
app;; 
.;; 
UseHsts;; 
(;; 
);; 
;;; 
}<< 
app== 
.== 
UseHttpsRedirection== #
(==# $
)==$ %
;==% &
app>> 
.>> 
UseStaticFiles>> 
(>> 
)>>  
;>>  !
app@@ 
.@@ 

UseRouting@@ 
(@@ 
)@@ 
;@@ 
appAA 
.AA 
UseAuthenticationAA !
(AA! "
)AA" #
;AA# $
appBB 
.BB 
UseAuthorizationBB  
(BB  !
)BB! "
;BB" #
appDD 
.DD 
UseEndpointsDD 
(DD 
	endpointsDD &
=>DD' )
{EE 
	endpointsFF 
.FF 
MapControllerRouteFF ,
(FF, -
nameGG 
:GG 
$strGG #
,GG# $
patternHH 
:HH 
$strHH E
)HHE F
;HHF G
}II 
)II 
;II 
}JJ 	
}KK 
}LL 