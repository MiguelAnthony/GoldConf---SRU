â/
HC:\Users\Edwin\Documents\GOLDCONF\GoldConf\Controllers\AuthController.cs
	namespace 	
GoldConf
 
. 
Controllers 
{ 
public 

class 
AuthController 
:  !

Controller" ,
{ 
private 
readonly 
IAuthRepository (
context) 0
;0 1
private 
readonly 
IClaimService &
claim' ,
;, -
public 
AuthController 
( 
IAuthRepository -
context. 5
,5 6
IClaimService7 D
claimE J
)J K
{ 	
this 
. 
context 
= 
context "
;" #
this 
. 
claim 
= 
claim 
; 
} 	
[ 	
HttpGet	 
] 
public 
IActionResult 
Login "
(" #
)# $
{ 	
return 
View 
( 
$str 
)  
;  !
} 	
[ 	
HttpPost	 
] 
public   
IActionResult   
Login   "
(  " #
string  # )
username  * 2
,  2 3
string  4 :
password  ; C
)  C D
{!! 	
var"" 
user"" 
="" 
context"" 
."" 

GetUsuario"" )
("") *
username""* 2
,""2 3
password""3 ;
)""; <
;""< =
if$$ 
($$ 
user$$ 
!=$$ 
null$$ 
)$$ 
{%% 
var&& 
claims&& 
=&& 
new&&  
List&&! %
<&&% &
Claim&&& +
>&&+ ,
{&&- .
new'' 
Claim'' 
('' 

ClaimTypes'' (
.''( )
Name'') -
,''- .
username''/ 7
)''7 8
}(( 
;(( 
var** 
claimsIdentity** "
=**# $
new**% (
ClaimsIdentity**) 7
(**7 8
claims**8 >
,**> ?
$str**@ G
)**G H
;**H I
var++ 
claimsPrincipal++ #
=++$ %
new++& )
ClaimsPrincipal++* 9
(++9 :
claimsIdentity++: H
)++H I
;++I J
claim-- 
.-- 
SetHttpContext-- $
(--$ %
HttpContext--% 0
)--0 1
;--1 2
claim.. 
... 
Login.. 
(.. 
claimsPrincipal.. +
)..+ ,
;.., -
return00 
RedirectToAction00 '
(00' (
$str00( /
,00/ 0
$str001 7
)007 8
;008 9
}11 

ModelState33 
.33 
AddModelError33 $
(33$ %
$str33% ,
,33, -
$str33. Q
)33Q R
;33R S
return44 
View44 
(44 
$str44 
)44  
;44  !
}55 	
[66 	
HttpGet66	 
]66 
public77 
IActionResult77 
Logout77 #
(77# $
)77$ %
{88 	
claim99 
.99 
SetHttpContext99  
(99  !
HttpContext99! ,
)99, -
;99- .
claim:: 
.:: 
Logout:: 
(:: 
):: 
;:: 
return;; 
RedirectToAction;; #
(;;# $
$str;;$ +
);;+ ,
;;;, -
}<< 	
[>> 	
HttpGet>>	 
]>> 
public?? 
ActionResult?? 
	Registrar?? %
(??% &
)??& '
{@@ 	
returnAA 
ViewAA 
(AA 
$strAA #
)AA# $
;AA$ %
}BB 	
[DD 	
HttpPostDD	 
]DD 
publicEE 
ActionResultEE 
	RegistrarEE %
(EE% &
UserEE& *
userEE+ /
,EE/ 0
stringEE1 7
passwordConfEE8 D
)EED E
{FF 	
varGG 
usuariosGG 
=GG 
contextGG "
.GG" #
GetUsuariosGG# .
(GG. /
)GG/ 0
;GG0 1
foreachHH 
(HH 
varHH 
itemHH 
inHH  
usuariosHH! )
)HH) *
{II 
ifJJ 
(JJ 
itemJJ 
.JJ 
EmailJJ 
==JJ !
userJJ" &
.JJ& '
EmailJJ' ,
)JJ, -

ModelStateKK 
.KK 
AddModelErrorKK ,
(KK, -
$strKK- 4
,KK4 5
$strKK6 L
)KKL M
;KKM N
ifLL 
(LL 
itemLL 
.LL 
UsernameLL !
==LL" $
userLL% )
.LL) *
UsernameLL* 2
)LL2 3

ModelStateMM 
.MM 
AddModelErrorMM ,
(MM, -
$strMM- 7
,MM7 8
$strMM9 Q
)MMQ R
;MMR S
}NN 
ifPP 
(PP 
userPP 
.PP 
PasswordPP 
!=PP  
passwordConfPP! -
)PP- .

ModelStateQQ 
.QQ 
AddModelErrorQQ (
(QQ( )
$strQQ) 7
,QQ7 8
$strQQ9 W
)QQW X
;QQX Y
ifSS 
(SS 

ModelStateSS 
.SS 
IsValidSS "
)SS" #
{TT 
contextUU 
.UU 
SaveUsuarioUU #
(UU# $
userUU$ (
)UU( )
;UU) *
returnVV 
RedirectToActionVV '
(VV' (
$strVV( /
)VV/ 0
;VV0 1
}WW 
returnXX 
ViewXX 
(XX 
$strXX #
,XX# $
userXX% )
)XX) *
;XX* +
}YY 	
}ZZ 
}[[ ¡Ê
OC:\Users\Edwin\Documents\GOLDCONF\GoldConf\Controllers\ConferenciaController.cs
	namespace 	
GoldConf
 
. 
Controllers 
{ 
[ 
	Authorize 
] 
public 

class !
ConferenciaController &
:' (

Controller) 3
{ 
private 
readonly "
IConferenciaRepository /
context0 7
;7 8
private 
readonly 
IClaimService &
claim' ,
;, -
public !
ConferenciaController $
($ %"
IConferenciaRepository% ;
ctx< ?
,? @
IClaimServiceA N
claimO T
)T U
{ 	
this 
. 
context 
= 
ctx 
; 
this 
. 
claim 
= 
claim 
; 
} 	
[ 	
HttpGet	 
] 
public 
ActionResult 
Conferencias (
(( )
string) /
search0 6
)6 7
{ 	
claim 
. 
SetHttpContext  
(  !
HttpContext! ,
), -
;- .
var 
ponentes 
= 
context "
." #
GetPonentes# .
(. /
)/ 0
;0 1
var   
conferencias   
=   
context   &
.  & '
GetConferencias  ' 6
(  6 7
)  7 8
;  8 9
ViewBag!! 
.!! 
Cuenta!! 
=!! 
context!! $
.!!$ %

GetCuentas!!% /
(!!/ 0
)!!0 1
."" 
Where"" 
("" 
o"" 
=>"" 
o"" 
."" 
UserId"" $
==""% '
claim""( -
.""- .
GetLoggedUser"". ;
(""; <
)""< =
.""= >
Id""> @
)""@ A
.## 
ToList## 
(## 
)## 
;## 
if&& 
(&& 
claim&& 
.&& 
GetLoggedUser&& #
(&&# $
)&&$ %
.&&% &
Username&&& .
!=&&/ 1
$str&&2 <
)&&< =
{'' 
ViewBag(( 
.(( 
Usuario(( 
=((  !
$str((" ,
;((, -
conferencias)) 
=)) 
context)) &
.))& ' 
GetConferenciasOrder))' ;
()); <
)))< =
;))= >
ViewBag** 
.** 
Compra** 
=**  
context**! (
.**( )

GetCompras**) 3
(**3 4
)**4 5
.**5 6
Where++ 
(++ 
o++ 
=>++ 
o++  
.++  !
IdUser++! '
==++( *
claim+++ 0
.++0 1
GetLoggedUser++1 >
(++> ?
)++? @
.++@ A
Id++A C
)++C D
.++D E
ToList,, 
(,, 
),, 
;,, 
}-- 
else.. 
{// 
conferencias00 
=00 
context00 &
.00& '"
GetConferenciasOrderUC00' =
(00= >
)00> ?
;00? @
ViewBag11 
.11 
Compra11 
=11  
context11! (
.11( )

GetCompras11) 3
(113 4
)114 5
;115 6
}22 
ViewBag44 
.44 
Buscar44 
=44 
search44 #
;44# $
ViewBag66 
.66 
IdUser66 
=66 
claim66 "
.66" #
GetLoggedUser66# 0
(660 1
)661 2
.662 3
Id663 5
;665 6
if88 
(88 
!88 
string88 
.88 
IsNullOrEmpty88 %
(88% &
search88& ,
)88, -
)88- .
{99 
conferencias:: 
=:: 
conferencias:: +
.::+ ,
Where::, 1
(::1 2
s::2 3
=>::4 6
s::7 8
.::8 9
Ponentes::9 A
.::A B
NomApe::B H
.::H I
Contains::I Q
(::Q R
search::R X
)::X Y
||::Z \
s::] ^
.::^ _

TituloConf::_ i
.::i j
Contains::j r
(::r s
search::s y
)::y z
)::z {
.::{ |
ToList	::| 
(
:: 
)
:: 
;
:: 
return;; 
View;; 
(;; 
$str;; *
,;;* +
conferencias;;, 8
);;8 9
;;;9 :
}<< 
return>> 
View>> 
(>> 
$str>> &
,>>& '
conferencias>>( 4
)>>4 5
;>>5 6
}?? 	
publicAA 
ActionResultAA 
DetalleAA #
(AA# $
intAA$ '
idConferenciaAA( 5
)AA5 6
{BB 	
claimCC 
.CC 
SetHttpContextCC  
(CC  !
HttpContextCC! ,
)CC, -
;CC- .
ifDD 
(DD 
claimDD 
.DD 
GetLoggedUserDD #
(DD# $
)DD$ %
.DD% &
UsernameDD& .
!=DD/ 1
$strDD2 <
)DD< =
ViewBagEE 
.EE 
UsuarioEE 
=EE  !
$strEE" ,
;EE, -
varGG 
compraGG 
=GG 
contextGG  
.GG  !

GetComprasGG! +
(GG+ ,
)GG, -
.GG- .
WhereGG. 3
(GG3 4
oGG4 5
=>GG6 8
oGG9 :
.GG: ;
IdConferenciaGG; H
==GGI K
idConferenciaGGL Y
)GGY Z
.GGZ [
ToListGG[ a
(GGa b
)GGb c
;GGc d
ViewBagHH 
.HH 
CompraHH 
=HH 
compraHH #
.HH# $
CountHH$ )
(HH) *
)HH* +
;HH+ ,
ViewBagJJ 
.JJ 
PonentesJJ 
=JJ 
contextJJ &
.JJ& '
GetPonentesJJ' 2
(JJ2 3
)JJ3 4
;JJ4 5
varLL 
conferenciasLL 
=LL 
contextLL &
.LL& '"
GetConferenciasOrderUCLL' =
(LL= >
)LL> ?
.MM 
WhereMM 
(MM 
oMM 
=>MM 
oMM 
.MM 
IdMM  
==MM! #
idConferenciaMM$ 1
)MM1 2
.NN 
FirstOrDefaultNN 
(NN  
)NN  !
;NN! "
ViewBagPP 
.PP 
IdUserPP 
=PP 
claimPP "
.PP" #
GetLoggedUserPP# 0
(PP0 1
)PP1 2
.PP2 3
IdPP3 5
;PP5 6
returnRR 
ViewRR 
(RR 
$strRR !
,RR! "
conferenciasRR# /
)RR/ 0
;RR0 1
}SS 	
[UU 	
HttpGetUU	 
]UU 
publicVV 
ActionResultVV 
CreateVV "
(VV" #
)VV# $
{WW 	
claimXX 
.XX 
SetHttpContextXX  
(XX  !
HttpContextXX! ,
)XX, -
;XX- .
ifYY 
(YY 
claimYY 
.YY 
GetLoggedUserYY #
(YY# $
)YY$ %
.YY% &
UsernameYY& .
!=YY/ 1
$strYY2 <
)YY< =
{ZZ 
var[[ 
conferencias[[  
=[[! "
context[[# *
.[[* +"
GetConferenciasOrderUC[[+ A
([[A B
)[[B C
;[[C D
return\\ 
RedirectToAction\\ '
(\\' (
$str\\( 6
,\\6 7
conferencias\\8 D
)\\D E
;\\E F
}]] 
else^^ 
{__ 
ViewBag`` 
.`` 
Ponentes``  
=``! "
context``# *
.``* +
GetPonentes``+ 6
(``6 7
)``7 8
;``8 9
returnaa 
Viewaa 
(aa 
$straa $
,aa$ %
newaa& )
Conferenciaaa* 5
(aa5 6
)aa6 7
)aa7 8
;aa8 9
}bb 
}cc 	
[dd 	
HttpPostdd	 
]dd 
publicee 
ActionResultee 
Createee "
(ee" #
Conferenciaee# .
conferenciaee/ :
,ee: ;
	IFormFileee< E
imageeeF K
)eeK L
{ff 	
claimgg 
.gg 
SetHttpContextgg  
(gg  !
HttpContextgg! ,
)gg, -
;gg- .
ifhh 
(hh 
claimhh 
.hh 
GetLoggedUserhh #
(hh# $
)hh$ %
.hh% &
Usernamehh& .
!=hh/ 1
$strhh2 <
)hh< =
{ii 
varjj 
conferenciasjj  
=jj! "
contextjj# *
.jj* +"
GetConferenciasOrderUCjj+ A
(jjA B
)jjB C
;jjC D
returnkk 
RedirectToActionkk '
(kk' (
$strkk( 6
,kk6 7
conferenciaskk8 D
)kkD E
;kkE F
}ll 
elsemm 
{nn 
ifoo 
(oo 
conferenciaoo 
==oo  "
nulloo# '
)oo' (

ModelStatepp 
.pp 
AddModelErrorpp ,
(pp, -
$strpp- :
,pp: ;
$strpp< Y
)ppY Z
;ppZ [
ifqq 
(qq 

ModelStateqq 
.qq 
IsValidqq &
)qq& '
{rr 
contextss 
.ss 
NewConferenciass *
(ss* +
conferenciass+ 6
,ss6 7
imagess8 =
)ss= >
;ss> ?
returntt 
RedirectToActiontt +
(tt+ ,
$strtt, :
)tt: ;
;tt; <
}uu 
elsevv 
{ww 
ViewBagxx 
.xx 
Ponentesxx $
=xx% &
contextxx' .
.xx. /
GetPonentesxx/ :
(xx: ;
)xx; <
;xx< =
returnyy 
Viewyy 
(yy  
$stryy  (
,yy( )
conferenciayy* 5
)yy5 6
;yy6 7
}zz 
}{{ 
}|| 	
[~~ 	
HttpGet~~	 
]~~ 
public 
ActionResult 
Edit  
(  !
int! $
id% '
)' (
{
 	
claim
 
.
 
SetHttpContext
  
(
  !
HttpContext
! ,
)
, -
;
- .
if
 
(
 
claim
 
.
 
GetLoggedUser
 #
(
# $
)
$ %
.
% &
Username
& .
!=
/ 1
$str
2 <
)
< =
{
 
var
 
conferencias
  
=
! "
context
# *
.
* +$
GetConferenciasOrderUC
+ A
(
A B
)
B C
.
 
Where
 
(
 
o
 
=>
 
o
  !
.
! "
Id
" $
==
% '
id
( *
)
* +
.
 
FirstOrDefault
 #
(
# $
)
$ %
;
% &
return
 
RedirectToAction
 '
(
' (
$str
( 6
,
6 7
conferencias
8 D
)
D E
;
E F
}
 
else
 
{
 
ViewBag
 
.
 
Ponentes
  
=
! "
context
# *
.
* +
GetPonentes
+ 6
(
6 7
)
7 8
;
8 9
var
 
account
 
=
 
context
 %
.
% &
GetConferencias
& 5
(
5 6
)
6 7
.
7 8
Where
8 =
(
= >
o
> ?
=>
@ B
o
C D
.
D E
Id
E G
==
H J
id
K M
)
M N
.
N O
FirstOrDefault
O ]
(
] ^
)
^ _
;
_ `
return
 
View
 
(
 
$str
 "
,
" #
account
$ +
)
+ ,
;
, -
}
 
}
 	
[
 	
HttpPost
	 
]
 
public
 
ActionResult
 
Edit
  
(
  !
Conferencia
! ,
conferencia
- 8
,
8 9
	IFormFile
: C
image
D I
)
I J
{
 	
claim
 
.
 
SetHttpContext
  
(
  !
HttpContext
! ,
)
, -
;
- .
if
 
(
 
conferencia
 
==
 
null
 #
)
# $

ModelState
 
.
 
AddModelError
 (
(
( )
$str
) 6
,
6 7
$str
8 U
)
U V
;
V W
if
 
(
 

ModelState
 
.
 
IsValid
 "
)
" #
{
 
context
 
.
 
EditConferencia
 '
(
' (
conferencia
( 3
,
3 4
image
4 9
)
9 :
;
: ;
return
 
RedirectToAction
 '
(
' (
$str
( 6
)
6 7
;
7 8
}
 
else
 
{
 
ViewBag
 
.
 
Ponentes
  
=
! "
context
# *
.
* +
GetPonentes
+ 6
(
6 7
)
7 8
;
8 9
return
 
View
 
(
 
$str
 "
,
" #
conferencia
$ /
)
/ 0
;
0 1
}
 
}
   	
[
¢¢ 	
HttpGet
¢¢	 
]
¢¢ 
public
££ 
ActionResult
££ 
Comprar
££ #
(
££# $
Comprar
££$ +
comprar
££, 3
,
££3 4
int
££5 8
idF
££9 <
,
££< =
string
££> D
titulo
££E K
,
££K L
decimal
££M T
monto
££U Z
)
££Z [
{
¤¤ 	
claim
¥¥ 
.
¥¥ 
SetHttpContext
¥¥  
(
¥¥  !
HttpContext
¥¥! ,
)
¥¥, -
;
¥¥- .
var
¦¦ 
cuenta
¦¦ 
=
¦¦ 
context
¦¦  
.
¦¦  !

GetCuentas
¦¦! +
(
¦¦+ ,
)
¦¦, -
.
¦¦- .
Where
§§ 
(
§§ 
o
§§ 
=>
§§ 
o
§§ 
.
§§ 
UserId
§§ #
==
§§$ &
claim
§§' ,
.
§§, -
GetLoggedUser
§§- :
(
§§: ;
)
§§; <
.
§§< =
Id
§§= ?
)
§§? @
.
§§@ A
ToList
¨¨ 
(
¨¨ 
)
¨¨ 
;
¨¨ 
if
©© 
(
©© 
cuenta
©© 
.
©© 
Count
©© 
(
©© 
)
©© 
>
©©  
$num
©©! "
)
©©" #
{
ªª 
var
«« 
compra
«« 
=
«« 
context
«« $
.
««$ %

GetCompras
««% /
(
««/ 0
)
««0 1
;
««1 2
foreach
­­ 
(
­­ 
var
­­ 
item
­­ !
in
­­" $
compra
­­% +
)
­­+ ,
{
®® 
if
¯¯ 
(
¯¯ 
item
¯¯ 
.
¯¯ 
IdUser
¯¯ #
==
¯¯$ &
claim
¯¯' ,
.
¯¯, -
GetLoggedUser
¯¯- :
(
¯¯: ;
)
¯¯; <
.
¯¯< =
Id
¯¯= ?
&&
¯¯@ B
item
¯¯C G
.
¯¯G H
IdConferencia
¯¯H U
==
¯¯V X
idF
¯¯Y \
)
¯¯\ ]
{
°° 
TempData
±±  
[
±±  !
$str
±±! )
]
±±) *
=
±±+ ,
$str
±±- S
;
±±S T

ModelState
²² "
.
²²" #
AddModelError
²²# 0
(
²²0 1
$str
²²1 8
,
²²8 9
$str
²²: S
)
²²S T
;
²²T U
}
³³ 
}
´´ 
if
µµ 
(
µµ 

ModelState
µµ 
.
µµ 
IsValid
µµ &
)
µµ& '
{
¶¶ 
foreach
·· 
(
·· 
var
··  
item
··! %
in
··& (
cuenta
··) /
)
··/ 0
{
¸¸ 
int
¹¹ 
idCuenta
¹¹ $
=
¹¹% &
item
¹¹' +
.
¹¹+ ,
Id
¹¹, .
;
¹¹. /
var
ºº 
transaccionCli
ºº *
=
ºº+ ,
new
ºº- 0
Transaccion
ºº1 <
{
»» 
CuentaId
¼¼ $
=
¼¼% &
idCuenta
¼¼' /
,
¼¼/ 0
	FechaHora
½½ %
=
½½& '
DateTime
½½( 0
.
½½0 1
Now
½½1 4
,
½½4 5
Tipo
¾¾  
=
¾¾! "
$str
¾¾# +
,
¾¾+ ,
Amount
¿¿ "
=
¿¿# $
monto
¿¿% *
*
¿¿+ ,
-
¿¿- .
$num
¿¿. /
,
¿¿/ 0
Motivo
ÀÀ "
=
ÀÀ# $
$str
ÀÀ% 3
+
ÀÀ4 5
titulo
ÀÀ6 <
+
ÀÀ= >
$str
ÀÀ? J
}
ÁÁ 
;
ÁÁ 
var
ÂÂ 
transaccionAd
ÂÂ )
=
ÂÂ* +
new
ÂÂ, /
Transaccion
ÂÂ0 ;
{
ÃÃ 
CuentaId
ÄÄ $
=
ÄÄ% &
$num
ÄÄ' (
,
ÄÄ( )
	FechaHora
ÅÅ %
=
ÅÅ& '
DateTime
ÅÅ( 0
.
ÅÅ0 1
Now
ÅÅ1 4
,
ÅÅ4 5
Tipo
ÆÆ  
=
ÆÆ! "
$str
ÆÆ# *
,
ÆÆ* +
Amount
ÇÇ "
=
ÇÇ# $
monto
ÇÇ% *
,
ÇÇ* +
Motivo
ÈÈ "
=
ÈÈ# $
$str
ÈÈ% 3
+
ÈÈ4 5
titulo
ÈÈ6 <
+
ÈÈ= >
$str
ÈÈ? J
}
ÉÉ 
;
ÉÉ 
context
ÊÊ 
.
ÊÊ  
AddTransaccion
ÊÊ  .
(
ÊÊ. /
transaccionCli
ÊÊ/ =
,
ÊÊ= >
transaccionAd
ÊÊ? L
)
ÊÊL M
;
ÊÊM N
context
ËË 
.
ËË  !
ModificaMontoCuenta
ËË  3
(
ËË3 4
transaccionCli
ËË4 B
.
ËËB C
CuentaId
ËËC K
)
ËËK L
;
ËËL M
context
ÌÌ 
.
ÌÌ  !
ModificaMontoCuenta
ÌÌ  3
(
ÌÌ3 4
transaccionAd
ÌÌ4 A
.
ÌÌA B
CuentaId
ÌÌB J
)
ÌÌJ K
;
ÌÌK L
}
ÍÍ 
context
ÎÎ 
.
ÎÎ 

AddCompras
ÎÎ &
(
ÎÎ& '
comprar
ÎÎ' .
,
ÎÎ. /
claim
ÎÎ0 5
.
ÎÎ5 6
GetLoggedUser
ÎÎ6 C
(
ÎÎC D
)
ÎÎD E
.
ÎÎE F
Id
ÎÎF H
,
ÎÎH I
idF
ÎÎJ M
)
ÎÎM N
;
ÎÎN O
return
ÐÐ 
RedirectToAction
ÐÐ +
(
ÐÐ+ ,
$str
ÐÐ, :
)
ÐÐ: ;
;
ÐÐ; <
}
ÑÑ 
}
ÒÒ 
return
ÓÓ 
RedirectToAction
ÓÓ #
(
ÓÓ# $
$str
ÓÓ$ 2
)
ÓÓ2 3
;
ÓÓ3 4
}
ÔÔ 	
[
ÖÖ 	
HttpGet
ÖÖ	 
]
ÖÖ 
public
×× 
ActionResult
×× 
Pasadas
×× #
(
××# $
string
××$ *
search
××+ 1
)
××1 2
{
ØØ 	
claim
ÙÙ 
.
ÙÙ 
SetHttpContext
ÙÙ  
(
ÙÙ  !
HttpContext
ÙÙ! ,
)
ÙÙ, -
;
ÙÙ- .
if
ÚÚ 
(
ÚÚ 
claim
ÚÚ 
.
ÚÚ 
GetLoggedUser
ÚÚ #
(
ÚÚ# $
)
ÚÚ$ %
.
ÚÚ% &
Username
ÚÚ& .
!=
ÚÚ/ 1
$str
ÚÚ2 <
)
ÚÚ< =
ViewBag
ÛÛ 
.
ÛÛ 
Usuario
ÛÛ 
=
ÛÛ  !
$str
ÛÛ" ,
;
ÛÛ, -
var
ÝÝ 
ponente
ÝÝ 
=
ÝÝ 
context
ÝÝ !
.
ÝÝ! "
GetPonentes
ÝÝ" -
(
ÝÝ- .
)
ÝÝ. /
;
ÝÝ/ 0
var
ßß 
conferencia
ßß 
=
ßß 
context
ßß %
.
ßß% &$
GetConferenciasOrderUC
ßß& <
(
ßß< =
)
ßß= >
;
ßß> ?
var
áá 
compra
áá 
=
áá 
context
áá  
.
áá  !#
GetComprasOrderPasado
áá! 6
(
áá6 7
claim
áá7 <
.
áá< =
GetLoggedUser
áá= J
(
ááJ K
)
ááK L
.
ááL M
Id
ááM O
)
ááO P
;
ááP Q
DateTime
ãã 
fecha
ãã 
=
ãã 
DateTime
ãã %
.
ãã% &
Today
ãã& +
;
ãã+ ,
ViewBag
ää 
.
ää 
fecha
ää 
=
ää 
fecha
ää !
;
ää! "
ViewBag
ææ 
.
ææ 
Buscar
ææ 
=
ææ 
search
ææ #
;
ææ# $
if
èè 
(
èè 
!
èè 
string
èè 
.
èè 
IsNullOrEmpty
èè %
(
èè% &
search
èè& ,
)
èè, -
)
èè- .
{
éé 
compra
êê 
=
êê 
compra
êê 
.
êê  
Where
êê  %
(
êê% &
s
êê& '
=>
êê( *
s
êê+ ,
.
êê, -
Conferencia
êê- 8
.
êê8 9
Ponentes
êê9 A
.
êêA B
NomApe
êêB H
.
êêH I
Contains
êêI Q
(
êêQ R
search
êêR X
)
êêX Y
||
êêZ \
s
êê] ^
.
êê^ _
Conferencia
êê_ j
.
êêj k

TituloConf
êêk u
.
êêu v
Contains
êêv ~
(
êê~ 
searchêê 
)êê 
)êê 
.êê 
ToListêê 
(êê 
)êê 
;êê 
return
ëë 
View
ëë 
(
ëë 
$str
ëë %
,
ëë% &
compra
ëë' -
)
ëë- .
;
ëë. /
;
ëë0 1
}
ìì 
return
íí 
View
íí 
(
íí 
$str
íí !
,
íí! "
compra
íí# )
)
íí) *
;
íí* +
;
íí, -
}
îî 	
[
ïï 	
HttpGet
ïï	 
]
ïï 
public
ðð 
ActionResult
ðð 
Futuras
ðð #
(
ðð# $
string
ðð$ *
search
ðð+ 1
)
ðð1 2
{
ññ 	
claim
òò 
.
òò 
SetHttpContext
òò  
(
òò  !
HttpContext
òò! ,
)
òò, -
;
òò- .
if
óó 
(
óó 
claim
óó 
.
óó 
GetLoggedUser
óó #
(
óó# $
)
óó$ %
.
óó% &
Username
óó& .
!=
óó/ 1
$str
óó2 <
)
óó< =
ViewBag
ôô 
.
ôô 
Usuario
ôô 
=
ôô  !
$str
ôô" ,
;
ôô, -
var
öö 
ponente
öö 
=
öö 
context
öö !
.
öö! "
GetPonentes
öö" -
(
öö- .
)
öö. /
;
öö/ 0
var
øø 
conferencia
øø 
=
øø 
context
øø %
.
øø% &$
GetConferenciasOrderUC
øø& <
(
øø< =
)
øø= >
;
øø> ?
var
úú 
compra
úú 
=
úú 
context
úú  
.
úú  !$
GetComprasOrderFuturas
úú! 7
(
úú7 8
claim
úú8 =
.
úú= >
GetLoggedUser
úú> K
(
úúK L
)
úúL M
.
úúM N
Id
úúN P
)
úúP Q
;
úúQ R
DateTime
üü 
fecha
üü 
=
üü 
DateTime
üü %
.
üü% &
Today
üü& +
;
üü+ ,
ViewBag
ýý 
.
ýý 
fecha
ýý 
=
ýý 
fecha
ýý !
;
ýý! "
ViewBag
ÿÿ 
.
ÿÿ 
Buscar
ÿÿ 
=
ÿÿ 
search
ÿÿ #
;
ÿÿ# $
if
 
(
 
!
 
string
 
.
 
IsNullOrEmpty
 %
(
% &
search
& ,
)
, -
)
- .
{
 
compra
 
=
 
compra
 
.
  
Where
  %
(
% &
s
& '
=>
( *
s
+ ,
.
, -
Conferencia
- 8
.
8 9
Ponentes
9 A
.
A B
NomApe
B H
.
H I
Contains
I Q
(
Q R
search
R X
)
X Y
||
Z \
s
] ^
.
^ _
Conferencia
_ j
.
j k

TituloConf
k u
.
u v
Contains
v ~
(
~ 
search 
) 
) 
. 
ToList 
( 
) 
; 
return
 
View
 
(
 
$str
 %
,
% &
compra
' -
)
- .
;
. /
}
 
return
 
View
 
(
 
$str
 !
,
! "
compra
# )
)
) *
;
* +
}
 	
}
 
} àJ
JC:\Users\Edwin\Documents\GOLDCONF\GoldConf\Controllers\CuentaController.cs
	namespace

 	
GoldConf


 
.

 
Controllers

 
{ 
[ 
	Authorize 
] 
public 

class 
CuentaController !
:" #

Controller$ .
{ 
private 
readonly 
ICuentaRepository *
context+ 2
;2 3
private 
readonly 
IClaimService &
claim' ,
;, -
public 
CuentaController 
(  
ICuentaRepository  1
context2 9
,9 :
IClaimService; H
claimI N
)N O
{ 	
this 
. 
context 
= 
context "
;" #
this 
. 
claim 
= 
claim 
; 
} 	
[ 	
HttpGet	 
] 
public 
IActionResult 
Index "
(" #
)# $
{ 	
claim 
. 
SetHttpContext  
(  !
HttpContext! ,
), -
;- .
if 
( 
claim 
. 
GetLoggedUser #
(# $
)$ %
.% &
Username& .
!=/ 1
$str2 <
)< =
ViewBag 
. 
Usuario 
=  !
$str" ,
;, -
var 
cuentas 
= 
context !
.! "

GetCuentas" ,
(, -
)- .
. 
Where 
( 
o 
=> 
o 
. 
UserId $
==% '
claim( -
.- .
GetLoggedUser. ;
(; <
)< =
.= >
Id> @
)@ A
.   
ToList   
(   
)   
;   
ViewBag"" 
."" 
Types"" 
="" 
new"" 
List""  $
<""$ %
string""% +
>""+ ,
{""- .
$str""/ 9
,""9 :
$str""; C
}""D E
;""E F
ViewBag## 
.## 
Currency## 
=## 
new## "
List### '
<##' (
string##( .
>##. /
{##0 1
$str##2 9
}##: ;
;##; <
ViewBag%% 
.%% 
Total%% 
=%% 
cuentas%% #
.%%# $
Sum%%$ '
(%%' (
o%%( )
=>%%* ,
o%%- .
.%%. /
Amount%%/ 5
)%%5 6
;%%6 7
return&& 
View&& 
(&& 
$str&& 
,&&  
cuentas&&! (
)&&( )
;&&) *
}'' 	
[)) 	
HttpGet))	 
])) 
public** 
ActionResult** 
Crear** !
(**! "
)**" #
{++ 	
claim,, 
.,, 
SetHttpContext,,  
(,,  !
HttpContext,,! ,
),,, -
;,,- .
var-- 
cuentas-- 
=-- 
context-- !
.--! "

GetCuentas--" ,
(--, -
)--- .
... 
Where.. 
(.. 
o.. 
=>.. 
o.. 
... 
UserId.. $
==..% '
claim..( -
...- .
GetLoggedUser... ;
(..; <
)..< =
...= >
Id..> @
)..@ A
.// 
ToList// 
(// 
)// 
;// 
if00 
(00 
cuentas00 
.00 
Count00 
(00 
)00 
==00  "
$num00# $
)00$ %
{11 
ViewBag22 
.22 
Types22 
=22 
new22  #
List22$ (
<22( )
string22) /
>22/ 0
{221 2
$str223 =
,22= >
$str22? G
}22H I
;22I J
ViewBag33 
.33 
Currency33  
=33! "
new33# &
List33' +
<33+ ,
string33, 2
>332 3
{334 5
$str336 =
}33> ?
;33? @
return44 
View44 
(44 
$str44 #
,44# $
new44% (
Cuenta44) /
(44/ 0
)440 1
)441 2
;442 3
}55 
else66 
{77 
return88 
RedirectToAction88 '
(88' (
$str88( /
)88/ 0
;880 1
}99 
}:: 	
[== 	
HttpPost==	 
]== 
public>> 
IActionResult>> 
Crear>> "
(>>" #
Cuenta>># )
cuenta>>* 0
)>>0 1
{?? 	
claim@@ 
.@@ 
SetHttpContext@@  
(@@  !
HttpContext@@! ,
)@@, -
;@@- .
varAA 
cuentasAA 
=AA 
contextAA !
.AA! "

GetCuentasAA" ,
(AA, -
)AA- .
.BB 
WhereBB 
(BB 
oBB 
=>BB 
oBB 
.BB 
UserIdBB $
==BB% '
claimBB( -
.BB- .
GetLoggedUserBB. ;
(BB; <
)BB< =
.BB= >
IdBB> @
)BB@ A
.CC 
ToListCC 
(CC 
)CC 
;CC 
ifDD 
(DD 
cuentasDD 
.DD 
CountDD 
(DD 
)DD 
==DD  "
$numDD# $
)DD$ %
{EE 
ifFF 
(FF 
cuentaFF 
.FF 
AmountFF !
<FF" #
$numFF$ %
)FF% &
{GG 

ModelStateHH 
.HH 
AddModelErrorHH ,
(HH, -
$strHH- 5
,HH5 6
$strHH7 G
)HHG H
;HHH I
}II 
cuentaJJ 
.JJ 
UserIdJJ 
=JJ 
claimJJ  %
.JJ% &
GetLoggedUserJJ& 3
(JJ3 4
)JJ4 5
.JJ5 6
IdJJ6 8
;JJ8 9
ifKK 
(KK 

ModelStateKK 
.KK 
IsValidKK &
)KK& '
{LL 
ifMM 
(MM 
cuentaMM 
.MM 
AmountMM %
!=MM& (
$numMM) *
)MM* +
{NN 
cuentaOO 
.OO 
TransaccionsOO +
=OO, -
newOO. 1
ListOO2 6
<OO6 7
TransaccionOO7 B
>OOB C
{PP 
newQQ 
TransaccionQQ  +
{RR 
	FechaHoraSS  )
=SS* +
DateTimeSS, 4
.SS4 5
NowSS5 8
,SS8 9
TipoTT  $
=TT% &
$strTT' 0
,TT0 1
AmountUU  &
=UU' (
cuentaUU) /
.UU/ 0
AmountUU0 6
,UU6 7
MotivoVV  &
=VV' (
$strVV) 8
}WW 
}XX 
;XX 
}YY 
contextZZ 
.ZZ 
NewTransaccionZZ *
(ZZ* +
cuentaZZ+ 1
)ZZ1 2
;ZZ2 3
return[[ 
RedirectToAction[[ +
([[+ ,
$str[[, 3
)[[3 4
;[[4 5
}\\ 
else]] 
{^^ 
ViewBag__ 
.__ 
Types__ !
=__" #
new__$ '
List__( ,
<__, -
string__- 3
>__3 4
{__5 6
$str__7 A
,__A B
$str__C K
}__L M
;__M N
ViewBag`` 
.`` 
Currency`` $
=``% &
new``' *
List``+ /
<``/ 0
string``0 6
>``6 7
{``8 9
$str``: A
}``B C
;``C D
returnaa 
Viewaa 
(aa  
$straa  '
,aa' (
cuentaaa) /
)aa/ 0
;aa0 1
}bb 
}cc 
elsedd 
{ee 
returnff 
RedirectToActionff '
(ff' (
$strff( /
)ff/ 0
;ff0 1
}gg 
}ii 	
[kk 	
HttpGetkk	 
]kk 
publicll 
ActionResultll 
Transaccionll '
(ll' (
intll( +
idll, .
)ll. /
{mm 	
claimnn 
.nn 
SetHttpContextnn  
(nn  !
HttpContextnn! ,
)nn, -
;nn- .
ifoo 
(oo 
claimoo 
.oo 
GetLoggedUseroo #
(oo# $
)oo$ %
.oo% &
Usernameoo& .
!=oo/ 1
$stroo2 <
)oo< =
ViewBagpp 
.pp 
Usuariopp 
=pp  !
$strpp" ,
;pp, -
varrr 
transaccionesrr 
=rr 
contextrr  '
.rr' (
GetTransaccionsrr( 7
(rr7 8
idrr8 :
)rr: ;
;rr; <
ViewBagss 
.ss 
Cuentass 
=ss 
contextss $
.ss$ %

GetCuentasss% /
(ss/ 0
idss0 2
)ss2 3
;ss3 4
returntt 
Viewtt 
(tt 
$strtt %
,tt% &
transaccionestt' 4
)tt4 5
;tt5 6
}uu 	
}vv 
}ww 
HC:\Users\Edwin\Documents\GOLDCONF\GoldConf\Controllers\HomeController.cs
	namespace 	
GoldConf
 
. 
Controllers 
{ 
public 

class 
HomeController 
:  !

Controller" ,
{ 
private 
readonly 
IHomeRepository (
context) 0
;0 1
public 
HomeController 
( 
IHomeRepository -
context. 5
)5 6
{ 	
this 
. 
context 
= 
context "
;" #
} 	
public 
IActionResult 
Index "
(" #
)# $
{ 	
try 
{ 
var 
ponente 
= 
context %
.% &
GetPonentes& 1
(1 2
)2 3
;3 4
ViewBag 
. 
Conferencia #
=$ %
context& -
.- .
GetConferencias. =
(= >
)> ?
;? @
return 
View 
( 
$str #
,# $
ponente% ,
), -
;- .
} 
catch   
(   
	Exception   
ex   
)    
{!! 
throw"" 
new"" 
	Exception"" #
(""# $
ex""$ &
.""& '
Message""' .
)"". /
;""/ 0
}## 
}$$ 	
[&& 	
ResponseCache&&	 
(&& 
Duration&& 
=&&  !
$num&&" #
,&&# $
Location&&% -
=&&. /!
ResponseCacheLocation&&0 E
.&&E F
None&&F J
,&&J K
NoStore&&L S
=&&T U
true&&V Z
)&&Z [
]&&[ \
public'' 
IActionResult'' 
Error'' "
(''" #
)''# $
{(( 	
return)) 
View)) 
()) 
new)) 
ErrorViewModel)) *
{))+ ,
	RequestId))- 6
=))7 8
Activity))9 A
.))A B
Current))B I
?))I J
.))J K
Id))K M
??))N P
HttpContext))Q \
.))\ ]
TraceIdentifier))] l
}))m n
)))n o
;))o p
}** 	
}++ 
},, ãZ
KC:\Users\Edwin\Documents\GOLDCONF\GoldConf\Controllers\PonenteController.cs
	namespace

 	
GoldConf


 
.

 
Controllers

 
{ 
[ 
	Authorize 
] 
public 

class 
PonenteController "
:# $

Controller% /
{ 
private 
readonly 
IPonenteRepository +
context, 3
;3 4
private 
readonly 
IClaimService &
claim' ,
;, -
public 
readonly 
IHostEnvironment (
hostEnv) 0
;0 1
public 
PonenteController  
(  !
IPonenteRepository! 3
context4 ;
,; <
IHostEnvironment= M
hostEnvN U
,U V
IClaimServiceW d
claime j
)j k
{ 	
this 
. 
context 
= 
context "
;" #
this 
. 
hostEnv 
= 
hostEnv "
;" #
this 
. 
claim 
= 
claim 
; 
} 	
[ 	
HttpGet	 
] 
public 
ActionResult 
Ponente #
(# $
string$ *
search+ 1
)1 2
{ 	
claim 
. 
SetHttpContext  
(  !
HttpContext! ,
), -
;- .
if 
( 
claim 
. 
GetLoggedUser #
(# $
)$ %
.% &
Username& .
!=/ 1
$str2 <
)< =
ViewBag 
. 
Usuario 
=  !
$str" ,
;, -
ViewBag!! 
.!! 
Buscar!! 
=!! 
search!! #
;!!# $
var## 
ponente## 
=## 
context## !
.##! "
GetPonentes##" -
(##- .
)##. /
;##/ 0
if%% 
(%% 
!%% 
string%% 
.%% 
IsNullOrEmpty%% %
(%%% &
search%%& ,
)%%, -
)%%- .
{&& 
ponente'' 
='' 
context'' !
.''! "
GetPonentesSearch''" 3
(''3 4
search''4 :
)'': ;
;''; <
return(( 
View(( 
((( 
$str(( %
,((% &
ponente((' .
)((. /
;((/ 0
})) 
return++ 
View++ 
(++ 
$str++ !
,++! "
ponente++# *
)++* +
;+++ ,
},, 	
[-- 	
HttpGet--	 
]-- 
public.. 
ActionResult.. 
Detalle.. #
(..# $
int..$ '
	idPonente..( 1
)..1 2
{// 	
claim00 
.00 
SetHttpContext00  
(00  !
HttpContext00! ,
)00, -
;00- .
ViewBag11 
.11 
Cuenta11 
=11 
context11 $
.11$ %
GetCuentaUser11% 2
(112 3
)113 4
.22 
Where22 
(22 
o22 
=>22 
o22  
.22  !
UserId22! '
==22( *
claim22+ 0
.220 1
GetLoggedUser221 >
(22> ?
)22? @
.22@ A
Id22A C
)22C D
.22D E
ToList22E K
(22K L
)22L M
;22M N
if33 
(33 
claim33 
.33 
GetLoggedUser33 #
(33# $
)33$ %
.33% &
Username33& .
!=33/ 1
$str332 <
)33< =
{44 
ViewBag55 
.55 
Usuario55 
=55  !
$str55" ,
;55, -
ViewBag66 
.66 
Compra66 
=66  
context66! (
.66( )

GetCompras66) 3
(663 4
)664 5
.77 
Where77 
(77 
o77 
=>77 
o77  !
.77! "
IdUser77" (
==77) +
claim77, 1
.771 2
GetLoggedUser772 ?
(77? @
)77@ A
.77A B
Id77B D
)77D E
.77E F
ToList77F L
(77L M
)77M N
;77N O
}88 
else99 
{:: 
ViewBag;; 
.;; 
Compra;; 
=;;  
context;;! (
.;;( )

GetCompras;;) 3
(;;3 4
);;4 5
;;;5 6
}<< 
var>> 
Ponente>> 
=>> 
context>> !
.>>! "

GetPonente>>" ,
(>>, -
	idPonente>>- 6
)>>6 7
;>>7 8
ViewBag@@ 
.@@ 
Conferencias@@  
=@@! "
context@@# *
.@@* +"
GetConferenciasPonente@@+ A
(@@A B
	idPonente@@B K
)@@K L
;@@L M
ViewBagBB 
.BB 
CursosBB 
=BB 
contextBB $
.BB$ %"
GetConferenciasPonenteBB% ;
(BB; <
	idPonenteBB< E
)BBE F
.BBF G
CountBBG L
(BBL M
)BBM N
;BBN O
returnDD 
ViewDD 
(DD 
$strDD !
,DD! "
PonenteDD# *
)DD* +
;DD+ ,
}EE 	
[GG 	
HttpGetGG	 
]GG 
publicHH 
IActionResultHH 
	RegistrarHH &
(HH& '
)HH' (
{II 	
claimJJ 
.JJ 
SetHttpContextJJ  
(JJ  !
HttpContextJJ! ,
)JJ, -
;JJ- .
ifKK 
(KK 
claimKK 
.KK 
GetLoggedUserKK #
(KK# $
)KK$ %
.KK% &
UsernameKK& .
!=KK/ 1
$strKK2 <
)KK< =
{LL 
varMM 
ponentesMM 
=MM 
contextMM &
.MM& '
GetPonentesMM' 2
(MM2 3
)MM3 4
;MM4 5
returnNN 
RedirectToActionNN '
(NN' (
$strNN( 1
,NN1 2
ponentesNN3 ;
)NN; <
;NN< =
}OO 
elsePP 
{QQ 
returnRR 
ViewRR 
(RR 
$strRR '
,RR' (
newRR) ,
PonenteRR- 4
(RR4 5
)RR5 6
)RR6 7
;RR7 8
}SS 
}TT 	
[UU 	
HttpPostUU	 
]UU 
publicVV 
ActionResultVV 
	RegistrarVV %
(VV% &
PonenteVV& -
ponenteVV. 5
,VV5 6
	IFormFileVV7 @
imageVVA F
,VVF G
stringVVH N
emailVVO T
,VVT U
stringVVV \
telefonoVV] e
)VVe f
{WW 	
claimXX 
.XX 
SetHttpContextXX  
(XX  !
HttpContextXX! ,
)XX, -
;XX- .
ifYY 
(YY 
claimYY 
.YY 
GetLoggedUserYY #
(YY# $
)YY$ %
.YY% &
UsernameYY& .
!=YY/ 1
$strYY2 <
)YY< =
{ZZ 
var[[ 
ponentes[[ 
=[[ 
context[[ &
.[[& '
GetPonentes[[' 2
([[2 3
)[[3 4
;[[4 5
return\\ 
RedirectToAction\\ '
(\\' (
$str\\( 1
,\\1 2
ponentes\\3 ;
)\\; <
;\\< =
}]] 
else^^ 
{__ 
var`` 
ponentes`` 
=`` 
context`` &
.``& '
GetPonentes``' 2
(``2 3
)``3 4
;``4 5
foreachaa 
(aa 
varaa 
itemaa !
inaa" $
ponentesaa% -
)aa- .
{bb 
ifcc 
(cc 
itemcc 
.cc 
Emailcc "
==cc# %
emailcc& +
)cc+ ,

ModelStatedd "
.dd" #
AddModelErrordd# 0
(dd0 1
$strdd1 8
,dd8 9
$strdd: P
)ddP Q
;ddQ R
ifee 
(ee 
itemee 
.ee 
Telefonoee %
==ee& (
telefonoee) 1
)ee1 2

ModelStateff "
.ff" #
AddModelErrorff# 0
(ff0 1
$strff1 ;
,ff; <
$strff= T
)ffT U
;ffU V
}gg 
ifhh 
(hh 

ModelStatehh 
.hh 
IsValidhh &
)hh& '
{ii 
contextjj 
.jj 

NewPonentejj &
(jj& '
ponentejj' .
,jj. /
imagejj0 5
)jj5 6
;jj6 7
returnkk 
RedirectToActionkk +
(kk+ ,
$strkk, 5
)kk5 6
;kk6 7
}ll 
elsemm 
{nn 
returnoo 
RedirectToActionoo +
(oo+ ,
$stroo, 7
,oo7 8
ponenteoo9 @
)oo@ A
;ooA B
}pp 
}qq 
}rr 	
[tt 	
HttpGettt	 
]tt 
publicuu 
ActionResultuu 
Edituu  
(uu  !
intuu! $
iduu% '
)uu' (
{vv 	
claimww 
.ww 
SetHttpContextww  
(ww  !
HttpContextww! ,
)ww, -
;ww- .
ifxx 
(xx 
claimxx 
.xx 
GetLoggedUserxx #
(xx# $
)xx$ %
.xx% &
Usernamexx& .
!=xx/ 1
$strxx2 <
)xx< =
{yy 
varzz 
ponentezz 
=zz 
contextzz %
.zz% &
GetPonenteszz& 1
(zz1 2
)zz2 3
;zz3 4
return{{ 
RedirectToAction{{ '
({{' (
$str{{( 1
,{{1 2
ponente{{3 :
){{: ;
;{{; <
}|| 
else}} 
{~~ 
var 
ponente 
= 
context %
.% &

GetPonente& 0
(0 1
id1 3
)3 4
;4 5
return
 
View
 
(
 
$str
 "
,
" #
ponente
$ +
)
+ ,
;
, -
}
 
}
 	
[
 	
HttpPost
	 
]
 
public
 
ActionResult
 
Edit
  
(
  !
Ponente
! (
ponente
) 0
,
0 1
	IFormFile
2 ;
image
< A
)
A B
{
 	
if
 
(
 

ModelState
 
.
 
IsValid
 "
)
" #
{
 
context
 
.
 
EditPonente
 #
(
# $
ponente
$ +
,
+ ,
image
, 1
)
1 2
;
2 3
return
 
RedirectToAction
 '
(
' (
$str
( 1
)
1 2
;
2 3
}
 
else
 
{
 
return
 
View
 
(
 
$str
 "
,
" #
ponente
# *
)
* +
;
+ ,
}
 
}
 	
}
 
} 
<C:\Users\Edwin\Documents\GOLDCONF\GoldConf\Models\Comprar.cs
	namespace 	
GoldConf
 
. 
Models 
{ 
public 

class 
Comprar 
{		 
public

 
int

 
Id

 
{

 
get

 
;

 
set

  
;

  !
}

" #
public 
int 
IdConferencia  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
int 
IdUser 
{ 
get 
;  
set! $
;$ %
}& '
public 
Conferencia 
Conferencia &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
User 
User 
{ 
get 
; 
set  #
;# $
}% &
} 
} 
@C:\Users\Edwin\Documents\GOLDCONF\GoldConf\Models\Conferencia.cs
	namespace 	
GoldConf
 
. 
Models 
{ 
public		 

class		 
Conferencia		 
{

 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
string 
	ImagePath 
{  !
get" %
;% &
set' *
;* +
}, -
[ 	
Required	 
] 
public 
int 
	PonenteId 
{ 
get "
;" #
set$ '
;' (
}) *
[ 	
Required	 
] 
public 
DateTime 
	FechaConf !
{" #
get$ '
;' (
set) ,
;, -
}. /
[ 	
Required	 
] 
public 
string 

TituloConf  
{! "
get# &
;& '
set( +
;+ ,
}- .
[ 	
Required	 
] 
public 
decimal 

PrecioConf !
{" #
get$ '
;' (
set) ,
;, -
}. /
[ 	
Required	 
] 
public 
string 
DetalleConf !
{" #
get$ '
;' (
set) ,
;, -
}. /
[ 	
Required	 
] 
public 
string 
Ap1 
{ 
get 
;  
set! $
;$ %
}& '
[ 	
Required	 
] 
public 
string 
Ap2 
{ 
get 
;  
set! $
;$ %
}& '
[ 	
Required	 
] 
public 
string 
Ap3 
{ 
get 
;  
set! $
;$ %
}& '
[ 	
Required	 
] 
public 
string 

Definicion  
{! "
get# &
;& '
set( +
;+ ,
}- .
[ 	
Required	 
] 
public   
string   
Objetivo   
{    
get  ! $
;  $ %
set  & )
;  ) *
}  + ,
[!! 	
Required!!	 
]!! 
public"" 
string"" 
	MetaFinal"" 
{""  !
get""" %
;""% &
set""' *
;""* +
}"", -
public## 
Ponente## 
Ponentes## 
{##  !
get##" %
;##% &
set##' *
;##* +
}##, -
public$$ 
List$$ 
<$$ 
Comprar$$ 
>$$ 
Compras$$ $
{$$% &
get$$' *
;$$* +
set$$, /
;$$/ 0
}$$1 2
}%% 
}&& 
;C:\Users\Edwin\Documents\GOLDCONF\GoldConf\Models\Cuenta.cs
	namespace 	
GoldConf
 
. 
Models 
{ 
public		 

class		 
Cuenta		 
{

 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
[ 	
Required	 
( 
ErrorMessage 
=  
$str! <
)< =
]= >
public 
string 
Type 
{ 
get  
;  !
set" %
;% &
}' (
[ 	
Required	 
( 
ErrorMessage 
=  
$str! <
)< =
]= >
public 
string 
Name 
{ 
get  
;  !
set" %
;% &
}' (
[ 	
Required	 
( 
ErrorMessage 
=  
$str! <
)< =
]= >
public 
string 
Currency 
{  
get! $
;$ %
set& )
;) *
}+ ,
[ 	
Required	 
( 
ErrorMessage 
=  
$str! <
)< =
]= >
public 
decimal 
Amount 
{ 
get  #
;# $
set% (
;( )
}* +
public 
int 
UserId 
{ 
get 
;  
set! $
;$ %
}& '
public 
List 
< 
Transaccion 
>  
Transaccions! -
{. /
get0 3
;3 4
set5 8
;8 9
}: ;
} 
} 
@C:\Users\Edwin\Documents\GOLDCONF\GoldConf\Models\Descripcion.cs
	namespace 	
GoldConf
 
. 
Models 
{ 
public 

class 
Descripcion 
{		 
}

 
} 
CC:\Users\Edwin\Documents\GOLDCONF\GoldConf\Models\ErrorViewModel.cs
	namespace 	
GoldConf
 
. 
Models 
{ 
public 

class 
ErrorViewModel 
{ 
public 
string 
	RequestId 
{  !
get" %
;% &
set' *
;* +
}, -
public		 
bool		 
ShowRequestId		 !
=>		" $
!		% &
string		& ,
.		, -
IsNullOrEmpty		- :
(		: ;
	RequestId		; D
)		D E
;		E F
}

 
} Ó$
DC:\Users\Edwin\Documents\GOLDCONF\GoldConf\Models\GoldConfContext.cs
	namespace 	
GoldConf
 
. 
Models 
{		 
public

 

	interface

 
IGoldConfContext

 %
{ 
DbSet 
< 
User 
> 
Users 
{ 
get 
;  
set! $
;$ %
}& '
DbSet 
< 
Conferencia 
> 
Conferencias '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
DbSet 
< 
Ponente 
> 
Ponentes 
{  !
get" %
;% &
set' *
;* +
}, -
DbSet 
< 
Comprar 
> 
Compras 
{  
get! $
;$ %
set& )
;) *
}+ ,
DbSet 
< 
Cuenta 
> 
Cuentas 
{ 
get  #
;# $
set% (
;( )
}* +
DbSet 
< 
Transaccion 
> 
Transacciones (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
int 
SaveChanges 
( 
) 
; 
} 
public 

class 
GoldConfContext  
:! "
	DbContext# ,
,, -
IGoldConfContext. >
{ 
public 
DbSet 
< 
User 
> 
Users  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
DbSet 
< 
Conferencia  
>  !
Conferencias" .
{/ 0
get1 4
;4 5
set6 9
;9 :
}; <
public 
DbSet 
< 
Ponente 
> 
Ponentes &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
DbSet 
< 
Comprar 
> 
Compras %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 
DbSet 
< 
Cuenta 
> 
Cuentas $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
DbSet 
< 
Transaccion  
>  !
Transacciones" /
{0 1
get2 5
;5 6
set7 :
;: ;
}< =
public 
GoldConfContext 
( 
DbContextOptions /
</ 0
GoldConfContext0 ?
>? @
optionsA H
)H I
: 
base 
( 
options 
) 
{ 
} 
	protected   
override   
void   
OnModelCreating    /
(  / 0
ModelBuilder  0 <
modelBuilder  = I
)  I J
{!! 	
base"" 
."" 
OnModelCreating""  
(""  !
modelBuilder""! -
)""- .
;"". /
modelBuilder%% 
.%% 
ApplyConfiguration%% +
(%%+ ,
new%%, /
UserMap%%0 7
(%%7 8
)%%8 9
)%%9 :
;%%: ;
modelBuilder&& 
.&& 
ApplyConfiguration&& +
(&&+ ,
new&&, /
ConferenciaMap&&0 >
(&&> ?
)&&? @
)&&@ A
;&&A B
modelBuilder'' 
.'' 
ApplyConfiguration'' +
(''+ ,
new'', /

PonenteMap''0 :
('': ;
)''; <
)''< =
;''= >
modelBuilder(( 
.(( 
ApplyConfiguration(( +
(((+ ,
new((, /

ComprarMap((0 :
(((: ;
)((; <
)((< =
;((= >
modelBuilder)) 
.)) 
ApplyConfiguration)) +
())+ ,
new)), /
	CuentaMap))0 9
())9 :
))): ;
))); <
;))< =
modelBuilder** 
.** 
ApplyConfiguration** +
(**+ ,
new**, /
TransaccionMap**0 >
(**> ?
)**? @
)**@ A
;**A B
},, 	
}-- 
}.. 
DC:\Users\Edwin\Documents\GOLDCONF\GoldConf\Models\Maps\ComprarMap.cs
	namespace 	
GoldConf
 
. 
Models 
. 
Maps 
{ 
public		 

class		 

ComprarMap		 
:		 $
IEntityTypeConfiguration		 6
<		6 7
Comprar		7 >
>		> ?
{

 
public 
void 
	Configure 
( 
	Microsoft '
.' (
EntityFrameworkCore( ;
.; <
Metadata< D
.D E
BuildersE M
.M N
EntityTypeBuilderN _
<_ `
Comprar` g
>g h
builderi p
)p q
{ 	
builder 
. 
ToTable 
( 
$str +
)+ ,
;, -
builder 
. 
HasKey 
( 
o 
=> 
o  !
.! "
Id" $
)$ %
;% &
builder 
. 
HasOne 
( 
y 
=> 
y  !
.! "
User" &
)& '
. 
WithMany 
( 
y 
=> 
y  
.  !
Compras! (
)( )
. 
HasForeignKey 
( 
y  
=>! #
y$ %
.% &
IdUser& ,
), -
;- .
builder 
. 
HasOne 
( 
x 
=> 
x  !
.! "
Conferencia" -
)- .
. 
WithMany 
( 
x 
=> 
x  
.  !
Compras! (
)( )
. 
HasForeignKey 
( 
x  
=>! #
x$ %
.% &
IdConferencia& 3
)3 4
;4 5
} 	
} 
} Å

HC:\Users\Edwin\Documents\GOLDCONF\GoldConf\Models\Maps\ConferenciaMap.cs
	namespace 	
GoldConf
 
. 
Models 
. 
Maps 
{		 
public

 

class

 
ConferenciaMap

 
:

  !$
IEntityTypeConfiguration

" :
<

: ;
Conferencia

; F
>

F G
{ 
public 
void 
	Configure 
( 
EntityTypeBuilder /
</ 0
Conferencia0 ;
>; <
builder= D
)D E
{ 	
builder 
. 
ToTable 
( 
$str )
)) *
;* +
builder 
. 
HasKey 
( 
o 
=> 
o  !
.! "
Id" $
)$ %
;% &
builder 
. 
HasOne 
( 
o 
=> 
o  !
.! "
Ponentes" *
)* +
.+ ,
WithMany 
( 
) 
. 
HasForeignKey 
( 
o 
=>  "
o# $
.$ %
	PonenteId% .
). /
;/ 0
} 	
} 
} ´

CC:\Users\Edwin\Documents\GOLDCONF\GoldConf\Models\Maps\CuentaMap.cs
	namespace 	
GoldConf
 
. 
Models 
. 
Maps 
{		 
public

 

class

 
	CuentaMap

 
:

 $
IEntityTypeConfiguration

 5
<

5 6
Cuenta

6 <
>

< =
{ 
public 
void 
	Configure 
( 
EntityTypeBuilder /
</ 0
Cuenta0 6
>6 7
builder8 ?
)? @
{ 	
builder 
. 
ToTable 
( 
$str $
)$ %
;% &
builder 
. 
HasKey 
( 
o 
=> 
o  !
.! "
Id" $
)$ %
;% &
builder 
. 
HasMany 
( 
o 
=>  
o! "
." #
Transaccions# /
)/ 0
.0 1
WithOne 
( 
) 
. 
HasForeignKey 
( 
o 
=>  "
o# $
.$ %
CuentaId% -
)- .
;. /
} 	
} 
} 
DC:\Users\Edwin\Documents\GOLDCONF\GoldConf\Models\Maps\PonenteMap.cs
	namespace 	
GoldConf
 
. 
Models 
. 
Maps 
{		 
public

 

class

 

PonenteMap

 
:

 $
IEntityTypeConfiguration

 6
<

6 7
Ponente

7 >
>

> ?
{ 
public 
void 
	Configure 
( 
EntityTypeBuilder /
</ 0
Ponente0 7
>7 8
builder9 @
)@ A
{ 	
builder 
. 
ToTable 
( 
$str %
)% &
;& '
builder 
. 
HasKey 
( 
o 
=> 
o  !
.! "
Id" $
)$ %
;% &
} 	
} 
} ®
HC:\Users\Edwin\Documents\GOLDCONF\GoldConf\Models\Maps\TransaccionMap.cs
	namespace 	
GoldConf
 
. 
Models 
. 
Maps 
{		 
public

 

class

 
TransaccionMap

 
:

  !$
IEntityTypeConfiguration

" :
<

: ;
Transaccion

; F
>

F G
{ 
public 
void 
	Configure 
( 
EntityTypeBuilder /
</ 0
Transaccion0 ;
>; <
builder= D
)D E
{ 	
builder 
. 
ToTable 
( 
$str )
)) *
;* +
builder 
. 
HasKey 
( 
o 
=> 
o  !
.! "
Id" $
)$ %
;% &
} 	
} 
} 
AC:\Users\Edwin\Documents\GOLDCONF\GoldConf\Models\Maps\UserMap.cs
	namespace 	
GoldConf
 
. 
Models 
. 
Maps 
{		 
public

 

class

 
UserMap

 
:

 $
IEntityTypeConfiguration

 3
<

3 4
User

4 8
>

8 9
{ 
public 
void 
	Configure 
( 
EntityTypeBuilder /
</ 0
User0 4
>4 5
builder6 =
)= >
{ 	
builder 
. 
ToTable 
( 
$str "
)" #
;# $
builder 
. 
HasKey 
( 
o 
=> 
o  !
.! "
Id" $
)$ %
;% &
} 	
} 
} Ù

AC:\Users\Edwin\Documents\GOLDCONF\GoldConf\Models\PaypalLogger.cs
	namespace 	
GoldConf
 
. 
Models 
{		 
public

 

class

 
PaypalLogger

 
{ 
public 
static 
string 
LogDirectoryPath -
=. /
Environment0 ;
.; <
CurrentDirectory< L
;L M
public 
static 
void 
Log 
( 
String %
messages& .
). /
{ 	
try 
{ 
StreamWriter 
strw !
=" #
new$ '
StreamWriter( 4
(4 5
LogDirectoryPath5 E
+F G
$strH [
,[ \
true\ `
)` a
;a b
strw 
. 
	WriteLine 
( 
$str )
,) *
DateTime+ 3
.3 4
Now4 7
.7 8
ToString8 @
(@ A
$strA V
)V W
,W X
messagesY a
)a b
;b c
} 
catch 
( 
	Exception 
) 
{ 
throw 
; 
} 
} 	
} 
} ­
<C:\Users\Edwin\Documents\GOLDCONF\GoldConf\Models\Ponente.cs
	namespace 	
GoldConf
 
. 
Models 
{ 
public		 

class		 
Ponente		 
{

 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
string 
Imagen 
{ 
get "
;" #
set$ '
;' (
}) *
[ 	
Required	 
( 
ErrorMessage 
=  
$str! <
)< =
]= >
public 
string 
NomApe 
{ 
get "
;" #
set$ '
;' (
}) *
[ 	
Required	 
( 
ErrorMessage 
=  
$str! <
)< =
]= >
public 
string 
Especialidad "
{# $
get% (
;( )
set* -
;- .
}/ 0
[ 	
Required	 
( 
ErrorMessage 
=  
$str! <
)< =
]= >
[ 	
EmailAddress	 
] 
public 
string 
Email 
{ 
get !
;! "
set# &
;& '
}( )
[ 	
Required	 
( 
ErrorMessage 
=  
$str! <
)< =
]= >
[ 	
RegularExpression	 
( 
$str $
)$ %
]% &
[ 	
	MinLength	 
( 
$num 
) 
] 
public 
string 
Telefono 
{  
get! $
;$ %
set& )
;) *
}+ ,
[ 	
Required	 
( 
ErrorMessage 
=  
$str! <
)< =
]= >
public 
string 
Logros 
{ 
get "
;" #
set$ '
;' (
}) *
[ 	
Required	 
( 
ErrorMessage 
=  
$str! <
)< =
]= >
public 
string 
Experiencia !
{" #
get$ '
;' (
set) ,
;, -
}. /
} 
} á
@C:\Users\Edwin\Documents\GOLDCONF\GoldConf\Models\Transaccion.cs
	namespace 	
GoldConf
 
. 
Models 
{ 
public		 

class		 
Transaccion		 
{

 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
[ 	
Required	 
( 
ErrorMessage 
=  
$str! <
)< =
]= >
public 
int 
CuentaId 
{ 
get !
;! "
set# &
;& '
}( )
[ 	
Required	 
( 
ErrorMessage 
=  
$str! <
)< =
]= >
public 
string 
Tipo 
{ 
get  
;  !
set" %
;% &
}' (
[ 	
Required	 
( 
ErrorMessage 
=  
$str! <
)< =
]= >
public 
DateTime 
	FechaHora !
{" #
get$ '
;' (
set) ,
;, -
}. /
[ 	
Required	 
( 
ErrorMessage 
=  
$str! <
)< =
]= >
public 
string 
Motivo 
{ 
get "
;" #
set$ '
;' (
}) *
[ 	
Required	 
( 
ErrorMessage 
=  
$str! <
)< =
]= >
public 
decimal 
Amount 
{ 
get  #
;# $
set% (
;( )
}* +
} 
} 
9C:\Users\Edwin\Documents\GOLDCONF\GoldConf\Models\User.cs
	namespace 	
GoldConf
 
. 
Models 
{ 
public		 

class		 
User		 
{

 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
[ 	
Required	 
( 
ErrorMessage 
=  
$str! <
)< =
]= >
public 
string 
NomApe 
{ 
get "
;" #
set$ '
;' (
}) *
[ 	
Required	 
( 
ErrorMessage 
=  
$str! <
)< =
]= >
[ 	
EmailAddress	 
] 
public 
string 
Email 
{ 
get !
;! "
set# &
;& '
}( )
[ 	
Required	 
( 
ErrorMessage 
=  
$str! <
)< =
]= >
[ 	
RegularExpression	 
( 
$str *
)* +
]+ ,
public 
string 
Username 
{  
get! $
;$ %
set& )
;) *
}+ ,
[ 	
Required	 
( 
ErrorMessage 
=  
$str! <
)< =
]= >
[ 	
DataType	 
( 
DataType 
. 
Password #
)# $
]$ %
[ 	
	MinLength	 
( 
$num 
) 
] 
public 
string 
Password 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
List 
< 
Comprar 
> 
Compras $
{% &
get' *
;* +
set, /
;/ 0
}1 2
} 
} 

5C:\Users\Edwin\Documents\GOLDCONF\GoldConf\Program.cs
	namespace

 	
GoldConf


 
{ 
public 

class 
Program 
{ 
public 
static 
void 
Main 
(  
string  &
[& '
]' (
args) -
)- .
{ 	
CreateHostBuilder 
( 
args "
)" #
.# $
Build$ )
() *
)* +
.+ ,
Run, /
(/ 0
)0 1
;1 2
} 	
public 
static 
IHostBuilder "
CreateHostBuilder# 4
(4 5
string5 ;
[; <
]< =
args> B
)B C
=>D F
Host 
.  
CreateDefaultBuilder %
(% &
args& *
)* +
. $
ConfigureWebHostDefaults )
() *

webBuilder* 4
=>5 7
{ 

webBuilder 
. 

UseStartup )
<) *
Startup* 1
>1 2
(2 3
)3 4
;4 5
} 
) 
; 
} 
} Ñ 
GC:\Users\Edwin\Documents\GOLDCONF\GoldConf\Repository\AuthRepository.cs
	namespace 	
GoldConf
 
. 

Repository 
{ 
public 

	interface 
IAuthRepository $
{ 
User 

GetUsuario 
( 
string 
username '
,' (
string) /
password0 8
)8 9
;9 :
void 
SaveUsuario 
( 
User 
user "
)" #
;# $
List 
< 
User 
> 
GetUsuarios 
( 
)  
;  !
} 
public 

class 
AuthRepository 
:  
IAuthRepository! 0
{ 
private 
readonly 
IGoldConfContext )
context* 1
;1 2
private 
readonly 
IConfiguration '
configuration( 5
;5 6
public 
AuthRepository 
( 
IGoldConfContext .
context/ 6
,6 7
IConfiguration8 F
configurationG T
)T U
{ 	
this 
. 
context 
= 
context "
;" #
this 
. 
configuration 
=  
configuration! .
;. /
} 	
public 
User 

GetUsuario 
( 
string %
username& .
,. /
string0 6
password7 ?
)? @
{ 	
return   
context   
.   
Users    
.    !
Where  ! &
(  & '
o  ' (
=>  ) +
o  , -
.  - .
Username  . 6
==  7 9
username  : B
&&  C E
o  F G
.  G H
Password  H P
==  Q S

CreateHash  T ^
(  ^ _
password  _ g
)  g h
)  h i
.  i j
FirstOrDefault  j x
(  x y
)  y z
;  z {
}!! 	
public## 
List## 
<## 
User## 
>## 
GetUsuarios## %
(##% &
)##& '
{$$ 	
return%% 
context%% 
.%% 
Users%%  
.%%  !
ToList%%! '
(%%' (
)%%( )
;%%) *
}&& 	
public(( 
void(( 
SaveUsuario(( 
(((  
User((  $
user((% )
)(() *
{)) 	
user** 
.** 
Password** 
=** 

CreateHash** &
(**& '
user**' +
.**+ ,
Password**, 4
)**4 5
;**5 6
context++ 
.++ 
Users++ 
.++ 
Add++ 
(++ 
user++ "
)++" #
;++# $
context,, 
.,, 
SaveChanges,, 
(,,  
),,  !
;,,! "
}-- 	
	protected// 
string// 

CreateHash// #
(//# $
string//$ *
input//+ 0
)//0 1
{00 	
var11 
sha11 
=11 
SHA25611 
.11 
Create11 #
(11# $
)11$ %
;11% &
input22 
+=22 
configuration22 "
.22" #
GetValue22# +
<22+ ,
string22, 2
>222 3
(223 4
$str224 ;
)22; <
;22< =
var33 
hash33 
=33 
sha33 
.33 
ComputeHash33 &
(33& '
Encoding33' /
.33/ 0
Default330 7
.337 8
GetBytes338 @
(33@ A
input33A F
)33F G
)33G H
;33H I
return55 
Convert55 
.55 
ToBase64String55 )
(55) *
hash55* .
)55. /
;55/ 0
}66 	
}77 
}88 §~
NC:\Users\Edwin\Documents\GOLDCONF\GoldConf\Repository\ConferenciaRepository.cs
	namespace 	
GoldConf
 
. 

Repository 
{ 
public 

	interface "
IConferenciaRepository +
{ 
List 
< 
Ponente 
> 
GetPonentes !
(! "
)" #
;# $
List 
< 
Conferencia 
> 
GetConferencias )
() *
)* +
;+ ,
List 
< 
Conferencia 
>  
GetConferenciasOrder .
(. /
)/ 0
;0 1
List 
< 
Comprar 
> !
GetComprasOrderPasado +
(+ ,
int, /
idUser0 6
)6 7
;7 8
List 
< 
Comprar 
> "
GetComprasOrderFuturas ,
(, -
int- 0
idUser1 7
)7 8
;8 9
List 
< 
Conferencia 
> "
GetConferenciasOrderUC 0
(0 1
)1 2
;2 3
List 
< 
Cuenta 
> 

GetCuentas 
(  
)  !
;! "
List 
< 
Comprar 
> 

GetCompras  
(  !
)! "
;" #
void 
NewConferencia 
( 
Conferencia '
conferencia( 3
,3 4
	IFormFile5 >
file? C
)C D
;D E
void 
EditConferencia 
( 
Conferencia (
conferencia) 4
,4 5
	IFormFile6 ?
file@ D
)D E
;E F
void 
AddTransaccion 
( 
Transaccion '
transaccionCli( 6
,6 7
Transaccion8 C
transaccionAdD Q
)Q R
;R S
void 
ModificaMontoCuenta  
(  !
int! $
cuentaId% -
)- .
;. /
void 

AddCompras 
( 
Comprar 
comprar  '
,' (
int) ,
userId- 3
,3 4
int5 8
conferenciaId9 F
)F G
;G H
} 
public 

class !
ConferenciaRepository &
:' ("
IConferenciaRepository) ?
{ 
private 
readonly 
IGoldConfContext )
context* 1
;1 2
public   
readonly   
IWebHostEnvironment   +
hosting  , 3
;  3 4
public"" !
ConferenciaRepository"" $
(""$ %
IGoldConfContext""% 5
context""6 =
,""= >
IWebHostEnvironment""? R
hosting""S Z
)""Z [
{## 	
this$$ 
.$$ 
context$$ 
=$$ 
context$$ "
;$$" #
this%% 
.%% 
hosting%% 
=%% 
hosting%% "
;%%" #
}&& 	
public(( 
List(( 
<(( 
Comprar(( 
>(( 

GetCompras(( '
(((' (
)((( )
{)) 	
var** 
conferencias** 
=** 
context** &
.**& '
Compras**' .
.**. /
ToList**/ 5
(**5 6
)**6 7
;**7 8
return++ 
conferencias++ 
;++  
},, 	
public.. 
List.. 
<.. 
Conferencia.. 
>..  
GetConferencias..! 0
(..0 1
)..1 2
{// 	
var00 
conferencias00 
=00 
context00 &
.00& '
Conferencias00' 3
.003 4
ToList004 :
(00: ;
)00; <
;00< =
return11 
conferencias11 
;11  
}22 	
public44 
List44 
<44 
Conferencia44 
>44   
GetConferenciasOrder44! 5
(445 6
)446 7
{55 	
var66 
conferencias66 
=66 
context66 &
.66& '
Conferencias66' 3
.77 
Include77 
(77 
o77 
=>77 !
o77" #
.77# $
Ponentes77$ ,
)77, -
.88 
OrderByDescending88 &
(88& '
o88' (
=>88) +
o88, -
.88- .
	FechaConf88. 7
)887 8
.99 
Where99 
(99 
o99 
=>99 
o99  !
.99! "
	FechaConf99" +
>=99, .
DateTime99/ 7
.997 8
Now998 ;
)99; <
.:: 
ToList:: 
(:: 
):: 
;:: 
return;; 
conferencias;; 
;;;  
}<< 	
public>> 
List>> 
<>> 
Comprar>> 
>>> !
GetComprasOrderPasado>> 2
(>>2 3
int>>3 6
idUser>>7 =
)>>= >
{?? 	
var@@ 
conferencias@@ 
=@@ 
context@@ &
.@@& '
Compras@@' .
.AA 
IncludeAA 
(AA 
oAA 
=>AA !
oAA" #
.AA# $
ConferenciaAA$ /
)AA/ 0
.BB 
WhereBB 
(BB 
oBB 
=>BB 
oBB  !
.BB! "
IdUserBB" (
==BB) +
idUserBB, 2
)BB2 3
.CC 
WhereCC 
(CC 
oCC 
=>CC 
oCC  !
.CC! "
ConferenciaCC" -
.CC- .
	FechaConfCC. 7
<CC8 9
DateTimeCC: B
.CCB C
NowCCC F
)CCF G
.DD 
OrderByDescendingDD &
(DD& '
oDD' (
=>DD) +
oDD, -
.DD- .
ConferenciaDD. 9
.DD9 :
	FechaConfDD: C
)DDC D
.EE 
ToListEE 
(EE 
)EE 
;EE 
returnFF 
conferenciasFF 
;FF  
}GG 	
publicII 
ListII 
<II 
ComprarII 
>II "
GetComprasOrderFuturasII 3
(II3 4
intII4 7
idUserII8 >
)II> ?
{JJ 	
varKK 
conferenciasKK 
=KK 
contextKK &
.KK& '
ComprasKK' .
.LL 
IncludeLL 
(LL 
oLL 
=>LL !
oLL" #
.LL# $
ConferenciaLL$ /
)LL/ 0
.MM 
WhereMM 
(MM 
oMM 
=>MM 
oMM  !
.MM! "
IdUserMM" (
==MM) +
idUserMM, 2
)MM2 3
.NN 
WhereNN 
(NN 
oNN 
=>NN 
oNN  !
.NN! "
ConferenciaNN" -
.NN- .
	FechaConfNN. 7
>NN8 9
DateTimeNN: B
.NNB C
NowNNC F
)NNF G
.OO 
OrderByDescendingOO &
(OO& '
oOO' (
=>OO) +
oOO, -
.OO- .
ConferenciaOO. 9
.OO9 :
	FechaConfOO: C
)OOC D
.PP 
ToListPP 
(PP 
)PP 
;PP 
returnQQ 
conferenciasQQ 
;QQ  
}RR 	
publicTT 
ListTT 
<TT 
ConferenciaTT 
>TT  "
GetConferenciasOrderUCTT! 7
(TT7 8
)TT8 9
{UU 	
varVV 
conferenciasVV 
=VV 
contextVV &
.VV& '
ConferenciasVV' 3
.WW 
IncludeWW 
(WW 
oWW 
=>WW !
oWW" #
.WW# $
PonentesWW$ ,
)WW, -
.XX 
OrderByDescendingXX &
(XX& '
oXX' (
=>XX) +
oXX, -
.XX- .
	FechaConfXX. 7
)XX7 8
.YY 
ToListYY 
(YY 
)YY 
;YY 
returnZZ 
conferenciasZZ 
;ZZ  
}[[ 	
public]] 
List]] 
<]] 
Cuenta]] 
>]] 

GetCuentas]] &
(]]& '
)]]' (
{^^ 	
var__ 
cuentas__ 
=__ 
context__ !
.__! "
Cuentas__" )
.__) *
ToList__* 0
(__0 1
)__1 2
;__2 3
return`` 
cuentas`` 
;`` 
}aa 	
publiccc 
Listcc 
<cc 
Ponentecc 
>cc 
GetPonentescc (
(cc( )
)cc) *
{dd 	
varee 
ponentesee 
=ee 
contextee "
.ee" #
Ponentesee# +
.ee+ ,
ToListee, 2
(ee2 3
)ee3 4
;ee4 5
returnff 
ponentesff 
;ff 
}gg 	
publicii 
voidii 
NewConferenciaii "
(ii" #
Conferenciaii# .
conferenciaii/ :
,ii: ;
	IFormFileii< E
fileiiF J
)iiJ K
{jj 	
ifkk 
(kk 
filekk 
!=kk 
nullkk 
)kk 
conferenciall 
.ll 
	ImagePathll %
=ll& '
SaveFilell( 0
(ll0 1
filell1 5
)ll5 6
;ll6 7
elsemm 
conferenciann 
.nn 
	ImagePathnn %
=nn& '
nullnn( ,
;nn, -
contextoo 
.oo 
Conferenciasoo  
.oo  !
Addoo! $
(oo$ %
conferenciaoo% 0
)oo0 1
;oo1 2
contextpp 
.pp 
SaveChangespp 
(pp  
)pp  !
;pp! "
}qq 	
publicss 
voidss 
EditConferenciass #
(ss# $
Conferenciass$ /
conferenciass0 ;
,ss; <
	IFormFiless= F
filessG K
)ssK L
{tt 	
ifuu 
(uu 
fileuu 
!=uu 
nulluu 
)uu 
conferenciavv 
.vv 
	ImagePathvv %
=vv& '
SaveFilevv( 0
(vv0 1
filevv1 5
)vv5 6
;vv6 7
elseww 
conferenciaxx 
.xx 
	ImagePathxx %
=xx& '
nullxx( ,
;xx, -
contextyy 
.yy 
Conferenciasyy  
.yy  !
Updateyy! '
(yy' (
conferenciayy( 3
)yy3 4
;yy4 5
contextzz 
.zz 
SaveChangeszz 
(zz  
)zz  !
;zz! "
}{{ 	
public}} 
void}} 
AddTransaccion}} "
(}}" #
Transaccion}}# .
transaccionCli}}/ =
,}}= >
Transaccion}}? J
transaccionAd}}K X
)}}X Y
{~~ 	
context 
. 
Transacciones !
.! "
Add" %
(% &
transaccionCli& 4
)4 5
;5 6
context
 
.
 
Transacciones
 !
.
! "
Add
" %
(
% &
transaccionAd
& 3
)
3 4
;
4 5
}
 	
public
 
void
 !
ModificaMontoCuenta
 '
(
' (
int
( +
cuentaId
, 4
)
4 5
{
 	
var
 
transaccions
 
=
 
context
 &
.
& '
Transacciones
' 4
.
4 5
ToList
5 ;
(
; <
)
< =
;
= >
var
 
cuenta
 
=
 
context
  
.
  !
Cuentas
! (
.
 
Include
 
(
 
o
 
=>
 
o
 
.
  
Transaccions
  ,
)
, -
.
 
FirstOrDefault
 
(
  
o
  !
=>
" $
o
% &
.
& '
Id
' )
==
* ,
cuentaId
- 5
)
5 6
;
6 7
var
 
total
 
=
 
cuenta
 
.
 
Transaccions
 +
.
+ ,
Sum
, /
(
/ 0
o
0 1
=>
2 4
o
5 6
.
6 7
Amount
7 =
)
= >
;
> ?
cuenta
 
.
 
Amount
 
=
 
total
 !
;
! "
context
 
.
 
SaveChanges
 
(
  
)
  !
;
! "
}
 	
public
 
void
 

AddCompras
 
(
 
Comprar
 &
comprar
' .
,
. /
int
0 3
userId
4 :
,
: ;
int
< ?
conferenciaId
@ M
)
M N
{
 	
comprar
 
.
 
IdUser
 
=
 
userId
 #
;
# $
comprar
 
.
 
IdConferencia
 !
=
" #
conferenciaId
$ 1
;
1 2
context
 
.
 
Compras
 
.
 
Add
 
(
  
comprar
  '
)
' (
;
( )
context
 
.
 
SaveChanges
 
(
  
)
  !
;
! "
}
 	
private
 
string
 
SaveFile
 
(
  
	IFormFile
  )
file
* .
)
. /
{
 	
string
 
relativePath
 
=
  !
$str
" $
;
$ %
if
 
(
 
file
 
.
 
Length
 
>
 
$num
 
&&
  "
(
# $
file
$ (
.
( )
ContentType
) 4
==
5 7
$str
8 D
||
E G
file
H L
.
L M
ContentType
M X
==
Y [
$str
\ g
||
h j
file
k o
.
o p
ContentType
p {
==
| ~
$str 
) 
) 
{
 
relativePath
 
=
 
Path
 #
.
# $
Combine
$ +
(
+ ,
$str
, 3
,
3 4
file
5 9
.
9 :
FileName
: B
)
B C
;
C D
var
 
filePath
 
=
 
Path
 #
.
# $
Combine
$ +
(
+ ,
hosting
, 3
.
3 4
WebRootPath
4 ?
,
? @
relativePath
A M
)
M N
;
N O
var
 
stream
 
=
 
new
  

FileStream
! +
(
+ ,
filePath
, 4
,
4 5
FileMode
6 >
.
> ?
Create
? E
)
E F
;
F G
file
   
.
   
CopyTo
   
(
   
stream
   "
)
  " #
;
  # $
stream
¡¡ 
.
¡¡ 
Close
¡¡ 
(
¡¡ 
)
¡¡ 
;
¡¡ 
}
¢¢ 
return
¤¤ 
$str
¤¤ 
+
¤¤ 
relativePath
¤¤ %
.
¤¤% &
Replace
¤¤& -
(
¤¤- .
$char
¤¤. 2
,
¤¤2 3
$char
¤¤4 7
)
¤¤7 8
;
¤¤8 9
}
¥¥ 	
}
¦¦ 
}§§ ¼
IC:\Users\Edwin\Documents\GOLDCONF\GoldConf\Repository\CuentaRepository.cs
	namespace 	
GoldConf
 
. 

Repository 
{		 
public

 

	interface

 
ICuentaRepository

 &
{ 
List 
< 
Cuenta 
> 

GetCuentas 
(  
)  !
;! "
void 
NewTransaccion 
( 
Cuenta "
cuenta# )
)) *
;* +
List 
< 
Transaccion 
> 
GetTransaccions )
() *
int* -
id. 0
)0 1
;1 2
Cuenta 

GetCuentas 
( 
int 
id  
)  !
;! "
} 
public 

class 
CuentaRepository !
:" #
ICuentaRepository$ 5
{ 
private 
readonly 
IGoldConfContext )
context* 1
;1 2
public 
CuentaRepository 
(  
IGoldConfContext  0
context1 8
)8 9
{ 	
this 
. 
context 
= 
context "
;" #
} 	
public 
List 
< 
Cuenta 
> 

GetCuentas &
(& '
)' (
{ 	
var 
cuentas 
= 
context !
.! "
Cuentas" )
.) *
ToList* 0
(0 1
)1 2
;2 3
return 
cuentas 
; 
} 	
public   
void   
NewTransaccion   "
(  " #
Cuenta  # )
cuenta  * 0
)  0 1
{!! 	
context"" 
."" 
Cuentas"" 
."" 
Add"" 
(""  
cuenta""  &
)""& '
;""' (
context## 
.## 
SaveChanges## 
(##  
)##  !
;##! "
}$$ 	
public&& 
List&& 
<&& 
Transaccion&& 
>&&  
GetTransaccions&&! 0
(&&0 1
int&&1 4
id&&5 7
)&&7 8
{'' 	
var(( 
transacciones(( 
=(( 
context((  '
.((' (
Transacciones((( 5
.((5 6
Where((6 ;
(((; <
o((< =
=>((> @
o((A B
.((B C
CuentaId((C K
==((L N
id((O Q
)((Q R
.((R S
ToList((S Y
(((Y Z
)((Z [
;(([ \
return)) 
transacciones))  
;))  !
}** 	
public,, 
Cuenta,, 

GetCuentas,,  
(,,  !
int,,! $
id,,% '
),,' (
{-- 	
var.. 
cuenta.. 
=.. 
context..  
...  !
Cuentas..! (
...( )
First..) .
(... /
o../ 0
=>..1 3
o..4 5
...5 6
Id..6 8
==..9 ;
id..< >
)..> ?
;..? @
return// 
cuenta// 
;// 
}00 	
}11 
}22 
GC:\Users\Edwin\Documents\GOLDCONF\GoldConf\Repository\HomeRepository.cs
	namespace 	
GoldConf
 
. 

Repository 
{		 
public

 

	interface

 
IHomeRepository

 $
{ 
List 
< 
Ponente 
> 
GetPonentes !
(! "
)" #
;# $
List 
< 
Conferencia 
> 
GetConferencias )
() *
)* +
;+ ,
} 
public 

class 
HomeRepository 
:  !
IHomeRepository" 1
{ 
private 
readonly 
IGoldConfContext )
context* 1
;1 2
public 
HomeRepository 
( 
IGoldConfContext .
context/ 6
)6 7
{ 	
this 
. 
context 
= 
context "
;" #
} 	
public 
List 
< 
Conferencia 
>  
GetConferencias! 0
(0 1
)1 2
{ 	
var 
conferencias 
= 
context &
.& '
Conferencias' 3
.3 4
Include 
( 
o 
=> 
o 
. 
Ponentes '
)' (
.( )
Where 
( 
o 
=> 
o 
. 
	FechaConf &
>=' )
DateTime* 2
.2 3
Now3 6
)6 7
.7 8
ToList 
( 
) 
; 
return 
conferencias 
;  
} 	
public!! 
List!! 
<!! 
Ponente!! 
>!! 
GetPonentes!! (
(!!( )
)!!) *
{"" 	
var## 
ponente## 
=## 
context## !
.##! "
Ponentes##" *
.##* +
ToList##+ 1
(##1 2
)##2 3
;##3 4
return$$ 
ponente$$ 
;$$ 
}%% 	
}&& 
}'' ÂI
JC:\Users\Edwin\Documents\GOLDCONF\GoldConf\Repository\PonenteRepository.cs
	namespace		 	
GoldConf		
 
.		 

Repository		 
{

 
public 

	interface 
IPonenteRepository '
{ 
List 
< 
Ponente 
> 
GetPonentes !
(! "
)" #
;# $
List 
< 
Ponente 
> 
GetPonentesSearch '
(' (
string( .
search/ 5
)5 6
;6 7
List 
< 
Cuenta 
> 
GetCuentaUser "
(" #
)# $
;$ %
List 
< 
Comprar 
> 

GetCompras  
(  !
)! "
;" #
Ponente 

GetPonente 
( 
int 
id !
)! "
;" #
List 
< 
Conferencia 
> "
GetConferenciasPonente 0
(0 1
int1 4
id5 7
)7 8
;8 9
void 

NewPonente 
( 
Ponente 
ponente  '
,' (
	IFormFile) 2
file3 7
)7 8
;8 9
void 
EditPonente 
( 
Ponente  
ponente! (
,( )
	IFormFile* 3
file4 8
)8 9
;9 :
} 
public 

class 
PonenteRepository "
:# $
IPonenteRepository% 7
{ 
private 
readonly 
IGoldConfContext )
context* 1
;1 2
public 
readonly 
IWebHostEnvironment +
hosting, 3
;3 4
public 
PonenteRepository  
(  !
IGoldConfContext! 1
context2 9
,9 :
IWebHostEnvironment; N
hostingO V
)V W
{ 	
this 
. 
context 
= 
context "
;" #
this 
. 
hosting 
= 
hosting "
;" #
} 	
public!! 
List!! 
<!! 
Ponente!! 
>!! 
GetPonentes!! (
(!!( )
)!!) *
{"" 	
var## 
ponentes## 
=## 
context## "
.##" #
Ponentes### +
.##+ ,
ToList##, 2
(##2 3
)##3 4
;##4 5
return$$ 
ponentes$$ 
;$$ 
}%% 	
public'' 
List'' 
<'' 
Ponente'' 
>'' 
GetPonentesSearch'' .
(''. /
string''/ 5
search''6 <
)''< =
{(( 	
var)) 
ponentes)) 
=)) 
context)) "
.))" #
Ponentes))# +
.))+ ,
Where)), 1
())1 2
s))2 3
=>))4 6
s))7 8
.))8 9
NomApe))9 ?
.))? @
Contains))@ H
())H I
search))I O
)))O P
)))P Q
.))Q R
ToList))R X
())X Y
)))Y Z
;))Z [
;))\ ]
return** 
ponentes** 
;** 
}++ 	
public-- 
List-- 
<-- 
Cuenta-- 
>-- 
GetCuentaUser-- )
(--) *
)--* +
{.. 	
var// 
cuenta// 
=// 
context//  
.//  !
Cuentas//! (
.00 
ToList00 
(00 
)00 
;00 
return11 
cuenta11 
;11 
}22 	
public44 
List44 
<44 
Comprar44 
>44 

GetCompras44 '
(44' (
)44( )
{55 	
var66 
compras66 
=66 
context66 !
.66! "
Compras66" )
.66) *
ToList66* 0
(660 1
)661 2
;662 3
return77 
compras77 
;77 
}88 	
public:: 
Ponente:: 

GetPonente:: !
(::! "
int::" %
id::& (
)::( )
{;; 	
var<< 
ponente<< 
=<< 
context<< !
.<<! "
Ponentes<<" *
.<<* +
Where== 
(== 
o== 
=>== 
o== 
.== 
Id== 
====  "
id==# %
)==% &
.==& '
FirstOrDefault>> 
(>> 
)>>  
;>>  !
return?? 
ponente?? 
;?? 
}@@ 	
publicBB 
ListBB 
<BB 
ConferenciaBB 
>BB  "
GetConferenciasPonenteBB! 7
(BB7 8
intBB8 ;
idBB< >
)BB> ?
{CC 	
varDD 
conferenciasDD 
=DD 
contextDD &
.DD& '
ConferenciasDD' 3
.EE 
WhereEE 
(EE 
oEE 
=>EE 
oEE 
.EE 
	PonenteIdEE '
==EE( *
idEE+ -
)EE- .
.FF 
OrderByDescendingFF "
(FF" #
oFF# $
=>FF% '
oFF( )
.FF) *
	FechaConfFF* 3
)FF3 4
.GG 
ToListGG 
(GG 
)GG 
;GG 
returnHH 
conferenciasHH 
;HH  
}II 	
publicKK 
voidKK 

NewPonenteKK 
(KK 
PonenteKK &
ponenteKK' .
,KK. /
	IFormFileKK0 9
fileKK: >
)KK> ?
{LL 	
ifMM 
(MM 
fileMM 
!=MM 
nullMM 
)MM 
ponenteNN 
.NN 
ImagenNN 
=NN  
SaveFileNN! )
(NN) *
fileNN* .
)NN. /
;NN/ 0
elseOO 
ponentePP 
.PP 
ImagenPP 
=PP  
nullPP! %
;PP% &
contextQQ 
.QQ 
PonentesQQ 
.QQ 
AddQQ  
(QQ  !
ponenteQQ! (
)QQ( )
;QQ) *
contextRR 
.RR 
SaveChangesRR 
(RR  
)RR  !
;RR! "
}SS 	
publicUU 
voidUU 
EditPonenteUU 
(UU  
PonenteUU  '
ponenteUU( /
,UU/ 0
	IFormFileUU1 :
fileUU; ?
)UU? @
{VV 	
ifWW 
(WW 
fileWW 
!=WW 
nullWW 
)WW 
ponenteXX 
.XX 
ImagenXX 
=XX  
SaveFileXX! )
(XX) *
fileXX* .
)XX. /
;XX/ 0
elseYY 
ponenteZZ 
.ZZ 
ImagenZZ 
=ZZ  
nullZZ! %
;ZZ% &
context[[ 
.[[ 
Ponentes[[ 
.[[ 
Update[[ #
([[# $
ponente[[$ +
)[[+ ,
;[[, -
context\\ 
.\\ 
SaveChanges\\ 
(\\  
)\\  !
;\\! "
}]] 	
private__ 
string__ 
SaveFile__ 
(__  
	IFormFile__  )
file__* .
)__. /
{`` 	
stringaa 
relativePathaa 
=aa  !
$straa" $
;aa$ %
ifcc 
(cc 
filecc 
.cc 
Lengthcc 
>cc 
$numcc 
&&cc  "
(cc# $
filecc$ (
.cc( )
ContentTypecc) 4
==cc5 7
$strcc8 D
||ccE G
fileccH L
.ccL M
ContentTypeccM X
==ccY [
$strcc\ g
||cch j
filecck o
.cco p
ContentTypeccp {
==cc| ~
$str	cc 
)
cc 
)
cc 
{dd 
relativePathee 
=ee 
Pathee #
.ee# $
Combineee$ +
(ee+ ,
$stree, 3
,ee3 4
fileee5 9
.ee9 :
FileNameee: B
)eeB C
;eeC D
varff 
filePathff 
=ff 
Pathff #
.ff# $
Combineff$ +
(ff+ ,
hostingff, 3
.ff3 4
WebRootPathff4 ?
,ff? @
relativePathffA M
)ffM N
;ffN O
vargg 
streamgg 
=gg 
newgg  

FileStreamgg! +
(gg+ ,
filePathgg, 4
,gg4 5
FileModegg6 >
.gg> ?
Creategg? E
)ggE F
;ggF G
filehh 
.hh 
CopyTohh 
(hh 
streamhh "
)hh" #
;hh# $
streamii 
.ii 
Closeii 
(ii 
)ii 
;ii 
}jj 
returnll 
$strll 
+ll 
relativePathll %
.ll% &
Replacell& -
(ll- .
$charll. 2
,ll2 3
$charll4 7
)ll7 8
;ll8 9
}mm 	
}nn 
}oo ô
BC:\Users\Edwin\Documents\GOLDCONF\GoldConf\Service\ClaimService.cs
	namespace 	
GoldConf
 
. 
Service 
{ 
public		 

	interface		 
IClaimService		 "
{

 
User 
GetLoggedUser 
( 
) 
; 
void 
SetHttpContext 
( 
HttpContext '
httpContext( 3
)3 4
;4 5
void 
Logout 
( 
) 
; 
void 
Login 
( 
ClaimsPrincipal "
	principal# ,
), -
;- .
} 
public 

class 
ClaimService 
: 
IClaimService  -
{ 
private 
IGoldConfContext  
context! (
;( )
private 
HttpContext 
httpContext '
;' (
public 
ClaimService 
( 
IGoldConfContext ,
context- 4
)4 5
{ 	
this 
. 
context 
= 
context "
;" #
} 	
public 
void 
SetHttpContext "
(" #
HttpContext# .
httpContext/ :
): ;
{ 	
this 
. 
httpContext 
= 
httpContext *
;* +
} 	
public!! 
User!! 
GetLoggedUser!! !
(!!! "
)!!" #
{"" 	
var## 
claim## 
=## 
httpContext## #
.### $
User##$ (
.##( )
Claims##) /
.##/ 0
FirstOrDefault##0 >
(##> ?
)##? @
;##@ A
var$$ 
user$$ 
=$$ 
context$$ 
.$$ 
Users$$ $
.$$$ %
Where$$% *
($$* +
o$$+ ,
=>$$- /
o$$0 1
.$$1 2
Username$$2 :
==$$; =
claim$$> C
.$$C D
Value$$D I
)$$I J
.$$J K
FirstOrDefault$$K Y
($$Y Z
)$$Z [
;$$[ \
return%% 
user%% 
;%% 
}&& 	
public(( 
void(( 
Logout(( 
((( 
)(( 
{)) 	
httpContext** 
.** 
SignOutAsync** $
(**$ %
)**% &
;**& '
}++ 	
public-- 
void-- 
Login-- 
(-- 
ClaimsPrincipal-- )
	principal--* 3
)--3 4
{.. 	
httpContext// 
.// 
SignInAsync// #
(//# $
	principal//$ -
)//- .
;//. /
}00 	
}22 
}33 ó&
5C:\Users\Edwin\Documents\GOLDCONF\GoldConf\Startup.cs
	namespace 	
GoldConf
 
{ 
public 

class 
Startup 
{ 
public 
Startup 
( 
IConfiguration %
configuration& 3
)3 4
{ 	
Configuration 
= 
configuration )
;) *
} 	
public 
IConfiguration 
Configuration +
{, -
get. 1
;1 2
}3 4
public 
void 
ConfigureServices %
(% &
IServiceCollection& 8
services9 A
)A B
{ 	
services 
. #
AddControllersWithViews ,
(, -
)- .
;. /
services 
. 
AddDbContext !
<! "
GoldConfContext" 1
>1 2
(2 3
options 
=> 
options "
." #
UseSqlServer# /
(/ 0
Configuration0 =
.= >
GetConnectionString> Q
(Q R
$strR a
)a b
)b c
) 
; 
services   
.   
AddAuthentication   &
(  & '(
CookieAuthenticationDefaults  ' C
.  C D 
AuthenticationScheme  D X
)  X Y
.!! 
	AddCookie!! 
(!! 
options!! "
=>!!# %
{"" 
options$$ 
.$$ 
	LoginPath$$ %
=$$& '
$str$$( 5
;$$5 6
}%% 
)%% 
;%% 
services'' 
.'' 
AddTransient'' !
<''! "
IClaimService''" /
,''/ 0
ClaimService''1 =
>''= >
(''> ?
)''? @
;''@ A
services(( 
.(( 
AddTransient(( !
<((! "
IGoldConfContext((" 2
,((2 3
GoldConfContext((4 C
>((C D
(((D E
)((E F
;((F G
services)) 
.)) 
AddTransient)) !
<))! "
IHomeRepository))" 1
,))1 2
HomeRepository))3 A
>))A B
())B C
)))C D
;))D E
services** 
.** 
AddTransient** !
<**! "
IPonenteRepository**" 4
,**4 5
PonenteRepository**6 G
>**G H
(**H I
)**I J
;**J K
services++ 
.++ 
AddTransient++ !
<++! "
ICuentaRepository++" 3
,++3 4
CuentaRepository++5 E
>++E F
(++F G
)++G H
;++H I
services,, 
.,, 
AddTransient,, !
<,,! ""
IConferenciaRepository,," 8
,,,8 9!
ConferenciaRepository,,: O
>,,O P
(,,P Q
),,Q R
;,,R S
services-- 
.-- 
AddTransient-- !
<--! "
IAuthRepository--" 1
,--1 2
AuthRepository--3 A
>--A B
(--B C
)--C D
;--D E
}.. 	
public11 
void11 
	Configure11 
(11 
IApplicationBuilder11 1
app112 5
,115 6
IWebHostEnvironment117 J
env11K N
)11N O
{22 	
if33 
(33 
env33 
.33 
IsDevelopment33 !
(33! "
)33" #
)33# $
{44 
app55 
.55 %
UseDeveloperExceptionPage55 -
(55- .
)55. /
;55/ 0
}66 
else77 
{88 
app99 
.99 
UseExceptionHandler99 '
(99' (
$str99( 5
)995 6
;996 7
app;; 
.;; 
UseHsts;; 
(;; 
);; 
;;; 
}<< 
app== 
.== 
UseHttpsRedirection== #
(==# $
)==$ %
;==% &
app>> 
.>> 
UseStaticFiles>> 
(>> 
)>>  
;>>  !
app@@ 
.@@ 

UseRouting@@ 
(@@ 
)@@ 
;@@ 
appAA 
.AA 
UseAuthenticationAA !
(AA! "
)AA" #
;AA# $
appBB 
.BB 
UseAuthorizationBB  
(BB  !
)BB! "
;BB" #
appDD 
.DD 
UseEndpointsDD 
(DD 
	endpointsDD &
=>DD' )
{EE 
	endpointsFF 
.FF 
MapControllerRouteFF ,
(FF, -
nameGG 
:GG 
$strGG #
,GG# $
patternHH 
:HH 
$strHH E
)HHE F
;HHF G
}II 
)II 
;II 
}JJ 	
}KK 
}LL 